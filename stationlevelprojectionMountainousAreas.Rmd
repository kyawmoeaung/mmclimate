---
title: "Climate Scenario Development for Mountainous Regions"
subtitle: "Myanmar Climate Change Scenario Atlas- II"
author:
  - "Kyaw Moe Aung, Environmental Conservation Department - MONREC"
  - "Tin Mar Htay, Department of Meteorology and Hydrology"
  - "Hla Tun, Department of Meteorology and Hydrology"
  - "May Khin Chaw, Department of Meteorology and Hydrology"
  - "Shwe Mar Than, Yezin Agriculture University"
  - "Aung Than Oo, Irrigation and Water Utilization Resource Management"
  - "Kyaw Zeya Htun, Yangon Technology University"
  - "Kyaw San Naing, Environmental Conservation Department"
  - "Thanda Wint Wint Khaing, Environmental Conservation Department"
  - "Thi Thi Soe Min, Environmental Conservation Department"
  - "San Win, Environmental Conservation Department"
  - "Khin Cho Cho Shein, Department of Meteorology and Hydrology"
date: "1/6/2022"
output:
  html_document:
    df_print: paged
  pdf_document: default
  bookdown::word_document2: 
    toc: true
    toc_depth: 4
    number_sections: true
    fig_caption: true
editor_options: 
  markdown: 
    wrap: 72
---

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE)
library(tidyverse)
library(readr)
library(purrr)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(patchwork)
library(lubridate)
library(vroom)
require(knitr)
require(gt)
require(ggthemes)
if (!require(kableExtra)) install.packages("kableExtra")
if (!require(fs)) install.packages("fs")

abb.month = c(" J", "F", "M", "A", "M ", "J ", "J", "A ", "S", "O", "N", "D")
```

# Montainous Areas

## Hakha Station, Chin State

### Mean Temperature

#### Observed data

There are 124 missing data point in Hakha tmean dataset. Most of it are
continuously missing especially in 1991 August to November and some are
randomly lost. The data are filled by assuming last year observation
would be the same and thus replaced them with 1990 August to November
observation. The rest are filled with `impute` method using mean value
of the data set.

```{r}
hakha_tmean <- vroom::vroom(
  "data/Area-2/Hakha/clean_hakha_meanTem.csv",
  delim = " ",
  col_names = c("date", "Tmean"),
  na = "-999.0",
  show_col_types = FALSE
)
hakha_tmean$date <- as.character(hakha_tmean$date)
## set charactor for further analysis
##hakha_tmean$date <- ymd(hakha_tmean$date)
hakha_tmean["year"] <- str_sub(hakha_tmean$date, 1, 4)
hakha_tmean["month"] <- str_sub(hakha_tmean$date, 5, 6)
hakha_tmean["day"] <- str_sub(hakha_tmean$date, 7, 8)
hakha_tmean["Date"] <- make_date(
  hakha_tmean$year,
  hakha_tmean$month,
  hakha_tmean$day
)

## August, September, October, November 1991 missing
miss_ason_date <- seq.Date(ymd("1991-08-01"), ymd("1991-11-30"), "days")
miss_ason_tmean <- hakha_tmean$Tmean[which(hakha_tmean$date == "19900801"):(which(hakha_tmean$date == "19901130"))]
miss_ason_1991 <- bind_cols(miss_ason_date, miss_ason_tmean)
names(miss_ason_1991) <- c("Date", "Tmean")
hakha_tmean$date <- ymd(hakha_tmean$date)
hakha_tmean <- hakha_tmean[, c(1, 6, 2)]
hakha_tmean <- hakha_tmean %>%
  drop_na() %>%
  bind_rows(miss_ason_1991) %>%
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  ) %>% 
  arrange(Date)
### subset only 20 years
hakha_tmean <- hakha_tmean[730:nrow(hakha_tmean), ]


hakha_tmean["Date"] <- ymd(hakha_tmean$Date)
```

```{r Fig1-1, fig.width=6, fig.height=6, fig.retina=2, fig.cap= "20 years observed mean temperature at Hakha station, Chin State, Myanmar"}

p1 <- hakha_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Month)) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- hakha_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- hakha_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Mean Temperature at Hakha Station",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- hakha_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(hakha_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(hakha_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(hakha_tmean$Tmean), 2), "C"), size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Hakha",
    caption = "Source: ECD-SNC, DMH"
  ) + theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

Hakha is resided at Chin state as part of mountainous areas in the
country. The time series data started in 1989 Jan 1 which highlights
that this data set require new treatment. It would take some time to
backcast based on existing data. To be easy to handle, the dataset was
subsetted into 20 years starting from 1991. Within these 20 years, The
total number of missing data points in this mean temperature data set
amount to 123. The data gap is found from 1991 August 1 to 1991 November
30 for 122 missing data point and one missing value in 2005. Thus the
data gap was filled with the Last Observation Carried Forwards (LOCF).
This means that the data gap were filled with the last year (1990
observed data) and then remove 1989 to 1990 data to make it simply 20
years of observed data. Then time slices are changed from 3 slices
(2011-2040, 2041-2070, 2071-2100), to 4 slices (i.e. 2011-2030,
2041-2060, 2061-2080, 2081-2100)such that it has 20 years of cycle and
is also consistent data point with the observed data. The summary of
data represents that there are only \<\< place holder\>\>

```{r Chin-Tmean, echo=FALSE, include=FALSE}
files <- fs::dir_ls(glob = "*tmean_4_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_4_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")

hakha_tmean_45_1 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 1 
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_2 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_3 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 3 
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_4 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 4 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# hakha_tmean_45_1
# hakha_tmean_45_2
# hakha_tmean_45_3
# hakha_tmean_45_4
hakha_tmean_future <- bind_rows(
  hakha_tmean_45_1,
  hakha_tmean_45_2,
  hakha_tmean_45_3,
  hakha_tmean_45_4
)
```

##### Observed and Projected Daily Mean Temperature at Hakha Station

```{r Fig1-2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_tmean_future <- hakha_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmean_future %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.6) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey60") + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  ) 
```

##### Observed and Projected Daily Mean Temperature by Model at Hakha Station

```{r Fig1-3, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_tmean_future %>%
  distinct(.keep_all = TRUE) %>%
  # sample(size = 1000, replace = TRUE) %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = .9) +
  #geom_smooth(method = "lm", se = FALSE, color = "maroon") +
  facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey60") +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r include = TRUE, Table1-1}
hakha_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2,
               caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station, Chin State, Myanmar<br><br>**")
```

```{r include=FALSE}
hakha_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station*"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 23.6
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 23.6)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

+----------+----------+----------+----------+----------+
| Model    | D        | Year at  | Maximum  | Year at  |
|          | eveloper | which it |          | which    |
|          | country  | passes 2 |          | its      |
|          |          | Degree   |          | maximum  |
+==========+==========+==========+==========+==========+
| HADCM3   | United   | 2036     | 3.5      | 2090     |
|          | Kingdom  |          |          | April    |
+----------+----------+----------+----------+----------+
| MIROC4H  | Japan    | 2041     | 3.2      | 2090     |
|          |          |          |          | December |
+----------+----------+----------+----------+----------+
| WAS   | CORDEX   | 2043     | 3.0      | 2090     |
|          | West     |          |          | February |
| 4        | Asia     |          |          |          |
| 4i-MPI-E |          |          |          |          |
| S        |          |          |          |          |
| M        |          |          |          |          |
| -LR-RCA4 |          |          |          |          |
+----------+----------+----------+----------+----------+
|          | CORDEX   | 2043     | 2.99     | 2090     |
|          | West     |          |          | February |
|          | Asia     |          |          |          |
|  WAS-44i |          |          |          |          |
|          |          |          |          |          |
| M        |          |          |          |          |
| PI-ESM-L |          |          |          |          |
| R        |          |          |          |          |
| -        |          |          |          |          |
| REMO2009 |          |          |          |          |
+----------+----------+----------+----------+----------+
| WAS-4 4  | CORDEX   | 2047     | 2.86     | 2090     |
| i        | West     |          |          | February |
| -IPSL-CM | Asia     |          |          |          |
| 5        |          |          |          |          |
| A        |          |          |          |          |
| -MR-RCA4 |          |          |          |          |
+----------+----------+----------+----------+----------+

##### Observed and Projected Monthly Mean Temperature at Hakha Station

At the Hakha station, it has been projected that the mean temperature
will increase up to 21.5 Degree C under the average of all models while
it can reach up to 30 Degree C under max of mean temperature. The most
aggressive models which show above 4 Degree C in the course of 2100 are
HADCM3 (exceeding 2 Degree by 2036 and will reach 3.5 Degree by 2090
especially in April), MIROC4H (exceeding 2 degree by 2041 and will reach
3.2 Degree by 2090), WAS-44i-MPI-ESM-LR-RCA4 (exceeding by 2043 will
reach 3.01 Degree by 2090), WAS-44i-MPI-ESM-LR-REMO2009 (exceeding 2
Degree by 2043 and will reach 6.4 Degree by 2090),
WAS-44i-IPSL-CM5A-MR-RCA4 (exceeding by 2047 and will reach 6.4 Degree
by 2090)

```{r Fig1-4, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen") +
  scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = month.abb) +
  scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-5, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Hakha Station, Chin State, Myanmar during 2011-2090"}

hakha_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "gray30")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 4) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", angle = 0)
  )
```

##### Observed vs. Projected Annual Mean Temperature

```{r Fig1-6, fig.retina=2, fig.cap="Observed vs. Projected Annual Mean Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar"}

hakha_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
scale_color_brewer(palette = "Reds") +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
    
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_viridis_d() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "olivedrab", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Mean Temperature by Model at Hakha Station

```{r Fig1-7, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed Vs Projected Annual Mean Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar"}

hakha_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
#scale_color_brewer(palette = "RdBu") +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
   facet_wrap(~Model, scales = "free_y", ncol = 5) + 
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
theme_excel_new() +
  theme(
     legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-8, fig.cap = "Observed and Projected Annual Mean Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar"}

hakha_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
scale_color_brewer(palette = "Reds") +
  geom_line(data = hakha_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
    
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
    scale_color_viridis_d() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "olivedrab", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-9, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Annual Mean Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar"}

hakha_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
#scale_color_brewer(palette = "RdBu") +
  geom_line(data = hakha_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
   facet_wrap(~Model, scales = "free_y", ncol = 5) + 
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
theme_excel_new() +
  theme(
     legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP8.5

##### Observed and Projected Daily Mean Temperature

At the Hakha station, it has been projected that the mean temperature
will increase up to 21.5 Degree C under the average of all models while
it can reach up to 30 Degree C under max of mean temperature. The most
aggressive models which show above 4 Degree C in the course of 2100 are
HADCM3 (exceeding 4 Degree by 2055 and will reach 7.5 Degree by 2090
especially in April), MIROC4H (exceeding 4 degree by 2064 and will reach
6.8 Degree by 2090), WAS-44i-IPSL-CM5A-MR-RCA4 (exceeding by 2065 will
reach 6.1 Degree by 2090), WAS-44i-MPI-ESM-LR-RCA4 (exceeding 4 Degree
by 2078 and will reach 6.4 Degree by 2090), WAS-44i-MPI-ESM-LR-REMO2009
(exceeding by 2062 and will reach 6.4 Degree by 2090)

+-------------------+-------------------------+-----------+-----------+
| Model             | Year at which it        | Maximum   | Year      |
|                   | Exceeds 4 Degree        |           |           |
+:=================:+:=======================:+:=========:+:=========:+
| HADCM3            | 2055                    | 7.5       | 2090      |
+-------------------+-------------------------+-----------+-----------+
| MIROC4H           | 2064                    | 6.8       | 2090      |
+-------------------+-------------------------+-----------+-----------+
| WAS-44i-          | 2065                    | 6.1       | 2090      |
| IPSL-CM5A-MR-RCA4 |                         |           |           |
+-------------------+-------------------------+-----------+-----------+
| WAS-44            | 2062                    | 6.4       | 2090      |
| i-MPI-ESM-LR-RCA4 |                         |           |           |
+-------------------+-------------------------+-----------+-----------+
| WAS-44i-MP        | 2062                    | 6.4       | 2090      |
| I-ESM-LR-REMO2009 |                         |           |           |
+-------------------+-------------------------+-----------+-----------+

```{r}
hakha_tmean_85_1 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_2 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_3 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_4 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 4 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# hakha_tmean_85_1
# hakha_tmean_85_2
# hakha_tmean_85_3
# hakha_tmean_85_4
hakha_tmean_future_85 <- bind_rows(
  hakha_tmean_85_1,
  hakha_tmean_85_2,
  hakha_tmean_85_3,
  hakha_tmean_85_4
)
hakha_tmean_future_85 <- hakha_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-10, fig.retina=2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmean_future_85 %>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey70") +
  scale_fill_hue(l = 45) +
  # scale_x_discrete(limits = c(seq(2010,2100,by =10)))+
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(hakha_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_excel_new() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# kable(hakha_tmean_future_85[which.max(hakha_tmean_future_85$future),],format = "html")
# kable(hakha_tmean_future_85[which(hakha_tmean_future_85$Tmean.y>4),], format = "html")
```

##### Observed and Projected Daily Mean Temperature by Model at Hakha Station,

```{r Fig-1-11, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmean_future_85 %>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey70") +
  scale_fill_hue(l = 80) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(hakha_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_excel_new() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-2, include = TRUE}
hakha_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, 
 caption = "Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar<br><br>")

```

```{r include=FALSE}
hakha_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 23.6
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 23.6)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min),
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Mean Temperature at Hakha Station, Chin State, Myanmar

```{r Fig1-12, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Hakha Station, Chin State during 2011-2090"}
hakha_tmean_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen")+
  scale_fill_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Mean Temperature by Model at Hakha Station, Chin State, Myanmar

```{r Fig1-13, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Hakha Station during 2011-2090"}
hakha_tmean_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
   geom_point() +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey30")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "div") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 90)
  )
# kable(hakha_tmean_future_85[which.max(hakha_tmean_future_85$future),],format = "html")
# kable(hakha_tmean_future_85[which(hakha_tmean_future_85$Tmean.y>4),], format = "html")
```

##### Observed vs. Projected Annual Mean Temperature at Hakha Station

```{r Fig1-14, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Hakha Station during 2011-2090"}

hakha_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  
  # scale_color_brewer(palette = "RdBu") +
  scale_y_discrete(limits=c(14:21)) +
  scale_color_hue(l = 15) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
    
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme_excel_new() +
  theme(
  legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-15, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed Vs Projected Annual Mean Temperature under RCP 8.5 at Hakha Station, Chin State, Myanmar"}
hakha_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = max(Tmean.x, na.rm = TRUE),
    Ob_min = min(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.5) +
   geom_line(aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
     legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature at Hakha Station, Chin State, Myanmar

```{r Fig1-16, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Hakha Station, Chin State, Myanmar"}

hakha_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
scale_color_viridis_d() +
  geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  #scale_color_brewer(palette = "RdBu") +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max,  color = "maroon")) +
  # geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min,  color = "maroon")) +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
    
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme_minimal() +
  theme(
  legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-17, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Mean Temperature under RCP 8.5 at Hakha Station, Chin State, Myanmar"}
hakha_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  geom_line(data = hakha_tmean_future_85 %>%
              mutate(Year= year(date),
                     Month = month(date)) %>% 
              group_by(Year) %>% 
              summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(data = hakha_tmean_future_85 %>%
              mutate(Year= year(date),
                     Month = month(date)) %>% 
              group_by(Year) %>% 
              summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.5) +
   geom_line(data = hakha_tmean_future_85 %>%
              mutate(Year= year(date),
                     Month = month(date)) %>% 
              group_by(Year) %>% 
              summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_excel_new() +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
   legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_blank()
  )
```

#### Density Plot of Mean Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-18, fig.width=10, fig.height=8, fig.cap="Density plot of Mean Temperature at Hakha station, Chin State, Myanmar"}
####  Density Plot for hakha station

### RCP 4.5
p1 <- ggplot(hakha_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(hakha_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Hakha station, Chin State, Myanmar \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = hakha_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(hakha_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmean_45_2, 
    aes(x = future, y = ..density..), 
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(hakha_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmean_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.5
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(hakha_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.title = element_text(size = 7),
    axis.text  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    hakha_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(hakha_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift to Right from Baseline (1981-2010) at Hakha station, Chin State, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = hakha_tmean_85_1, 
    aes(x = future, y = ..density..), 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(hakha_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(hakha_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(hakha_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmean_85_2, 
    aes(x = future, y = ..density..), 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(hakha_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(hakha_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(hakha_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmean_85_3, 
    aes(x = future, y = ..density..), 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(hakha_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.title = element_text(size = 7),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

#### Observed Data

```{r}
hakha_tmax <- vroom::vroom(
  "data/Area-2/Hakha/clean_hakha_maxTem.csv",
  delim = " ",
  col_names = c("date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)

hakha_tmax <- hakha_tmax[731:nrow(hakha_tmax), ]
hakha_tmax$date <- ymd(hakha_tmax$date)

 hakha_tmax["Date"] <- ymd(hakha_tmax$date)
 hakha_tmax <- hakha_tmax %>% 
   select(date, Date, Tmax)
```

```{r Fig1-19, fig.width=5, fig.height=7, fig.retina=2, fig.cap = "30 years observed maximum temperature at Hakha station, Chin state, Myanmar"}
p1 <- hakha_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color =as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- hakha_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- hakha_tmax %>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  # geom_hline(yintercept = mean(hakha_tmax$Tmax)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Hakha Station",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- hakha_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(hakha_tmax$Tmax), lty = "dotted", size = 0.3) +
  annotate("text", 
           x = round(mean(hakha_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(hakha_tmax$Tmax), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Hakha",
    caption = "Source: ECD-SNC, DMH"
  ) + theme_minimal() +
  theme(
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Maximum Temperature at Hakha station, Chin State, Myanmar

It is found that maximum temperature doesn't include missing data during
1991-2010. However it is also the same situation with the tmean as data
was not fully available for 30 years. Thus, four time slices (i.e.,
2011-2030, 2031-2050, 2051-2070, 2071-2090) are used as a special case.

```{r}
files <- fs::dir_ls(glob = "*tmax_4_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(
    .x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_4_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")
hakha_tmax_45_1 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_2 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_3 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_4 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# hakha_tmax_45_1;hakha_tmax_45_2;hakha_tmax_45_3
hakha_tmax_future <- bind_rows(
  hakha_tmax_45_1,
  hakha_tmax_45_2,
  hakha_tmax_45_3,
  hakha_tmax_45_4
)
```

```{r Fig1-20, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future <- hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  # facet_wrap(~Model) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-21, fig.width = 8, fig.height = 10, fig.retina=2, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future <- hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60")+
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-3, include = TRUE}
hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2,
  caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar<br><br>")
```

```{r include=FALSE}
hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 32.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 32.5)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-22, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future <- hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Month, y = Ob_mean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-23, fig.width = 7, fig.height = 9, fig.retina=2, fig.cap = "Observed and Projected Maximum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
   geom_line(lty = 'dashed', size = 0.5) +
  scale_color_viridis_b(begin = 0.2) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Month, y = Ob_mean), color = 'brown') + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(
      family = "Pyidaungsu",
      size = 9
    ),
    legend.text = element_text(
      family = "Pyidaungsu",
      size = 5
    ),
    plot.title = element_text(
      family = "Pyidaungsu",
      face = "bold",
      hjust = 0.5,
      size = 10
    ),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "seagreen", color = "violet"),
    strip.text = element_text(family = "Pyidaungsu", size = 7, face = "bold", color = "yellow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 0)
    
  )
```

##### Observed vs. Projected Annual Maximum Temperature

```{r Fig1-24, fig.retina=2, fig.cap="Observed vs. Projected Annual Maximum Temperature by GCM/RCMs (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
   geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y",  strip.position = "top", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(
      family = "Pyidaungsu",
      face = "bold", hjust = 0.5, size = 12
    ),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
     strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "white"),
    strip.background = element_rect(fill = "maroon", color = "black")
  )
```

##### Observed vs. Projected Annual Maximum Temperature by Model

```{r Fig1-25, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed vs. Projected Annual Maximum Temperature by GCM/RCMs (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
   geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y",  strip.position = "top", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(
      family = "Pyidaungsu",
      face = "bold", hjust = 0.5, size = 12
    ),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "white"),
    strip.background = element_rect(fill = "maroon", color = "black"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Annual Maximum Temperature by model

```{r Fig1-26, fig.retina=2, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Hakha Station, Chin State"}
hakha_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Ob_max = max(Tmax.x),
    Ob_min = min(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
   ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_mean = mean(Tmax.x)
              ), 
            aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_max = max(Tmax.x)
              ), 
            aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_min = min(Tmax.x)
              ), 
            aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 4) +
  scale_color_hue(l = 45) +
  
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree,"C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.background = element_rect(colour = "maroon"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    strip.background = element_rect(fill = "brown", color = "yellow")
  )
```

##### Observed and Projected Annual Maximum Temperature by model

```{r Fig1-27, fig.width=7, fig.height=9, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar"}
hakha_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_mean = mean(Tmax.x)
              ), 
            aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_max = max(Tmax.x)
              ), 
            aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(
                Year = year(date),
                Month = month(date)
              ) %>%  
            group_by(
                Model,
                Year
              ) %>% 
            summarize(
                Ob_min = min(Tmax.x)
              ), 
            aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 4) +
  scale_color_hue(l = 45) +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree,"C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.background = element_rect(colour = "maroon"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    strip.background = element_rect(fill = "brown", color = "yellow")
  )
```

#### RCP8.5

##### Observd and Projected Daily Maximum Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-28, fig.cap="Observed vs. Projected Annual Maximum Temperature by GCM/RCMs (RCP 4.5) at Hakha Station, Chin State, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_4_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")
hakha_tmax["Date"] <- ymd(hakha_tmax$Date)
hakha_tmax_85_1 <- hakha_tmax %>%
  mutate(
    Date = Date + 7035 * 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_2 <- hakha_tmax %>%
  mutate(
    Date = Date + 7035 * 2
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_3 <- hakha_tmax %>%
  mutate(
    Date = Date + 7035 * 3
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_4 <- hakha_tmax %>%
  mutate(
    Date = Date + 7035 * 4
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# hakha_tmax_85_1
# hakha_tmax_85_2
# hakha_tmax_85_3
# hakha_tmax_85_4
hakha_tmax_future_85 <- bind_rows(
  hakha_tmax_85_1,
  hakha_tmax_85_2,
  hakha_tmax_85_3,
  hakha_tmax_85_4
)
hakha_tmax_future_85 <- hakha_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

```{r Fig1-29, fig.cap="Observed and Projected Daily Maximum temperature scenario by GCMs/RCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, 'mm'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-30, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Maximum temperature by GCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 5) +
  facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "darkolivegreen" , color = "lightyellow"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-4, include = TRUE}
hakha_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, 
  caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar<br><br>")
```

```{r include=FALSE}
hakha_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 32.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 32.5)
    ) %>% 
  fmt_number(
    columns = c(OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature at

```{r Fig1-31, fig.cap="Observed and Projected Monthly Maximum Temperature by GCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
   geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future_85 %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Month, y = Ob_mean), color = "deeppink", size = 2) + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Monthly Maximum Temperature by Models

```{r Fig1-32, fig.width = 8, fig.height = 10, fig.retina=2, fig.cap="Observed vs. Projected Monthly Maximum Temperature by GCMs at Hakha station, Chin State, Myanmar (RCP 8.5)"}
hakha_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future_85 %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Month, y = Ob_mean), color = 'deeppink', size = 1) + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 4) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    strip.background = element_rect(fill = "darkgreen", color = "yellow" ),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "yellow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 0)
  )
```

##### Observed and Projecte Annual Maximum Temperature at Hakha Station, Chin State, Myanmar

```{r Fig1-33, fig.cap="Observed and Projected Annual Maximum Temperature by GCMs under RCP 8.5 at Hakha Station, Chin State, Myanmar 2011-2090"}
hakha_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") + 
  #  geom_line(data = hakha_tmax_future_85 %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) + 
  #  geom_line(data = hakha_tmax_future_85 %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) + 
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d() +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.background = element_rect(fill = "deepskyblue", colour = "white"),
    panel.background = element_rect(fill = "cornsilk", colour = "black"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "white"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7, color = "black")
    
    
  )
```

##### Observed and Projected Annual Maximum Temperature by Models

```{r Fig1-34, fig.width=7, fig.height=9, fig.cap= "Observed and projected annual maximum temperature by models"}
hakha_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
   geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean)) + 
   geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)),
                        aes(x = Year, y = Ob_mean), color = "grey60") + 
  facet_wrap(~Model, scales = "free_y",  strip.position = "top", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    strip.background = element_rect(fill = "wheat"),
    axis.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

#### Density plots for Maximum Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-35, fig.width=10, fig.height=8, fig.cap= "Density plots for maximum temperature at Hakha station, Chin State, Myanmar"}
####  Density Plot for Hakha station

### RCP 4.5
p1 <- ggplot(hakha_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(hakha_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = hakha_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(hakha_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
   geom_density(
    data =hakha_tmax_45_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmax_45_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmax_45_4$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    hakha_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = hakha_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(hakha_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(hakha_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(hakha_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(hakha_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
    geom_density(
    data =hakha_tmax_85_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmax_85_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmax_85_4$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

#### Observed Data

```{r }
hakha_tmin <- vroom::vroom("data/Area-2/Hakha/clean_hakha_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
## set charactor for further analysis
hakha_tmin$date <- as.character(hakha_tmin$date)
hakha_tmin["year"] <- str_sub(hakha_tmin$date, 1, 4)
hakha_tmin["month"] <- str_sub(hakha_tmin$date, 5, 6)
hakha_tmin["day"] <- str_sub(hakha_tmin$date, 7, 8)
hakha_tmin["Date"] <- make_date(
  hakha_tmin$year,
  hakha_tmin$month,
  hakha_tmin$day
)

## August, September, October, November 1991 missing
miss_ason_date <- seq.Date(ymd("1991-08-01"), ymd("1991-11-30"), "days")
miss_ason_tmin <- hakha_tmin$Tmin[which(hakha_tmin$Date == as.Date("1990-08-01")):(which(hakha_tmin$Date == as.Date("1990-11-30")))]
miss_ason_1991 <- bind_cols(miss_ason_date, miss_ason_tmin)
names(miss_ason_1991) <- c("Date", "Tmin")

hakha_tmin <- hakha_tmin[, c(1, 6, 2)]
hakha_tmin <- hakha_tmin %>%
  drop_na() %>%
  bind_rows(miss_ason_1991) %>%
  mutate(
    Tmin = Hmisc::impute(Tmin, mean)
  ) %>% 
  arrange(Date)
### subset only 20 years
hakha_tmin <- hakha_tmin[730:nrow(hakha_tmin), ]
hakha_tmin["Date"] <- ymd(hakha_tmin$Date)
hakha_tmin$date <- ymd(hakha_tmin$Date)

```

```{r Fig1-36, fig.width=6, fig.height=8, fig.retina=2, fig.cap="30 years observed minimum temperature at Hakha station, Chin State, Myanmar"}
p1 <- hakha_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7),
axis.text.x = element_text(angle = 45)
  #   Month = as.factor(month(Date))
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- hakha_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimun Temperature",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
   plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7),
axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- hakha_tmin %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimumn Temperature at Hakha Station",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7)
  )
p4 <- hakha_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density()+
  geom_vline(xintercept = mean(hakha_tmin$Tmin), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(hakha_tmin$Tmin), 2),
           y = 0.01, label = paste(round(mean(hakha_tmin$Tmin), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Hakha",
    caption = "Source: ECD-SNC, DMH"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Minimum Temperature at Hakha Station

Similarly, the same number of models, years of ascii raster data are
used as an input for Chin state.

```{r Fig1-37, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2090" }
files <- fs::dir_ls(glob = "*tmin_4_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_4_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

hakha_tmin_45_1 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_2 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_3 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_4 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_tmin_future <- bind_rows(
  hakha_tmin_45_1,
  hakha_tmin_45_2,
  hakha_tmin_45_3,
  hakha_tmin_45_4
)
hakha_tmin_future <- hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

hakha_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60")+
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-38, fig.width = 8, fig.height = 10, fig.retina=2, fig.cap= "Observed and Projected Daily Minimum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmin_future <- hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkred") +

  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  
  facet_wrap(~Model, scales = "free_y", ncol = 4) +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")), 
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size =10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightyellow", color = "deepskyblue"),
    strip.text =  element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 90)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-5, include = TRUE}
hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar <br><br>")
```

```{r include=FALSE}
hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 20.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 20.5)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-39, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2090" }
hakha_tmin_future <- hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Month, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-40, fig.width = 8, fig.height = 10, fig.cap="Observed vs. Projected Monthly Minimum Temperature by GCMs/RCMs (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_point() +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Month, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits= abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "top", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    strip.background = element_rect(fill = "lightyellow", colour = "black"),
    strip.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 0)
  )
```

##### Observed and Projected Annual Minimum Temperature

```{r Fig1-41, fig.cap="Observed and Projected Annual Minimum Temperature by GCMs/RCMs (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2090"}
hakha_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = c(seq(2000, 2090, by = 10))) +
  # geom_hline(yintercept = mean(hakha_tmin_future$future) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "bottom") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "wheat", color = "cyan"),
    strip.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature By Model

```{r Fig1-42, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Minimum Temperature by GCMs/RCMs (RCP 4.5) at Hakha Station during 2011-2090"}
hakha_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = c(seq(2000, 2090, by = 10))) +
  # geom_hline(yintercept = mean(hakha_tmin_future$future) +
  facet_wrap(~Model, scales = "free_y", strip.position = "top", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    strip.background = element_rect(fill = "wheat", color = "cyan"),
    strip.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", angle = 90)
  )
```

##### Observed and Projected Annual Minimum Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-43, echo=FALSE, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar 2011-2100"}
hakha_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") + 
  # geom_line(data = hakha_tmin_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), color = "grey60") + 
  # geom_line(data = hakha_tmin_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "grey60") + 
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 # scale_color_brewer(palette = "Reds")+
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.box.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
  )
```

##### Observed and Projected Annual Minimum Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-44, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Hakha Station, Chin State, Myanmar 2011-2100"}
hakha_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") + 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_line(data = hakha_tmin_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), color = "grey60") + 
  # geom_line(data = hakha_tmin_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "grey60") + 
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 # scale_color_brewer(palette = "Reds")+
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.box.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightyellow"),
    strip.text = element_text(face = "bold", size = 7, color = "black")
  )
```

#### RCP8.5

##### Observed and Projected Daily Minimum Temperature at Hakha Station, Chin State, Myanmar

```{r Fig1-45, fig.cap="Observed and Projected Daily Minimum temperature by GCMs/RCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
files <- fs::dir_ls(glob = "*tmin_4_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")
hakha_tmin_85_1 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_2 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_3 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_4 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# hakha_tmin_85_1
# hakha_tmin_85_2
# hakha_tmin_85_3
# hakha_tmin_85_4
hakha_tmin_future_85 <- bind_rows(
  hakha_tmin_85_1, 
  hakha_tmin_85_2, 
  hakha_tmin_85_3, 
  hakha_tmin_85_4)
hakha_tmin_future_85 <- hakha_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
hakha_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
  legend.position = "bottom",
    legend.box.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightyellow"),
    strip.text = element_text(face = "bold", size = 7, color = "black")
  )
```

##### Observed and Objected Daily Minimum Temperature by Model

```{r Fig1-46, fig.width=8, fig.height=10, fig.cap="Observed and Objected Daily Minimum temperature by GCMs/RCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "cornsilk", color = "yellow"),
    strip.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-6, include = TRUE}
hakha_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar <br><br>")
```

```{r include=FALSE}
hakha_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Hakha Station**, Chin State, Myanmar"), 
             subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 20.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 20.5)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-47, fig.cap="Observed and Projected Monthly Minimum temperature by GCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future_85 %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Month, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 50) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-48, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Monthly Minimum temperature by Model at Hakha station, Chin State, Myanmar"}
hakha_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmin_future_85 %>% 
              mutate(Month = month(date)) %>% 
              group_by(Model, Month) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Month, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 50) +
  scale_colour_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "bottom", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "lightcyan", color = "darkgreen"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature

```{r Fig1-49, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 8.5 at Hakha Station, Chin State, Myanmar under different GCMs 2011-2090"}
hakha_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = hakha_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "grey60") + 
  # geom_line(data = hakha_tmin_future_85 %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), color = "grey60") + 
  # geom_line(data = hakha_tmin_future_85 %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "grey60") + 
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "steelblue", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "white"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.title = element_blank(),
    axis.text = element_text(color = "black", size = 7),
    axis.title = element_text(size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model

```{r Fig1-50, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Minimum temperature by GCMs/RCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "grey60") + 
  scale_color_hue(l = 45) +
  #scale_color_viridis_d(direction = -1, option = "D", begin = 0.5)+
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    strip.background = element_rect(fill = "lightcyan", color = "black"),
    strip.text = element_text(face = "bold", size = 7, color = "darkolivegreen"),
    axis.text = element_text(color = "black", size = 7),
    axis.title = element_text(size = 7)
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-51, fig.width=10, fig.height=8, fig.cap = "Mean shift to right from baseline (1981-2010) of Minimum Temperature at Hakha Station, Chin State, Myanmar"}
####  Density Plot for Hakha station

### RCP 4.5
p1 <- ggplot(hakha_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmin$Tmin) -0.2, 2)), 
           y = 0.03, 
           label = paste(round(mean(hakha_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar, \nComparisons of 20 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = hakha_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_2$future) -0.2,  2),
    y = 0.03,
    label = paste(round(mean(hakha_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  
    geom_density(
    data =hakha_tmin_45_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmin_45_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmin_45_4$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    hakha_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar, \nComparisons of 20 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = hakha_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
    geom_density(
    data =hakha_tmin_85_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_4$future), 
    color = "steelblue", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmin_85_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmin_85_4$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Data

There are 61 missing data points which comprise the continuous missing
point for February, 1998 and January, 1991, two additional random points
in June 2004 and 29 Feb 2008. The missing data can quickly be viewed
with the following script
`hakha_preci[which(is.na(hakha_preci$preci)),] %>% view()`.

```{r}
hakha_preci <- vroom::vroom("data/Area-2/Hakha/clean_hakha_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
hakha_preci$Date  <- ymd(hakha_preci$Date)
hakha_preci$preci[32:59] <- hakha_preci$preci[which(hakha_preci$Date == "1990-02-01"):(which(hakha_preci$Date == "1990-02-28"))]
hakha_preci$preci[which(hakha_preci$Date == "1991-01-01"):(which(hakha_preci$Date == "1991-01-31"))] <- hakha_preci$preci[which(hakha_preci$Date == "1990-01-01"):(which(hakha_preci$Date == "1990-01-31"))]
# hakha_preci$date <- as.character(hakha_preci$date) ## set charactor for further analysis
# hakha_preci["year"] <- str_sub(hakha_preci$date, 1, 4)
# hakha_preci["month"] <- str_sub(hakha_preci$date, 5, 6)
# hakha_preci["day"] <- str_sub(hakha_preci$date, 7, 8)
# hakha_preci["Date"] <- make_date(hakha_preci$year, hakha_preci$month, hakha_preci$day)
# 
# ## Feb 1989 missing
# miss_feb_date <- seq.Date(ymd("1989-02-01"), ymd("1989-02-28"), "days")
# miss_feb_prec <- hakha_preci$preci[which(hakha_preci$Date == "1990-02-01"):(which(hakha_preci$Date == "1990-02-28"))]
# miss_feb_1989 <- bind_cols(miss_feb_date, miss_feb_prec)
# names(miss_feb_1989) <- c("Date", "preci")
# miss_j_date <- seq.Date(as.Date("1991-01-01"), as.Date("1991-01-31"), "days")
# miss_j_preci <- hakha_preci$preci[which(hakha_preci$Date == "1990-01-01"):(which(hakha_preci$Date == "1990-01-31"))]
# miss_j_1991 <- cbind.data.frame(miss_j_date, miss_j_preci)
# names(miss_j_1991) <- c("Date", "preci")
# missing_2months <- bind_rows(miss_feb_1989, miss_j_1991)
# hakha_preci <- hakha_preci[, c( 6, 2)]
hakha_preci <- hakha_preci %>%
   #left_join(missing_2months, by = c("Date", "preci")) %>% 
  #arrange(Date) %>%
  mutate(
    preci = Hmisc::impute(preci, mean)
  )

hakha_preci <- hakha_preci[731:nrow(hakha_preci), ]
hakha_preci <- hakha_preci[, c(1, 2)]
hakha_preci["Date"] <- ymd(hakha_preci$Date)
hakha_preci$date <- hakha_preci$Date
```

```{r Fig1-52, fig.width=5, fig.height=6, fig.retina=2, fig.cap="20 years observed precipitation data at Hakha station, Chin State, Myanmar"}
p1 <- hakha_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/20,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Monthly total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p2 <- hakha_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p3 <-  hakha_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Monthly Precipatation at Hakha Stataion over 20 years (1991-2010)",
      caption = "Source: DMH, 2019")+
    ggthemes::theme_tufte() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  
p4 <-  hakha_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(hakha_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(hakha_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(hakha_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipatation at Hakha Stataion over last 20 years (1991-2010)",
      caption = "Source:DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily precipitation

```{r Fig1-53, echo=FALSE, warning=FALSE, message=FALSE}
files <- fs::dir_ls(glob = "*precip_4_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_4_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

hakha_preci_45_1 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_2 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_3 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_4 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_preci_future <- bind_rows(
  hakha_preci_45_1, 
  hakha_preci_45_2, 
  hakha_preci_45_3, 
  hakha_preci_45_4)
hakha_preci_future <- hakha_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

```{r Fig1-54, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Hakha Station, Chin State during 2011-2100"}
hakha_preci_future %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7)
    
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-55, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-7, include = TRUE }
hakha_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/80/12,
    OTotal = sum(preci.x, na.rm = TRUE)/80,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/80
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption ="Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Hakha Station**, Chin State <br><br>")
```

```{r include=FALSE}
hakha_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/80/12,
    OTotal = sum(preci.x, na.rm = TRUE)/80,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/80
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Hakha Station**, Chin State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 178.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 178.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )

hakha_yearly_summary <- hakha_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(hakha_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(hakha_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(hakha_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Hakha is ", mean(hakha_yearly_summary$Total), " mm."))

```

##### Observed vs. Projected Monthly Precipitation

```{r Fig1-56, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Hakha Station, Chin State, Myanmar 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/80,
    Ob_total = sum(preci.x, na.rm = TRUE)/80,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_total), color = "darkred", size = 1) +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 70) +
  #scale_color_brewer(palette = "Spectral") +
  #scale_color_viridis_d(direction = 1)+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )
```

##### Observed vs. Projected Monthly precipitation by Model

```{r Fig1-57, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Monthly total precipitation (RCP 4.5) at Hakha Station, Chin State during 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Month) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/80,
    Ob_total = sum(preci.x, na.rm = TRUE)/80
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_total), color = "darkred", lty = 1) +
  scale_x_discrete(limits = abb.month) +
  scale_color_hue(l = 80) +
 # scale_color_viridis_d(alpha = 0.7, option = "D") +
  facet_wrap(~Model, scales = "free_y", strip.position = "top", ncol = 5) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    caption = "Source:ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.text.x  = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Total Precipitation

```{r Fig1-58, fig.retina=2, fig.cap="Observed and Projected Annual Total Precipitation change (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", size = 1) +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed vs. Projected Annual Total Precipitation by Model

```{r Fig1-59, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Total Precipitation change (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_total), color = "darkred", size = .5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed and Projected Annual Total Precipitation

```{r Fig1-60, fig.retina=2, fig.cap="Observed and Projected Annual Total Precipitation change (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100"}
hakha_preci_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)
    
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(data = hakha_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/4), aes(x = Year, y = Ob_total), color = "darkblue", size = 1) +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed and Projected Annual Total Precipitation by Model

```{r Fig1-61, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Total Precipitation change (RCP 4.5) at Hakha Station, Chin State, Myanmar during 2011-2100" }
hakha_preci_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)
   
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(data = hakha_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/4), aes(x = Year, y = Ob_total), color = "darkblue", size = .5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_4_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# hakha_preci <- vroom::vroom("data/Area-2/Hakha/clean_hakha_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# ## set charactor for further analysis
# hakha_preci$Date <- as.character(hakha_preci$Date) 
# hakha_preci["year"] <- str_sub(hakha_preci$Date, 1, 4)
# hakha_preci["month"] <- str_sub(hakha_preci$Date, 5, 6)
# hakha_preci["day"] <- str_sub(hakha_preci$Date, 7, 8)
# hakha_preci["Date"] <- make_date(hakha_preci$year, hakha_preci$month, hakha_preci$day)
# 
# ## August, September, October, November 1991 missing
# miss_j_date <- seq.Date(as.Date("1991-01-01"), as.Date("1991-01-31"), "days")
# miss_j_preci <- hakha_preci$preci[which(hakha_preci$Date == "1990-01-01"):(which(hakha_preci$Date == "1990-01-31"))]
# miss_j_1991 <- cbind.data.frame(miss_j_date, miss_j_preci)
# names(miss_j_1991) <- c("Date", "preci")
# 
# hakha_preci <- hakha_preci[, c(1, 2)]
# hakha_preci <- hakha_preci %>%
#   drop_na() %>%
#   bind_rows(miss_j_1991) %>%
#   arrange(Date) %>%
#   mutate(
#     preci = Hmisc::impute(preci, mean)
#   )
# 
# hakha_preci <- hakha_preci[731:nrow(hakha_preci), ]

hakha_preci_85_1 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
hakha_preci_85_2 <- hakha_preci %>%
  mutate(
    Date = Date + 7035 * 2 
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
hakha_preci_85_3 <- hakha_preci %>%
  mutate(
    Date = Date + 7035 * 3 
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
hakha_preci_85_4 <- hakha_preci %>%
  mutate(
    Date = Date + 7035 * 4
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# hakha_preci_85_1
# hakha_preci_85_2
# hakha_preci_85_3
hakha_preci_future_85 <- bind_rows(
  hakha_preci_85_1, 
  hakha_preci_85_2, 
  hakha_preci_85_3, 
  hakha_preci_85_4) %>% distinct()
hakha_preci_future_85 <- hakha_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

```{r Fig1-62, fig.cap="Observed and Projected Daliy Precipitation among different GCMs (RCP 8.5) at Hakha station, Chin State, Myanmar"}
hakha_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-63, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Total Precipitation by GCMs at Hakha station, Chin State, Myanmar (RCP 8.5)"}
hakha_preci_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-8, include = TRUE}
hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/80/12,
    OTotal = sum(preci.x, na.rm = TRUE)/80,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/80
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP **8.5** by 2100 at **Hakha Station**, Chin State, Myanmar<br><br>")
```

```{r include=FALSE}
hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/80/12,
    OTotal = sum(preci.x, na.rm = TRUE)/80,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/80
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP **8.5** by 2100 at **Hakha Station**, Chin State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 100
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 178.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 178.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )
```

##### Observed and Projected Monthly Precipitation

```{r Fig1-64, fig.retina=2, fig.cap="Observed and Projected Monthly Total Precipitation under RCP 8.5 at Hakha Station, Chin State, Myanmar 2011-2100"}
hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/80,
    Ob_total = sum(preci.x, na.rm = TRUE)/80,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkred", size = 1)  +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +

  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month",
    y = "Annual Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
   # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly total precipitation by Model

```{r Fig1-65, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Monthly Total Precipitation under RCP 8.5 at Hakha Station, Chin State, Myanmar 2011-2100"}
hakha_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/80,
    Ob_total = sum(preci.x, na.rm = TRUE)/80,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkred", size = 1) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(
      hjust = 0.5, 
      face = "bold", 
      family = "Pyidaungsu"),
    plot.subtitle = element_text(
      hjust = 0.5, 
      face = "bold", 
      family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(
      fill = "lightcyan", 
      colour = "black"),
    panel.background = element_rect(
      fill = "white"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 8),
    strip.background = element_rect(fill = "wheat", color = "yellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 90),
    axis.text.y = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Precipitation

```{r Fig1-66, fig.cap="Observed and Projected Annual Total Precipitation by GCMs/RCMs at Hakha station (RCP 8.5), Chin State, Myanmar"}
hakha_preci_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(data = hakha_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/4), aes(x = Year, y = Ob_total), color = "darkblue") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    strip.text = element_text(family = "Pyidaungsu", size = 7, face = "bold", color = "Darkred"),
    strip.background = element_rect(fill = "deepskyblue", color = "yellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 90),
    axis.text.y = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Precipitation by Models

```{r Fig1-67, fig.width = 10, fig.height = 8, fig.cap="Observed and Projected Annual Total Precipitation by GCMs/RCMs at Hakha station (RCP 8.5), Chin State, Myanmar"}
hakha_preci_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(data = hakha_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/4), aes(x = Year, y = Ob_total), color = "darkblue") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    strip.text = element_text(family = "Pyidaungsu", size = 7, face = "bold", color = "Darkred"),
    strip.background = element_rect(fill = "deepskyblue", color = "yellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 90),
    axis.text.y = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

## Kachin State

### Mean Temperature

#### Observed Data

During the last 30 years, long-term mean of mean temperature is 27.5
Degree with the highest temperature of 33 Degree in May 31th 2005 and
the lowest is 12 Degree Centigrade in January 10th 1983. April and May
are the hottest month with the range of 18 to 33 while December and
January are the coolest months with the range of 12 to 24.5 in
Myitkyina. During rainy season, May-September, daily maximum temperature
is slightly lower than May and likely to higher than April. It is
observed that rainy season gain higher temperature from May to
September. The follow figure depict the characterization of mean
temperature in Myitkyina, Kachin State.

```{r}
myitkyina_tmean <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmean$date <- as.character(myitkyina_tmean$date) ## set charactor for further analysis
myitkyina_tmean["year"] <- str_sub(myitkyina_tmean$date, 1, 4)
myitkyina_tmean["month"] <- str_sub(myitkyina_tmean$date, 5, 6)
myitkyina_tmean["day"] <- str_sub(myitkyina_tmean$date, 7, 8)
myitkyina_tmean["Date"] <- make_date(myitkyina_tmean$year, myitkyina_tmean$month, myitkyina_tmean$day)

## September, October, November 11 1988 missing
miss_son_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-11-11"), "days")
miss_son_tmean <- myitkyina_tmean$Tmean[which(myitkyina_tmean$date == "19870918"):(which(myitkyina_tmean$date == "19871111"))]
miss_son_1988 <- cbind.data.frame(miss_son_date, miss_son_tmean)
names(miss_son_1988) <- c("Date", "Tmean")

myitkyina_tmean <- myitkyina_tmean[, c(1, 6, 2)]
myitkyina_tmean <- myitkyina_tmean %>%
  drop_na() %>%
  dplyr::bind_rows(miss_son_1988) %>%
  dplyr::arrange(Date) 

myitkyina_tmean["date"] <- ymd(myitkyina_tmean$date)
```

```{r Fig1-68, fig.width=5, fig.height=6, fig.retina=2, fig.cap="20 years observed mean temperature at Myitkyina Station, Kachin State, Myanmar"}

p1 <- myitkyina_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle =45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- myitkyina_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature",
    source = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- myitkyina_tmean %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Mean Temperature at Myitkyina Station",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
     plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- myitkyina_tmean %>%
ggplot(aes(x = Tmean, y = ..density..)) +
geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(myitkyina_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(myitkyina_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(myitkyina_tmean$Tmean), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Myitkyina",
    caption = "Source: DMH, 2019"
  ) + theme_minimal() +
  theme(
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
     plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Mean Temperature at Myitkyina Station

Myitkyina is located in Kachin state, in the northernmost part of the
country. There are 56 missing data points which are in year 1988,
September and October. The data is filled using Last Observed Carry
Forward (LOCF) method using the previous year's record.

```{r Fig1-69, Kachin-Tmean, echo=FALSE, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_5_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
#tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_5_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")

myitkyina_tmean_45_1 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_45_2 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_45_3 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# myitkyina_tmean_45_1
# myitkyina_tmean_45_2
# myitkyina_tmean_45_3
myitkyina_tmean_future <- bind_rows(
  myitkyina_tmean_45_1, 
  myitkyina_tmean_45_2, 
  myitkyina_tmean_45_3
  )
myitkyina_tmean_future <- myitkyina_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

myitkyina_tmean_future %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "grey60") + 
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm")
  )
```

##### Observed and Projected Daily Mean Temperaure by Model

In general, all models show varying degree of temperature. Under this
RCP 4.5 scenario, Temperature will be one of a slow onset climate
variable which will increase slowly and gradually until 2100. Almost all
models (32 out of 41) surpass 2 Degree at the end of 21 century as its
maximum. The top ten models which will increases more than 2 Degrees
are 1. HADCM3 with 3.5 Degree, 2. BCC-CSM1-1 with 3.461677 Degree, 3.
GFDL-ESM2G with 3.261953 degree, 4. WAS-44i-MPI-ESM-LR-REMO2009 with
3.123696, 5, GISS-E2-R-CC with 3.094390 degree, 6, FGOALS-G2 with
3.067926 degree, 7. MIROC4H with 3.005813 degree, 8.
WAS-44i-MPI-ESM-LR-RCA4 with 2.756222 degree, 9.
WAS-44i-IPSL-CM5A-MR-RCA4 with 2.744199 and 10. BCC-CSM1-1-M 2.689154
respectively. They highly dominate future mean temperature projection.
The following figure shows the increasing trend of daily maximum
temperature.

```{r Fig1-70, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily mean Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Year) %>%
  #filter(Year %in% c(2020, 2040, 2060, 2080, 2100)) %>% 
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
    geom_line(aes(x = date, y = Tmean.x), color = "grey60") + 
  scale_color_hue(l = 70) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  ggthemes::theme_tufte() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    strip.background = element_rect(fill = "lightcyan", color = "yellow"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-9, include = TRUE}
myitkyina_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar<br><br>")
```

```{r include=FALSE}
myitkyina_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 33.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 33.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Mean Temperature

```{r Fig1-71, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = month.abb) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Mean Temperature by Model

```{r Fig1-72, fig.width=7, fig.height=9, fig.cap="Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen")+
  scale_x_discrete(limits = abb.month) + 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
   # panel.background = element_rect(fill = "black"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    #axis.text.x = element_text(angle = 90),
    strip.background = element_rect(fill = "lightcyan", color = "yellow"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 9),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size =7)
  )
```

##### Observed vs. Projected Monthly Mean Temperature

```{r Fig1-73, fig.cap="Observed vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkgreen")+
  scale_color_hue(l = 45)+
 # scale_x_discrete(limits = month.abb) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Mean Temperature by Model

```{r Fig1-74, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.7) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkgreen")+
 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
   # panel.background = element_rect(fill = "black"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    #axis.text.x = element_text(angle = 90),
    strip.background = element_rect(fill = "lightcyan", color = "yellow"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 9),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size =7)
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig1-75, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.9) +
  geom_line(data = myitkyina_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "darkgreen")+
  scale_color_hue(l = 45)+
 # scale_x_discrete(limits = month.abb) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-76, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.7) +
  geom_line(data = myitkyina_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "darkgreen")+
 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
   # panel.background = element_rect(fill = "black"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "lightcyan", color = "yellow"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 9),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size =7)
  )
```

#### RCP 8.5

##### Observed and Projected Daily Mean Temperature at Myitkyina station, Kachin State, Myanmar

```{r Fig1-77, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_85_1 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_85_2 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_85_3 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# myitkyina_tmean_85_1
# myitkyina_tmean_85_2
# myitkyina_tmean_85_3
myitkyina_tmean_future_85 <- bind_rows(
  myitkyina_tmean_85_1, 
  myitkyina_tmean_85_2, 
  myitkyina_tmean_85_3
  )
myitkyina_tmean_future_85 <- myitkyina_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
myitkyina_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) + 
    geom_line(aes(x = date, y = Tmean.x), color = "grey60") + 
  scale_color_hue(l = 45) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(myitkyina_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )

```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-78, fig.width = 7, fig.height=9, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
    geom_line(aes(x = date, y = Tmean.x), color = "grey60") + 
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_text(family = "Pyidaungsu", size = 12),
    legend.key.height = unit(0.4, "mm"),
    #axis.text.x = element_blank(),
    strip.text = element_text(family = "Pyidaungsu", face ="bold", size = 10),
    strip.background = element_rect(fill = "wheat", color = "yellow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
    
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-10, include = TRUE}
myitkyina_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State")
```

```{r include=FALSE}
myitkyina_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 33.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 33.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed vs. Projected Monthly Mean Temperature at Myitkyina station

```{r Fig1-79, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Myitkyina Station during 2011-2100"}
myitkyina_tmean_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.5) +
  geom_line(aes(x =Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Monthly Mean Temperature by Model

```{r Fig1-80, fig.width=7, fig.height=9, fig.cap= "Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
   summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.5) +
  geom_line(aes(x =Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.text = element_text(family = "Pyidaungsu", face ="bold", size = 7),
    strip.background = element_rect(fill = "wheat", color = "yellow")
  )
```

##### Observed vs. Projected Annual Mean Temperature at Myitkyina Station, Kachin State, Myanmar

```{r Fig1-81, fig.cap = "Observed vs. Projected Annual Mean Temperature under RCP 8.5 at Myitkyina Station", echo=FALSE}
# colorcount = length(unique(myitkyina_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
myitkyina_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = max(Tmean.x, na.rm = TRUE),
    Ob_min = min(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_max),  color = "maroon") +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  #scale_color_brewer(palette = "RdBu") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.text = element_text(family = "Pyidaungsu", face ="bold", size = 7),
    strip.background = element_rect(fill = "wheat", color = "yellow")
  )
```

##### Observed vs. Projected Annual Mean Temperature by Model

```{r Fig1-82, fig.width = 7, fig.height=9, fig.cap="Observed vs. Projected Annual Mean Temperature under RCP 8.5 at Myitkyina Station, Kachin state, Myanmar"}
# colorcount = length(unique(myitkyina_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
myitkyina_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = max(Tmean.x, na.rm = TRUE),
    Ob_min = min(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "skyblue", colour = "white"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Annual Mean Temperature at Myitkyina Station, Kachin State, Myanmar

```{r Fig1-83, fig.cap = "Observed and Projected Annual Mean Temperature under RCP 8.5 at Myitkyina Station", echo=FALSE}
# colorcount = length(unique(myitkyina_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
myitkyina_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max),  color = "maroon") +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  #scale_color_brewer(palette = "RdBu") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.text = element_text(family = "Pyidaungsu", face ="bold", size = 7),
    strip.background = element_rect(fill = "wheat", color = "yellow")
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-84, fig.width = 7, fig.height=9, fig.cap="Observed and Projected Annual Mean Temperature under RCP 8.5 at Myitkyina Station, Kachin state, Myanmar"}
# colorcount = length(unique(myitkyina_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
myitkyina_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 14),
    plot.background = element_rect(fill = "skyblue", colour = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

#### Density Plot of Mean Temperature at Myitkyina station, Kachin State, Myanmar

```{r Fig1-85, fig.width=10, fig.height=8, fig.cap="Mean shift to Right from baseline (1981-2010) of Mean Temperature at Myitkyina station, Kachin State, Myanmar"}
####  Density Plot for Pathein station

### RCP 4.5
p1 <- ggplot(myitkyina_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(myitkyina_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3, 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(myitkyina_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(myitkyina_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(myitkyina_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    myitkyina_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(myitkyina_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(myitkyina_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(myitkyina_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(myitkyina_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text  = element_text(size = 7),
        axis.title = element_text(face = "bold", size = 7, color = "grey60"))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

#### Observed Data

During the last 30 years, long-term mean of maximum temperature is 30
Degree with the highest temperature of 41 Degree in May 30th 2005 and
the lowest is 15 Degree Centigrade in January 10th 1983. April and May
are the hottest month with the range of 20 to 41 while December and
January are the coolest months with the range of 15 to 30 in Myitkyina.
During rainy season, May-September, daily maximum temperature is
decreased. The follow figure depict the characterization of maximum
temperature in Myitkyina, Kachin State.

```{r}
myitkyina_tmax <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmax$date <- as.character(myitkyina_tmax$date) ## set charactor for further analysis
myitkyina_tmax["year"] <- str_sub(myitkyina_tmax$date, 1, 4)
myitkyina_tmax["month"] <- str_sub(myitkyina_tmax$date, 5, 6)
myitkyina_tmax["day"] <- str_sub(myitkyina_tmax$date, 7, 8)
myitkyina_tmax["Date"] <- make_date(myitkyina_tmax$year, myitkyina_tmax$month, myitkyina_tmax$day)
## September, October, November 11 1988 missing
miss_son_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-11-11"), "days")
miss_son_tmax <- myitkyina_tmax$Tmax[(2818 - 365):(2872 - 365)]
miss_son_1988 <- cbind.data.frame(miss_son_date, miss_son_tmax)
names(miss_son_1988) <- c("Date", "Tmax")

myitkyina_tmax <- myitkyina_tmax[, c(1, 6, 2)]
myitkyina_tmax <- myitkyina_tmax %>%
  drop_na() %>%
  bind_rows(miss_son_1988) %>%
  fill()
myitkyina_tmax$date <- ymd(myitkyina_tmax$date)
```

```{r Fig1-86, fig.width=5, fig.height=6, fig.retina=2, fig.cap="30 years observed maximum temperature at Myitkyina station, Kachin State, Myanmar"}

p1 <- myitkyina_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Max = max(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Max Temperature",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- myitkyina_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Max = max(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Max Temperature",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- myitkyina_tmax %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Myitkyina Station",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p4 <- myitkyina_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(adjust = 5) +
  geom_vline(xintercept = mean(myitkyina_tmax$Tmax), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(myitkyina_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(myitkyina_tmax$Tmax), 2), "C"), size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Myitkyina",
    caption = "Source: DMH, 2019"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Maximum Temperature

There are 55 missing values in 1988 which are filled using last
observation carry forward method.

```{r Fig1-87, echo=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_5_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_5_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

myitkyina_tmax_45_1 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_45_2 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_45_3 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

# myitkyina_tmax_45_1;myitkyina_tmax_45_2;myitkyina_tmax_45_3
myitkyina_tmax_future <- bind_rows(
  myitkyina_tmax_45_1, 
  myitkyina_tmax_45_2, 
  myitkyina_tmax_45_3)
myitkyina_tmax_future <- myitkyina_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y= Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color ="grey85"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-88, fig.width= 7, fig.height=9, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar"}
myitkyina_tmax_future <- myitkyina_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 70) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 9),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-11, include = TRUE}
myitkyina_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(10) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar<br><br>")
```

```{r include=FALSE}
myitkyina_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 41.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 41.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature at Myitkyina Station, Kachin State, Myanmar

```{r Fig1-89, fig.cap="Observed vs. Projected Monthly Maximum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
   summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Monthly Maximum Temperature by Model

```{r Fig1-90, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Monthly Maximum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey85"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 9),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
    
  )
```

##### Observed vs. Projected Annual Maximumm Temperature (Closet measure)

```{r Fig1-91, fig.cap= "Observed (in dark green dotdashed line) vs. Projected Annual Maximum Temperature at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen", size = 1, lty = 1) +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
     legend.position = "top",
     legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed vs. Projected Annual Maximumm Temperature by Model (Closet measure)

```{r Fig1-92, fig.width=7, fig.height=9, fig.cap= "Observed vs. Projected Annual Maximum Temperature at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_point(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed and Projected Annual Maximum Temperature at Myitkyina station

```{r Fig1-93, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Myitkyina Station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_max),  color = "maroon") +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.background = element_rect(fill = "lightyellow"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Observed and Projected Annual Maximum Temperature by Model at Myitkyina station

```{r Fig1-94, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Myitkyina Station, Kachin State, Myanmar"}
myitkyina_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_max),  color = "maroon") +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x, na.rm = TRUE)), aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.background = element_rect(fill = "lightyellow"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Maximum Temperature at Myitkyina Station, Kachin State, Myanmar

```{r Fig1-95, fig.cap="Daily maximum temperature scenario variation among different GCMs  at Myitkyina station (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmax_5_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# myitkyina_tmax <- vroom::vroom("data/Area-1/myitkyina/clean_myitkyina_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
myitkyina_tmax["Date"] <- ymd(myitkyina_tmax$Date)
myitkyina_tmax_85_1 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_85_2 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_85_3 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

# myitkyina_tmax_85_1
# myitkyina_tmax_85_2
# myitkyina_tmax_85_3
myitkyina_tmax_future_85 <- bind_rows(
  myitkyina_tmax_85_1, 
  myitkyina_tmax_85_2, 
  myitkyina_tmax_85_3)
myitkyina_tmax_future_85 <- myitkyina_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "black")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-96, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily maximum temperature among different GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model,  ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "black"),
    strip.background = element_rect(fill = "lightyellow", color = "yellow"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-12, include = TRUE}
myitkyina_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Myitkyana Station**, Kachin State, Myanmar")
```

```{r include=FALSE}
myitkyina_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Myitkyana Station**, Kachin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 41.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 41.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature at Myitkyina Station, Kachin State, Myanmar

```{r Fig1-97, fig.cap="Monthly maximum temperature among different GCM (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "red")+
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Observed vs. Projected Monthly Maximum Temperature by Model

```{r Fig1-98, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Monthly maximum temperature (RCP 8.5) by GCMs at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm")
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Maximum Temperature at Myitkyna station, Kachin state, Myanmar

```{r Fig1-99, fig.cap= "Observed vs. Projected Annual Maximum Temperature by GCMs under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Ob_max = max(Tmax.x),
    Ob_min = min(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
    geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
    geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
    geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 70) +
  scale_color_viridis_d(option = "D") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    axis.text = element_text(color = "black", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Maximum Temperature at Myitkyna station, Kachin state, Myanmar

```{r Fig1-100, fig.width=7, fig.height=9, fig.cap= "Annual Maximum Temperature by GCMs under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Ob_max = max(Tmax.x),
    Ob_min = min(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
    geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
    geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
    geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 70) +
  scale_color_viridis_d(option = "D") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.text = element_text(color = "black", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Maximum Temperature

```{r Fig1-101, fig.cap="Observed vs. Projected Annual Maximum temperature by GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Obb_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = myitkyina_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(aes(x = Year, y = Obb_mean), color = "maroon") +
  #facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "wheat"),
    strip.text = element_text(face = "bold", size = 9, color = "darkred")
  )
```

##### Observed and Projected Annual Maximum Temperature by Model

```{r Fig1-102, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Annual Maximum temperature by GCMs (RCP 8.5)  at Myitkyina station, Kachin State, Myanmar" }
myitkyina_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Obb_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = myitkyina_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(aes(x = Year, y = Obb_mean), color = "maroon") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "wheat"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

#### Density plots for Maximum Temperature

```{r Fig1-103, fig.width=10, fig.height=8, fig.cap="Mean shift to Right from Baseline (1981-2010) of Projected Maximum temperature at Myitkyina Station, Kachin State, Myanmar"}
####  Density Plot for Myitkyina station

### RCP 4.5
p1 <- ggplot(myitkyina_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(myitkyina_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar\nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = myitkyina_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(myitkyina_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text  = element_text(size = 7),
    axis.title = element_text(size = 7),
    plot.caption = element_text(face = "italic", size = 7, color = "grey60"),)
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    myitkyina_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source:ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(myitkyina_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(myitkyina_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),)

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

#### Observed Data

```{r}
myitkyina_tmin <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmin$date <- as.character(myitkyina_tmin$date) ## set charactor for further analysis
myitkyina_tmin["year"] <- str_sub(myitkyina_tmin$date, 1, 4)
myitkyina_tmin["month"] <- str_sub(myitkyina_tmin$date, 5, 6)
myitkyina_tmin["day"] <- str_sub(myitkyina_tmin$date, 7, 8)
myitkyina_tmin["Date"] <- make_date(myitkyina_tmin$year, myitkyina_tmin$month, myitkyina_tmin$day)
## September18-30 1988 missing
miss_s_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-09-30"), "days")
miss_s_tmin <- myitkyina_tmin$Tmin[(2818 - 365):(2830 - 365)]
miss_s_1988 <- cbind.data.frame(miss_s_date, miss_s_tmin)
names(miss_s_1988) <- c("Date", "Tmin")

myitkyina_tmin <- myitkyina_tmin[, c(1, 6, 2)]
myitkyina_tmin <- myitkyina_tmin %>%
  drop_na() %>%
  bind_rows(miss_s_1988)

myitkyina_tmin$date <- ymd(myitkyina_tmin$date)
```

```{r Fig1-104, fig.width=5, fig.height=6, fig.retina=2, fig.cap="30 years observed minimum temperature at Myitkyina station, Kachin State, Myanmar"}

p1 <- myitkyina_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Max = max(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mininum Temperature",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- myitkyina_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Max = max(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimum Temperature",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- myitkyina_tmin %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimum Temperature at Myitkyina Station",
    caption = "Source:DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p4 <- myitkyina_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density()+
  geom_vline(xintercept = mean(myitkyina_tmin$Tmin), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(myitkyina_tmin$Tmin), 2),
           y = 0.01, label = paste(round(mean(myitkyina_tmin$Tmin), 2), "C"), size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Myitkyina",
    caption = "Source: DMH, 2019"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Minimum Temperature at Myitkyina station, Kachin State, Myanmar

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-105, echo=FALSE, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_4_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_4_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


myitkyina_tmin_45_1 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_45_2 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_45_3 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_tmin_future <- bind_rows(
  myitkyina_tmin_45_1, 
  myitkyina_tmin_45_2, 
  myitkyina_tmin_45_3)
myitkyina_tmin_future <- myitkyina_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
myitkyina_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-106, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 70) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightyellow", color = "orange"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 8, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-13, include = TRUE}
myitkyina_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar<br><br>")
```

```{r include=FALSE}
myitkyina_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature

```{r Fig1-107, fig.cap="Observed vs. Projected Monthly Minimum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "red") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-108, fig.width = 7, fig.height=9, fig.cap="Observed vs. Projected Monthly Minimum Temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, fill = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "red", size = 0.7) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month)+
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightyellow", color = "black"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 8),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-109, echo=FALSE, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 4.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_colour_viridis_d(option = "D") +
  scale_color_hue(l = 70) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange", ),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightcyan", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-110, echo=FALSE, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 4.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_colour_viridis_d(option = "D") +
  scale_color_hue(l = 70) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange", ),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightcyan", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 8, color = "white")
  )
```

##### Observed and Projected Annual Minimum Temperature by Model at Myitkyina station, Kachin state, Myanmar

```{r Fig1-111, fig.cap="Observed and Projected Annual Minimum Temperature (RCP 4.5) at Myitkyina Station during 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 70) +
  scale_y_discrete(limits = c(18:22)) +
  #facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange", ),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightcyan", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model at Myitkyina station, Kachin state, Myanmar

```{r Fig1-112, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Minimum Temperature (RCP 4.5) at Myitkyina Station during 2011-2100"}
myitkyina_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 70) +
  scale_y_discrete(limits = c(18:22)) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange", ),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightcyan", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan", color = "white"),
    strip.text = element_text(face = "bold", size = 8, color = "darkblue")
  )
```

#### RCP8.5

##### Observed and Projected Daiy Minimum Temperature at Myitkyina Station

```{r Fig1-113, fig.cap="Observed and Projected Daily Minimum temperature scenario among different GCMs at Myitkyina station (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmin_5_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

myitkyina_tmin_85_1 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_85_2 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_85_3 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )

# myitkyina_tmin_85_1
# myitkyina_tmin_85_2
# myitkyina_tmin_85_3
myitkyina_tmin_future_85 <- bind_rows(
  myitkyina_tmin_85_1, 
  myitkyina_tmin_85_2, 
  myitkyina_tmin_85_3
  )
myitkyina_tmin_future_85 <- myitkyina_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
myitkyina_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Daily Minimum Temperature by Model

```{r Fig1-114, fig.width=7, fig.height=9, fig.cap="Daily Minimum temperature scenario among different GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar "}
myitkyina_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60" ) +
  scale_color_hue(l = 70) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "lightyellow", color = "orange"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 8),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-14, include = TRUE}
myitkyina_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar<br><br>")
```

```{r, include=FALSE}
myitkyina_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature

```{r Fit1-115, fig.cap="Observed vs. Projected Monthly Minimum temperature among different GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-116, fig.width = 7, fig.height=9, fig.cap="Observed vs. Projected Monthly Minimum temperature among different GCMs at Myitkyina station (RCP 8.5)"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
    strip.background = element_rect(fill="maroon", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-117, echo=FALSE, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar under different GCMs 2011-2100"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 25, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "cornsilk", color = "blue"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 10)
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-118, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar under different GCMs 2011-2100"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d() +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.subtitle = element_text(hjust = 0.5, family = "Pyidaungsu", face = "bold", color = "maroon"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "cornsilk", color = "blue"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 10)
  )
```

##### Observed and Projected Annual Minimum Temperature

```{r Fig1-119, fig.cap="Observed and Projected Annual Minimum temperature scenario by GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "cornsilk", color = "blue"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 10)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model

```{r Fig1-120, fig.width = 7, fig.height=9, fig.cap="Observed and Projected Minimum temperature scenario by GCMs (RCP 8.5) at Myitkyina station, Kachin State, Myanmar"}
myitkyina_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = myitkyina_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 45, 0, 0, "pt"),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    strip.background = element_rect(fill = "cornsilk", color = "blue"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 10)
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-121, fig.width=10, fig.height=8, fig.cap= "Mean shift from baseline (1981-2010) of Projected Minimum Temperature at Myitkyina Station, Myanmar"}
####  Density Plot for Myitkyina station

### RCP 4.5
p1 <- ggplot(myitkyina_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmin$Tmin) -0.2, 2)), 
           y = 0.06, 
           label = paste(round(mean(myitkyina_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = myitkyina_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_2$future) -0.2,  2),
    y = 0.06,
    label = paste(round(mean(myitkyina_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
   theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    myitkyina_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Precipitation

```{r}
myitkyina_preci <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
myitkyina_preci["Date"] <- ymd(myitkyina_preci$Date)
myitkyina_preci$date <- myitkyina_preci$Date
```

```{r Fig1-122, fig.width=5, fig.height=6, fig.retina=2, fig.cap="30 years observed precipitation data at Myitkyina Station, Kachin State, Myanmar"}
p1 <- myitkyina_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/30,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed monthly total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
p2 <- myitkyina_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
p3 <-  myitkyina_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) 
      ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipitation at Myitkyina Station (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(legend.position = "none",
        plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
        plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
        axis.title = element_text(face = "bold", size = 7),
        axis.text = element_text(face = "bold", size = 7))
  
p4 <-  myitkyina_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(myitkyina_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(myitkyina_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(myitkyina_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipitation at Myitkyina Station (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(
     plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
     plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
     axis.title = element_text(face = "bold", size = 7),
     axis.text = element_text(face = "bold", size = 7)
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily precipitation at Myitkyina Station, Kachin State, Myanmar

```{r}
files <- fs::dir_ls(glob = "*precip_5_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_5_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


myitkyina_preci_45_1 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_45_2 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_45_3 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
### myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_preci_future <- bind_rows(
  myitkyina_preci_45_1, 
  myitkyina_preci_45_2, 
  myitkyina_preci_45_3)
myitkyina_preci_future <- myitkyina_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

```{r Fig1-123, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, during 2011-2100"}
myitkyina_preci_future %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Precipitation by Model at Myitkyina station, Kachin state, Myanmar

```{r Fig1-124, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Myitkyina Station during 2011-2100"}
myitkyina_preci_future %>%
  distinct() %>% 
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 4.5

```{r Table1-15, include = TRUE}
myitkyina_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar <br><br>")
  
```

```{r include=FALSE}
myitkyina_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 178.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 178.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )

myitkyina_yearly_summary <- myitkyina_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(myitkyina_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(myitkyina_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(myitkyina_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Myitkyina is ", mean(myitkyina_yearly_summary$Total), " mm."))

```

##### Observed vs. Projected Monthly Precipitation

```{r Fig1-125, fig.cap="Observed vs. Projected Monthly Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90
      ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(lty = 3) +
  geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +

 # geom_col(aes(x = Month, y = Ob_total/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Precipitation by Model

```{r Fig1-126, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Monthly Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation at Myitkyina Station

```{r Fig1-127, fig.cap="Observed vs. Projected Annual Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE)
      ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(lty = 1) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", size = 1, lty = 1, alpha = 0.5) +

 # geom_col(aes(x = Month, y = Ob_total/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation by Model

```{r Fig1-128, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  #geom_smooth() +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", lty = 1, alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation at Myitkyina Station

```{r Fig1-129, fig.cap="Observed vs. Projected Annual Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(lty = 3) +
  geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(data = myitkyina_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue") +

 # geom_col(aes(x = Month, y = Ob_total/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation by Model

```{r Fig.1-130, fig.width=7, fig.height=9, fig.cap= "Observed vs. Projected Annual Precipitation (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar during 2011-2100"}
myitkyina_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_smooth(method = "lm") +
  geom_line(data = myitkyina_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue", lty = 1) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_4_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# myitkyina_preci <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# myitkyina_preci["Date"] <- ymd(myitkyina_preci$Date)
myitkyina_preci_85_1 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
myitkyina_preci_85_2 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
myitkyina_preci_85_3 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# myitkyina_preci_85_1
# myitkyina_preci_85_2
# myitkyina_preci_85_3
myitkyina_preci_future_85 <- bind_rows(
  myitkyina_preci_85_1, 
  myitkyina_preci_85_2, 
  myitkyina_preci_85_3
  )
myitkyina_preci_future_85 <- myitkyina_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

```{r Fig1-131, fig.cap="Observed and Projeced Daily Precipitation among different GCMs at Myitkyina station, Kachin State, Myanmar (RCP 8.5) "}
myitkyina_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daliy Precipitation by Model

```{r Fig1-132, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Myitkyina station, Kachin State, Myanmar (RCP 8.5)"}
myitkyina_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  stat_smooth() +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

```{r Table1-16, include = TRUE}
myitkyina_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   knitr::kable(digits = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar<br>")
```

```{r include=FALSE}
myitkyina_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Myitkyina Station**, Kachin State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 178.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 178.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )

# myitkyina_yearly_summary <- myitkyina_preci %>%
#      mutate(
#     Year = year(Date),
#   Month = month(Date)) %>%
#    group_by(Month) %>%
#    summarize(Total = sum(preci),
#                n = n())
# 
# ggplot(myitkyina_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
#   geom_col() +
#   geom_hline(yintercept = mean(myitkyina_yearly_summary$Total))+
#   annotate("text", x = 2003, y = mean(myitkyina_yearly_summary$Total) + 200,
#            label = paste("The average monlty rainfall in Myitkyina is ", mean(myitkyina_yearly_summary$Total), " mm."))

```

##### Observed vs. Projected Monthly Precipitation

```{r Fig1-133, fig.cap="Observed vs. Projected Monthly Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.9) +
  stat_smooth(alpha = 0.5) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") + 
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Total Precipitation by Model

```{r Fig1-134, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Monthly Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  stat_smooth() +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
 legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed vs. Projected Annual Precipitation

```{r Fig1-135, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  #geom_smooth(method = "lm", se = FALSE, alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") + 
  scale_color_hue(l = 45) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Total Precipitation by Model

```{r Fig1-136, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Monthly Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  stat_smooth(method = "lm") +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  annotate("text", x = 2050, y = 1990, label = "Observed", color = "grey60") +
  theme_minimal() +
  theme(
 legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation

```{r Fig1-137, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  #geom_smooth(method = "lm", se = FALSE, alpha = 0.5) +
  geom_line(data = myitkyina_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue") + 
  scale_color_hue(l = 45) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Total Precipitation by Model

```{r Fig1-138, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Myitkyina Station, Kachin State, Myanmar 2011-2100"}
myitkyina_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  stat_smooth(method = "lm") +
  geom_line(data = myitkyina_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  # annotate("text", x = 2050, y = 1990, label = "Observed", color = "grey60") +
  theme_minimal() +
  theme(
 legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

## Southern Shan State

### Mean Temperature

#### Observed Data

```{r}
taunggyi_tmean <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmean$date <- as.character(taunggyi_tmean$date) ## set charactor for further analysis
taunggyi_tmean["year"] <- str_sub(taunggyi_tmean$date, 1, 4)
taunggyi_tmean["month"] <- str_sub(taunggyi_tmean$date, 5, 6)
taunggyi_tmean["day"] <- str_sub(taunggyi_tmean$date, 7, 8)
taunggyi_tmean["Date"] <- make_date(taunggyi_tmean$year, taunggyi_tmean$month, taunggyi_tmean$day)

## November and December 1984 missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmean <- taunggyi_tmean$Tmean[which(taunggyi_tmean$date == "19831101"):(which(taunggyi_tmean$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmean)
names(miss_nd_1984) <- c("Date", "Tmean")

taunggyi_tmean <- taunggyi_tmean[, c(6, 2)]
taunggyi_tmean <- taunggyi_tmean %>%
  drop_na() %>%
  bind_rows(miss_nd_1984) %>%
  fill()
### subset only 20 years
# taunggyi_tmean <- taunggyi_tmean[731:nrow(taunggyi_tmean),]

taunggyi_tmean["Date"] <- ymd(taunggyi_tmean$Date)
taunggyi_tmean <- taunggyi_tmean %>% mutate(
  Tmean = Hmisc::impute(Tmean, mean)
)
taunggyi_tmean$date <- taunggyi_tmean$Date
```

```{r Fig1-139, fig.width=5, fig.height=6, fig.retina=2, fig.cap="30 years observed mean temperature at Taunggyi station, southern Shan State, Myanmar"}

p1 <- taunggyi_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- taunggyi_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- taunggyi_tmean %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Mean Temperature at Taunggyi Station",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- taunggyi_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density()+
  geom_vline(xintercept = mean(taunggyi_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(taunggyi_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(taunggyi_tmean$Tmean), 2), "C"), size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Taunggyi"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Mean Temperature

Taunggyi station is located in Southern Shan state. There are 68 missing
data points, some of which are found in 1984 where November and December
months are completely missing while some of which are interestingly
located at each month of 31st day in 1992. The data is filled using Last
Observed Carry Forward (LOCF) method using `fill()` function for the
previous day.

```{r Fig1-140, echo=FALSE, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_17_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
# tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_17_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")

taunggyi_tmean_45_1 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_45_2 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_45_3 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# taunggyi_tmean_45_1
# taunggyi_tmean_45_2
# taunggyi_tmean_45_3
taunggyi_tmean_future <- bind_rows(
  taunggyi_tmean_45_1, 
  taunggyi_tmean_45_2, 
  taunggyi_tmean_45_3
  )
taunggyi_tmean_future <- taunggyi_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
taunggyi_tmean_future %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_alpha(0.5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH", 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
  )

### Adding plots
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-141, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-17, include = TRUE}
taunggyi_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State, Myanmar<br><br>")
```

```{r include=FALSE}
taunggyi_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 28.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 28.5)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Mean Temperature at Taunggyi Station, Southern Shan State

```{r Fig1-142, fig.cap="Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Observed vs. Projected Monthly Mean of Mean Temperature by Model

```{r Fig1-143, fig.width=6, fig.height=8, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "snow"),
    plot.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "darkred", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "wheat"),
    axis.title = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed vs. Projected Annual Mean Temperature at Taunggyi Station, Southern Shan State

```{r Fig1-144, fig.cap="Observed vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  #scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Observed vs. Projected Annual Mean of Mean Temperature by Model

```{r Fig1-145, fig.width=6, fig.height=8, fig.cap="Observed vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "snow"),
    plot.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "darkred", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "wheat"),
    axis.title = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text.x = element_text(angle = 360)
  )
```

##### Observed and Projected Annual Mean Temperature at Taunggyi Station, Southern Shan State

```{r Fig1-146, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = taunggyi_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm=TRUE)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  #scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
```

##### Observed and Projected Annual Mean of Mean Temperature by Model

```{r Fig1-147, fig.width=6, fig.height=8, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "solid", size = 0.5) +
  geom_line(data = taunggyi_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm=TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "snow"),
    plot.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "darkred", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "wheat"),
    axis.title = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text.x = element_text(angle = 45)
  )
```

#### RCP 8.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-148, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) namong GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}

taunggyi_tmean_85_1 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_85_2 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_85_3 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# taunggyi_tmean_85_1
# taunggyi_tmean_85_2
# taunggyi_tmean_85_3
taunggyi_tmean_future_85 <- bind_rows(
  taunggyi_tmean_85_1, 
  taunggyi_tmean_85_2, 
  taunggyi_tmean_85_3)
taunggyi_tmean_future_85 <- taunggyi_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
taunggyi_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey85"),
    axis.text = element_text(face = "bold", size = 7, color = "grey85"),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-149, fig.width=6, fig.height=8, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey60") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
      legend.position = "none",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
     strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey85"),
    axis.text = element_text(face = "bold", size = 7, color = "grey85"),
   # axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-18, include = TRUE}
taunggyi_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable(caption = "Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State")
```

```{r include=FALSE}
taunggyi_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature exceeding **4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 28.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 28.5)
    ) %>% 
  fmt_number(
    columns = c( OMean, 
                 OMax, 
                 Observed_Min, 
                 MMax, 
                 MMean, 
                 MMin, 
                 PMax, 
                 PMean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed vs. Projected Monthly Mean Temperature

```{r Fig1-150, fig.cap="Observed and Projected Monthly Mean of Mean Temperature (RCP 8.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future), 
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y  = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
       legend.position = "top",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey85"),
    axis.text = element_text(face = "bold", size = 7, color = "grey85"),
   axis.text.x = element_text(angle = 45)
  )
```

##### Observed vs. Projected Monthly Mean Temperature by Model

```{r Fig1-151, fig.width=6, fig.height=8, fig.cap="Observed vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(taunggyi_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey85"),
    axis.text = element_text(face = "bold", size = 7, color = "grey85"),
   axis.text.x = element_text(angle = 360)
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Mean Temperature

```{r Fig1-152, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar"}
# colorcount = length(unique(taunggyi_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
taunggyi_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmean.x)),
            aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmean.x)),
            aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "C") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "top",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey95"),
    axis.text = element_text(face = "bold", size = 7, color = "grey95"),
   # axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Mean Temperature by model

```{r Fig1-153, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar"}
# colorcount = length(unique(taunggyi_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
taunggyi_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmean.x)),
            aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(data = taunggyi_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmean.x)),
            aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "C") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
      legend.position = "none",
    panel.background = element_rect(fill = "snow"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey95"),
    axis.text = element_text(face = "bold", size = 7, color = "grey95"),
   axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Annual Mean, Max, Min of Mean Temperature

```{r Fig1-154, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar"}
# colorcount = length(unique(taunggyi_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
taunggyi_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = mean(Tmean.x, na.rm = TRUE),
    Ob_min = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "C") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "top",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey95"),
    axis.text = element_text(face = "bold", size = 7, color = "grey95"),
   # axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Max, Min of Mean Temperature by model

```{r Fig1-155, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar"}
# colorcount = length(unique(taunggyi_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
taunggyi_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
   Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = mean(Tmean.x, na.rm = TRUE),
    Ob_min = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "C") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
      legend.position = "none",
    panel.background = element_rect(fill = "snow"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7, color = "grey95"),
    axis.text = element_text(face = "bold", size = 7, color = "grey95"),
   axis.text.x = element_text(angle = 45)
  )
```

#### Density Plot of Mean Temperature at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-156, fig.width=10, fig.height=8, fig.cap="Mean shift from the baseline (1981-2010) of projected mean temperature at Taunggyi station, Southern Shan State, Myanmar"}
####  Density Plot for Pathein station

### RCP 4.5
p1 <- ggplot(taunggyi_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(taunggyi_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(taunggyi_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(taunggyi_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = taunggyi_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(taunggyi_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    taunggyi_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift to Right from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = taunggyi_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

#### Observed Data

```{r}
taunggyi_tmax <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmax$date <- as.character(taunggyi_tmax$date) ## set charactor for further analysis
taunggyi_tmax["year"] <- str_sub(taunggyi_tmax$date, 1, 4)
taunggyi_tmax["month"] <- str_sub(taunggyi_tmax$date, 5, 6)
taunggyi_tmax["day"] <- str_sub(taunggyi_tmax$date, 7, 8)
taunggyi_tmax["Date"] <- make_date(taunggyi_tmax$year, taunggyi_tmax$month, taunggyi_tmax$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmax <- taunggyi_tmax$Tmax[(which(taunggyi_tmax$date == "19831101")):(which(taunggyi_tmax$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmax)
names(miss_nd_1984) <- c("Date", "Tmax")

taunggyi_tmax <- taunggyi_tmax[, c(1, 6, 2)]
taunggyi_tmax <- taunggyi_tmax %>%
  drop_na() %>%
  bind_rows(miss_nd_1984)

taunggyi_tmax$date <- ymd(taunggyi_tmax$Date)
```

```{r Fig1-157, fig.width=5, fig.height=6, fig.retina=2, fig.cap="30 years observed maximum temperature at Taunggyi station, Southern Shan State, Myanmar"}

p1 <- taunggyi_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- taunggyi_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- taunggyi_tmax %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Taunggyi Station",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- taunggyi_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(taunggyi_tmax$Tmax), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(taunggyi_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(taunggyi_tmax$Tmax), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Taunggyi",
    caption = "Source: DMH, 2019"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "italic", size = 6, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Maximum Temperature

There are 61 missing values which are filled using last observation
carry forward method from the previous year. It is the same missing data
point location which are November and December of 1984. The code for
this missing data analysis are 1. `summary()` - which can quickly
summarize NA values if any, 2. `df %>% is.na() %>% colSums()` - which is
also very useful to see the total of NA in each columns and 3.
`df %>%  mutate(date = ymd(date), Year= year(Date), Month = month(Date)) %>% group_by(Year) %>% summarize(n=n()) %>% view()`-
which is a detail year view of all data and can quickly find in which
year those missing values are located, and 4. `which(is.na(df))`
method - which can easily locate index of missing data.

```{r Fig1-158, echo=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_17_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_17_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

taunggyi_tmax_45_1 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_45_2 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_45_3 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

# taunggyi_tmax_45_1;taunggyi_tmax_45_2;taunggyi_tmax_45_3
taunggyi_tmax_future <- bind_rows(
  taunggyi_tmax_45_1, 
  taunggyi_tmax_45_2, 
  taunggyi_tmax_45_3)
taunggyi_tmax_future <- taunggyi_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-159, fig.width=7, fig.height=9, fig.cap= "Daily Maximum Temperature (RCP 4.5) at Taunggyi Station, southern"}
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey85") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12), 
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.text = element_text(family = "Pyidaungsu", face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-19, include = TRUE}
taunggyi_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State<br><br>")
```

```{r include=FALSE}
taunggyi_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 35.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 35.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maxaimum Temperature at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-160, fig.cap = "Observed vs. Projected Monthly Maximum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "red") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed vs. Projected Monthly Maximum Temperature by Model

```{r Fig1-161, fig.width=7, fig.height=9, fig.cap="Monthly Maximum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "maroon", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Maximum Temperature

```{r Fig1-162, fig.cap="Observed and Projected Annual Maximum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmax_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)),
            aes(x = Year, y = Ob_mean), color = "grey45") +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "maroon", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed vs. Projected Annual Maximum Temperature by Model

```{r Fig1-163, fig.width=8, fig.height = 10, fig.cap="Observed and Projected Annual Maximum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmax_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)),
            aes(x = Year, y = Ob_mean), color = "grey45") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "maroon", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Mean, Max and Min of Maximum Temperature

```{r Fig1-164, fig.cap="Observed vs. Projected Annual Maximum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Ob_max = max(Tmax.x),
    Ob_min = min(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2000, 2100, by = 10)) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "c")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "lightyellow"),
    plot.background = element_rect(fill = "skyblue", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
  )
```

##### Observed and Projected Annual Mean, Max and Min of Maximum Temperature by model

```{r Fig1-165, fig.width = 7, fig.height = 9, fig.cap="Observed vs. Projected Annual Maximum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar"}
taunggyi_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Ob_max = max(Tmax.x),
    Ob_min = min(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2000, 2100, by = 10)) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "c")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 60),
    strip.background = element_rect(fill = "steelblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "darkblue")
  )
```

#### RCP8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig1-166, echo=FALSE, fig.cap="Daily Maximum temperature scenario among different GCMs (RCP 8.5) at Taunggyi station, Southern Shan State"}
files <- fs::dir_ls(glob = "*tmax_17_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# taunggyi_tmax <- vroom::vroom("data/Area-1/taunggyi/clean_taunggyi_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
taunggyi_tmax["Date"] <- ymd(taunggyi_tmax$Date)
taunggyi_tmax_85_1 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_85_2 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_85_3 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

# taunggyi_tmax_85_1
# taunggyi_tmax_85_2
# taunggyi_tmax_85_3
taunggyi_tmax_future_85 <- bind_rows(
  taunggyi_tmax_85_1, 
  taunggyi_tmax_85_2, 
  taunggyi_tmax_85_3)
taunggyi_tmax_future_85 <- taunggyi_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey45") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source:ECD-SNC, DMH" 
      ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 60),
    strip.background = element_rect(fill = "steelblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "darkblue")
  )
  
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-167, fig.width= 7, fig.height=9, fig.cap="Observed and Projected Daily Maximum temperature scenario among different GCMs at Taunggyi station (RCP 8.5)"}
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) + 
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 60),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-20, include = TRUE}
taunggyi_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits =2, caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State, Myanmar<br><br>")
```

```{r, include=FALSE}
taunggyi_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 35.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 35.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-168, fig.cap="Observed vs. Projected Monthly Maximum temperature scenario among different GCMs at Taunggyi station (RCP 8.5)"}
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 60),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature by Model

```{r Fig1-169, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Monthly Maximum temperature scenario among different GCMs at Taunggyi station (RCP 8.5)"}
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 60),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Observed vs. Projected Annual Maximum Temperature (Departure)

```{r Fig1-170, fig.cap = "Observed vs. Projected Maximum temperature among different GCMs at Taunggyi station, Southern Shan State, Myanmar (RCP 8.5)"}
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean ), color = "red") +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Observed vs. Projected Annual Maximum Temperature (Departure)

```{r Fig1-171, fig.width = 7, fig.height = 9, fig.cap = "Observed vs. Projected Maximum temperature among different GCMs at Taunggyi station, Southern Shan State, Myanmar (RCP 8.5)"}
taunggyi_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean ), color = "red") +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  facet_wrap(~Model, ncol = 5) +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Maximum Temperature

```{r Fig1-172, echo=FALSE, fig.cap = "Observed vs. Projected Annual Maximum Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar under different GCMs 2011-2100"}
taunggyi_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean ), color = "red") +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max ), color = "red", alpha = 0.5) +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min ), color = "red", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 85) +
  scale_color_viridis_d(option = "D") +
  
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "c")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Maximum Temperature

```{r Fig1-173, fig.width =7, fig.height = 9, echo=FALSE, fig.cap = "Observed vs. Projected Annual Maximum Temperature under RCP 8.5 at Taunggyi Station, Southern Shan State, Myanmar under different GCMs 2011-2100"}
taunggyi_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean ), color = "red") +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max ), color = "red", alpha = 0.5) +
  geom_line(data = taunggyi_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min ), color = "red", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 85) +
  scale_color_viridis_d(option = "D") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "c")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "snow", colour = "white"),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360),
    strip.background = element_rect(fill = "darkblue", color = "snow"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
  )
```

#### Density plots for Maximum Temperature at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-174, fig.width=10, fig.height=8, fig.cap = "Mean shift from the baseline (1981-2010) for projected Maximum Temperature at Taunggyi station, Southern Shan State, Myanmar"}
####  Density Plot for Taunggyi station

### RCP 4.5
p1 <- ggplot(taunggyi_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(taunggyi_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(taunggyi_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(taunggyi_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = taunggyi_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(taunggyi_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmax_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  # facet_wrap(~Model, ncol = 4) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    plot.caption = element_text(size = 7, color = "grey60"),
    axis.text  = element_text(size = 7),
    strip.text = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    taunggyi_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  #facet_wrap(~Model, ncol = 4) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        plot.caption = element_text(size = 7, color = "grey60"),
        axis.text  = element_text(size = 7),
        strip.text = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Tempearature

Like to Tmean observation, there are two months (i.e., November and
December) in 1984 and seven 31st day of 1992, which makes in total of 68
missing data points. The same method is applied and used `impute()`
function from `Hmisc` package.

#### Observed Data

```{r}
taunggyi_tmin <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmin$date <- as.character(taunggyi_tmin$date) ## set charactor for further analysis
taunggyi_tmin["year"] <- str_sub(taunggyi_tmin$date, 1, 4)
taunggyi_tmin["month"] <- str_sub(taunggyi_tmin$date, 5, 6)
taunggyi_tmin["day"] <- str_sub(taunggyi_tmin$date, 7, 8)
taunggyi_tmin["Date"] <- make_date(taunggyi_tmin$year, taunggyi_tmin$month, taunggyi_tmin$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmin <- taunggyi_tmin$Tmin[(which(taunggyi_tmin$date == "19831101")):(which(taunggyi_tmin$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmin)
names(miss_nd_1984) <- c("Date", "Tmin")

taunggyi_tmin <- taunggyi_tmin[, c(1, 6, 2)]
taunggyi_tmin <- taunggyi_tmin %>%
  
  bind_rows(miss_nd_1984) %>%
  mutate(
  Tmin = Hmisc::impute(Tmin, mean)
  )

taunggyi_tmin$date <- ymd(taunggyi_tmin$Date)
```

```{r Fig1-175, fig.width=5, fig.height=6, fig.retina=2, fig.cap = "30 years observed minimum temperature at Taunggyi station, Southern Shan State, Myanmar"}

p1 <- taunggyi_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- taunggyi_tmin %>%
  mutate(
    Year =  year(Date),
    Month =  month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimum Temperature",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
    legend.key.height = unit(0.4, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- taunggyi_tmin %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimum Temperature at Taunggyi Station",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
p4 <- taunggyi_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(taunggyi_tmin$Tmin), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(taunggyi_tmin$Tmin), 2),
           y = 0.01, label = paste(round(mean(taunggyi_tmin$Tmin), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Taunggyi",
    caption = "Source: DMH, 2019"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Minimum Temperature at Taunggyi Station, Southern Shan State, Myanmar

```{r Fig1-176, echo=FALSE, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_17_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
# files <- fs::dir_ls(glob = "*tmin_4_85*csv")
# tmin_models_combined_85 <- map_df(files,
#                                    ~read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE
#                                              )
#                                    )
# names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


taunggyi_tmin_45_1 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_45_2 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_45_3 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# taunggyi_tmin_45_1;taunggyi_tmin_45_2;taunggyi_tmin_45_3
taunggyi_tmin_future <- bind_rows(
  taunggyi_tmin_45_1, 
  taunggyi_tmin_45_2, 
  taunggyi_tmin_45_3)
taunggyi_tmin_future <- taunggyi_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
taunggyi_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey45") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 360)
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-177, fig.width=10, fig.height=8, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Taunggyi Station during 2011-2100"}
taunggyi_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey85") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
    strip.background = element_rect(fill="darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-21, include = TRUE}
taunggyi_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption ="Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State, Myanmar<br><br>")
```

```{r, include=FALSE}
taunggyi_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 Degree C** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature

```{r Fig1-178, fig.cap="Observed vs. Projected Monthly Minimum Temperature (RCP 4.5) at Taunggyi station, Southern Shan State, Myanmar during 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5, lty = "dashed", size = 0.3) +
  geom_line(aes(x = Month, y = Ob_mean), color = "red") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-179, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Monthly Minimum Temperature (RCP 4.5) at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "cornsilk", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed vs. Projected Annual Mean, Max and Min of Minimum Temperature

```{r Fig1-180, fig.cap="Observed vs. Projected Minimum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar, 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 1) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "D") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "cornsilk", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    plot.background = element_rect(fill = "cornsilk", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed vs. Projected Annual Mean, Max and Min of Minimum Temperature by model

```{r Fig1-181, fig.width = 7, fig.height = 9, fig.cap="Observed vs. Projected Minimum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar, 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 1) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_max), color = "darkred") +
  geom_line(aes(x = Year, y = Ob_min), color = "darkred") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  #scale_color_viridis_d(option = "D") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "cornsilk", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    plot.background = element_rect(fill = "cornsilk", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature

```{r Fig1-182, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar, 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 1) +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), color = "grey") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmin.x)),
            aes(x = Year, y = Ob_min), color = "grey") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "D") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature by Model

```{r Fig1-183, fig.width = 7, fig.height = 9, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar, 2011-2100"}
taunggyi_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 1) +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), color = "grey") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmin.x)),
            aes(x = Year, y = Ob_min), color = "grey") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_viridis_d(option = "D") +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig1-184, fig.cap="Daily Minimum temperature scenario variation among different GCMs  at Taunggyi station, Southern Shan State (RCP 8.5) "}
files <- fs::dir_ls(glob = "*tmin_17_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")
taunggyi_tmin_85_1 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_85_2 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_85_3 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )

# taunggyi_tmin_85_1
# taunggyi_tmin_85_2
# taunggyi_tmin_85_3
taunggyi_tmin_future_85 <- bind_rows(
  taunggyi_tmin_85_1, 
  taunggyi_tmin_85_2, 
  taunggyi_tmin_85_3)
taunggyi_tmin_future_85 <- taunggyi_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
taunggyi_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-185, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily Minimum temperature scenario variation among different GCMs  at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-22, include = TRUE}
taunggyi_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption="Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State <br><br>")
```

```{r, include=FALSE}
taunggyi_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 Degree C** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, Projected_Min),
      rows = PMax > 22.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, Observed_Min),
      rows = OMax >= 22.0)
    ) %>% 
  fmt_number(
    columns = c( OMean, OMax, Observed_Min, MMax, MMean, MMin, PMax, PMean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    OMax = md("**Observed Max**"),
    OMean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    MMax = md("**Model Max**"),
    MMean = md("**Model Mean**"),
    MMin = md("**Model Min**"),
    PMax = md("**Projected Max**"),
    PMean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature at Taunggyi station, Southern Shan State

```{r Fig1-186, fig.cap="Observed vs. Projected Monthly Minimum temperature among different GCMs at Taunggyi station, Southern Shan State, Myanmar (RCP 8.5)"}
taunggyi_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-187, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Monthly Minimum temperature scenario among different GCMs  at Taunggyi station (RCP 8.5) "}
taunggyi_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature

```{r Fig1-188, fig.cap = "Observed and Projected Minimum Temperature under RCP 8.5 at Taunggyi Station under different GCMs 2011-2100", echo=FALSE}
taunggyi_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey85") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), color = "grey85") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmin.x)),
            aes(x = Year, y = Ob_min), color = "grey85") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
      legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature by model

```{r Fig1-189, fig.width = 7, fig.height = 9, fig.cap = "Observed and Projected Minimum Temperature under RCP 8.5 at Taunggyi Station under different GCMs 2011-2100", echo=FALSE}
taunggyi_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), color = "grey60") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Ob_min = min(Tmin.x)),
            aes(x = Year, y = Ob_min), color = "grey60") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
      legend.position = "none",
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 7),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightsteelblue", colour = "black"),
    strip.background = element_rect(fill = "steelblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    panel.background = element_rect(fill = "white")
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-190, fig.width=10, fig.height=8, fig.cap = "Mean shift from baseline (1981-2010) of projected minimum temperature under two different scenario at Taunggyi station, Southern Shan State, Myanmar"}
####  Density Plot for Taunggyi station

### RCP 4.5
p1 <- ggplot(taunggyi_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmin$Tmin) -0.2, 2)), 
           y = 0.10, 
           label = paste(round(mean(taunggyi_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmin$Tmin) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(taunggyi_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmin$Tmin) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(taunggyi_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"),
    caption = "Source:ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmin_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(taunggyi_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    taunggyi_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmin_85_2, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Precipitation

It has been observed that there are `r 10957 - 10896`days in 1984
reportedly missing. It is usually filled by using Last Observation Carry
Forword Method and assume that the same date in the last year
precipitation is continued to happen in the missing period in 1984.

```{r}
taunggyi_preci <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_rainfall.csv",
  delim = " ", col_names = c("date", "preci"), na = "-999.0", show_col_types = FALSE
)
taunggyi_preci$date <- as.character(taunggyi_preci$date) ## set charactor for further analysis
taunggyi_preci["year"] <- str_sub(taunggyi_preci$date, 1, 4)
taunggyi_preci["month"] <- str_sub(taunggyi_preci$date, 5, 6)
taunggyi_preci["day"] <- str_sub(taunggyi_preci$date, 7, 8)
taunggyi_preci["Date"] <- make_date(taunggyi_preci$year, taunggyi_preci$month, taunggyi_preci$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_preci <- taunggyi_preci$preci[(which(taunggyi_preci$date == "19831101")):(which(taunggyi_preci$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_preci)
names(miss_nd_1984) <- c("Date", "preci")

taunggyi_preci <- taunggyi_preci[, c(1, 6, 2)]
taunggyi_preci <- taunggyi_preci %>%
  
  bind_rows(miss_nd_1984) %>%
  mutate(
  preci = Hmisc::impute(preci, mean)
  )

taunggyi_preci$date <- ymd(taunggyi_preci$Date)
```

```{r Fig1-191, fig.width=6, fig.height=8, fig.retina=2, fig.cap = "30 years observed precipitation data at Taunggyi station, Southern Shan State, Myanmar"}
p1 <- taunggyi_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/30,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed monthly total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p2 <- taunggyi_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p3 <-  taunggyi_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipatation at Taunggyi Stataion  (1981-2010)",
      caption = "Source: DMH, 2019")+
    ggthemes::theme_tufte() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  
p4 <-  taunggyi_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(taunggyi_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(taunggyi_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(taunggyi_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipatation at Taunggyi Stataion (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(
     plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 10),
     plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_17_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_17_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

taunggyi_preci_45_1 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_45_2 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_45_3 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
taunggyi_preci_future <- bind_rows(
  taunggyi_preci_45_1, 
  taunggyi_preci_45_2, 
  taunggyi_preci_45_3)
taunggyi_preci_future <- taunggyi_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-192, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Taunggyi Station, Southern Shan State during 2011-2100" }
taunggyi_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-193, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Taunggyi Station, Southern Shan State during 2011-2100"}
taunggyi_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-23, include = TRUE}
taunggyi_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State<br><br>")
```

```{r include=FALSE}
taunggyi_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 141.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 141.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )

taunggyi_yearly_summary <- taunggyi_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(taunggyi_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(taunggyi_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(taunggyi_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Taunggyi is ", mean(taunggyi_yearly_summary$Total), " mm."))

```

##### Observed vs. Projected Monthly Precipitation

```{r Fig1-194, fig.cap = "Observed vs. Projected Monthly Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100", echo=FALSE}
taunggyi_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Precipitation by Model

```{r Fig1-195, fig.width=7, fig.height=9, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100"}
taunggyi_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Monthly Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation

```{r Fig1-196, fig.cap = "Observed vs. Projected Annual Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100", echo=FALSE}
taunggyi_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue", size = 1) +
  scale_color_hue(l = 45) +

  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size =10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation by Model

```{r Fig1-197, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100"}
taunggyi_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation

```{r Fig1-198, fig.cap = "Observed and Projected Annual Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100", echo=FALSE}
taunggyi_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = taunggyi_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "deepskyblue", size = 0.5) +
  scale_color_hue(l = 45) +

  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation by Model

Among all GCMs/RCMs, GISS-E2-R-CC only show downward trend of future
precipitation.

```{r Fig1-199, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Taunggyi Station, Southern Shan State, Myanmar 2011-2100"}
taunggyi_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = taunggyi_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r echo=FALSE}
files <- fs::dir_ls(glob = "*precip_17_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# taunggyi_preci <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# taunggyi_preci["Date"] <- ymd(taunggyi_preci$Date)
taunggyi_preci_85_1 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
taunggyi_preci_85_2 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
taunggyi_preci_85_3 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# taunggyi_preci_85_1
# taunggyi_preci_85_2
# taunggyi_preci_85_3
taunggyi_preci_future_85 <- bind_rows(
  taunggyi_preci_85_1, 
  taunggyi_preci_85_2, 
  taunggyi_preci_85_3
)
taunggyi_preci_future_85 <- taunggyi_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

```{r Fig1-200, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-201, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-24, include = TRUE}
taunggyi_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State <br><br>")
```

```{r include=FALSE}
taunggyi_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Taunggyi Station**, Southern Shan State"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(MMax, MMean, MMin),
      rows = MMax >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(PMax, PMean, PTotal),
      rows = PMax > 141.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(OMax, OMean, OTotal),
      rows = OMax >= 141.0)
    ) %>% 
  fmt_number(
    columns = c( OMax, OMean, OTotal, MMax, MMean, MMin, PMax, PMean, PTotal), 
    decimals = 2
  ) %>% 
  cols_label(
    OMax = md("**Observed Daily Max (mm)**"),
    OMean = md("**Observed Monthly Mean (mm)**"),
    OTotal = md("**Observed Annual Total (mm)**"), 
    MMax = md("**Model Max % change**"),
    MMean = md("**Model Mean % change**"),
    MMin = md("**Model Min % change**"),
    PMax = md("**Projected Daily Max (mm)**"),
    PMean = md("**Projected Monthly Mean (mm)**"),
    PTotal = md("**Projected Annual Total (mm)**")
  )

taunggyi_yearly_summary <- taunggyi_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(taunggyi_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(taunggyi_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(taunggyi_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Taunggyi is ", mean(taunggyi_yearly_summary$Total), " mm."))

```

##### Observed vs. Projected Monthly Precipitation

```{r Fig1-202, fig.cap="Observed vs. Projected Monthly Precipitation under RCP 8.5 at Taunggyi Station, Southern Shan State 2011-2100"}
taunggyi_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Monthly Precipitation by Model

```{r Fig1-203, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed vs. Projected Monthly Precipitation scenario among different GCMs at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Total = sum(future, na.rm = TRUE)/90,
            Ob_total = sum(preci.x, na.rm = TRUE)/90) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
   # axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation at Taunggyi Station

```{r Fig1-204, fig.cap="Observed vs. Projected Annual Precipitation under RCP 8.5 at Taunggyi Station, Southern Shan State 2011-2100"}
taunggyi_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation by Model at Taunggyi Station

```{r Fig1-205, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed vs. Projected Annual Precipitation scenario among different GCMs at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Total = sum(future, na.rm = TRUE),
            Ob_total = sum(preci.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter() +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation at Taunggyi Station, Southern Shan State

```{r Fig1-206, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Taunggyi Station, Southern Shan State 2011-2100"}
taunggyi_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = taunggyi_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Precipitation by Model at Taunggyi Station

```{r Fig1-207, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation scenario among different GCMs at Taunggyi station, Southern Shan State (RCP 8.5)"}
taunggyi_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_smooth(method = "lm", lty = 2, color = "darkred") +
  geom_line(data = taunggyi_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkblue") +
  
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```
