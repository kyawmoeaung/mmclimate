---
title: Climate Scenario Development through Ensemble Approach
subtitle: Coastal Region
author:
  - "Kyaw Moe Aung, Environmental Conservation Department - MONREC"
  - "Tin Mar Htay, Department of Meteorology and Hydrology"
  - "Hla Tun, Department of Meteorology and Hydrology"
  - "May Khin Chaw, Department of Meteorology and Hydrology"
  - "Shwe Mar Than, Yezin Agriculture University"
  - "Aung Than Oo, Irrigation and Water Utilization Resource Management"
  - "Kyaw Zeya Htun, Yangon Technology University"
  - "Kyaw San Naing, Environmental Conservation Department"
  - "Thanda Wint Wint Khaing, Environmental Conservation Department"
  - "Thi Thi Soe Min, Environmental Conservation Department"
  - "San Win, Environmental Conservation Department"
  - "Khin Cho Cho Shein, Department of Meteorology and Hydrology"
date: "1/6/2022"
output:
  bookdown::word_document2: 
    toc: true
    toc_depth: 4
    number_sections: true
    fig_caption: true
  pdf_document: default
  html_document:
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

```{=openxml}
<w:p><w:r><w:br w:type="page"/></w:r></w:p>
```

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE, message = FALSE, error = FALSE,
  fig.width = 6, fig.height = 5, fig.retina = 2
)
library(tidyverse)
library(readr)
library(purrr)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(patchwork)
library(lubridate)
library(vroom)
require(knitr)
require(ggthemes)
require(MetBrewer)
require(gt)
if (!require(kableExtra)) install.packages("kableExtra")
if (!require(fs)) install.packages("fs")

abb.month <- c("J ", "F", "M", "A", "M ", "J", " J", "A ", "S", "O", "N", "D")
```

# Climate Scenario Development through Ensemble Approach

## Coastal Regions

### Mean Temperature
### Ensemble Data

```{r}
setwd("~/ClimateScenarioDevelopment_MM/data/all_tmean_ensemble/")

files <- list.files(getwd(),
                   pattern = "^t\\w{3,4}\\w\\w{6}\\w\\d{2}\\w\\d{4}\\.csv$")

#files

df <- map_df(files, ~read_csv(.x, col_names = c("Name", "States", "CFB")))

df <- df  %>% mutate(
    Year = str_sub(Name, 10, 13),
    Month = str_sub(Name, 15, 16),
    RCP = str_sub(Name, 7, 8)
) %>% mutate(
monthly = paste0(Year, "-", Month)
)

df1 <- df  %>% mutate(
    dt = ymd(paste0((monthly), "-01"))
)

all_dates <- df1  %>% select(dt) %>% 
    complete(dt = seq.Date(min(dt), max(dt) + 30, by = "days")) %>% 
  mutate(
    monthly = paste(year(dt), str_pad(month(dt), 2, pad = "0"), sep = "-"))
# all_dates
    

all_tmean_ens <- all_dates  %>% 
    left_join(df1, by = "monthly")
all_tmean_ens <- all_tmean_ens  %>% select(dt.x, States, CFB, RCP)
names(all_tmean_ens) <- c("Date", "States", "Tmean", "RCP")
```

### Summary plot for each regions and states

```{r fig.width = 10, fig.height=8, fig.retina=5}
#set.seed(581)
all_tmean_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP) %>% 
ggplot(aes(x = Date, y = Tmean, color = factor(Month))) +
geom_line(size = 0.2) +
scale_color_hue(l = 45) +
facet_grid(States~Month, scales = "free_y") +
  scale_color_manual(labels = c("Ayeyarwaddy", "Eastern Bago", "Northern Bago", "Chin", "Kachin", "Kayah", "Kayin",
             "Magwe", "Mandalay", "Mon", "Naypyitaw", "Rakhine", "Lower Sagaing", "Upper Sagaing",
           "Eastern Shan", "Southern Shan", "Northern Shan", "Tanintharyi", "Yangon"), values = colors()[seq(57, 657, 5)]) +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD - SNC, DMH"
  
) +
theme_minimal()+
theme(
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 7),
axis.text = element_text(face = "italic", size = 7),
axis.text.x = element_text(angle = 45),
legend.title = element_blank(),
)
```


```{r fig.width = 10, fig.height=8}

dryzone <- all_tmean_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(8,9,13,14))
dryzone$States <- factor(dryzone$States, levels = c(8, 9, 13, 14),
                               labels = c("Magwe", "Mandalay", "Sagaing (L)", "Sagaing (U)"))
dryzone$RCP <- factor(dryzone$RCP, levels = c(45, 85),
                      labels = c("RCP 4.5", "RCP 8.5"))
  
dryzone_p <- ggplot(dryzone, aes(x = Date, y = Tmean, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") + #, labeller = labeller(RCP = RCP_labs, States = States_labs)) +
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Mean Temperature Change in Dry Zone Region",
    caption = "Source: ECD - SNC, DMH"
  
)+
theme_minimal()+
theme(
legend.position = "none",
legend.direction = "horizontal",
legend.text = element_blank(),
axis.text = element_text(face = "italic", size = 7),
axis.text.x = element_text(angle = 45),
legend.title = element_blank(),
)

coastal <- all_tmean_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(1, 10, 12, 18, 19))
coastal$States <- factor(coastal$States, levels = c(1, 10, 12, 18, 19),
                         labels = c("Ayeyarwaddy", "Mon", "Rakhine", "Tanintharyi", "Yangon"))
coastal$RCP <- factor(coastal$RCP, levels = c(45, 85),
                      labels = c("RCP 4.5", "RCP 8.5"))
coastal_p <- ggplot(coastal, aes(x = Date, y = Tmean, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                       
                       #c("blue", "maroon", "red", "yellow", "pink", "black", "cyan", "steelblue", "darkred", "darkolivegreen", "green", "wheat")) +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Mean Temperature Change in Coastal Region",
    caption = "Source: ECD - SNC, DMH"
  
)+
theme_minimal()+
theme(
legend.position = "none",
legend.direction = "horizontal",
legend.text = element_blank(),
axis.text = element_text(face = "italic", size = 7, ),
axis.text.x = element_text(angle = 45),
legend.title = element_blank(),
)

others <- all_tmean_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(2, 3, 4, 5, 6, 7, 11, 15, 16, 17 ))
others$States <- factor(others$States, levels= c(2,3,4,5,6,7,11,15,16,17),
                        labels = c("Bago (E)", "Bago (W)", "Chin", "Kachin", "Kayah", "Kayin", "Nay Pyi Taw", "Shan (E)", "Shan (N)", "Shan (S)"))
others$RCP <- factor(others$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))

others_p <- ggplot(others, aes(x = Date, y = Tmean, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                       
                       #c("blue", "maroon", "red", "yellow", "pink", "black", "cyan", "steelblue", "darkred", "darkolivegreen", "green", "wheat")) +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Mean Temperature Change in Mountainous Regions ",
    caption = "Source: ECD - SNC, DMH"
  
)+
theme_minimal()+
theme(
legend.position = "bottom",
legend.direction = "horizontal",
legend.text = element_text(face = "bold", size = 7),
axis.text = element_text(face = "italic", size = 7),
axis.text.x = element_text(angle = 45),
legend.title = element_blank(),

)
dryzone_p
coastal_p
others_p

dryzone_p / coastal_p / others_p
```

### Observed Data - Pathein Station

30 years of daily observed data at the Pathein station was used to project daily mean temperature following pattern scaling method as described in SimCLIM commercial software. These data were integrated with the change factors of mean temperature of Ayeyarwaddy regional average as shown in the above figure of coastal region. Baseline data cover 1981-2010 timeframe, future projection contains 3 timeframes of 2011-2040, 2041-2070 and 2071-2100 only with widely used RCPs at scientific studies around the world, such as RCP 4.5 and RCP 8.5.

```{r}
pathein_tmean <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Pathein/clean_Pathein_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"),
  na = "-999.0", show_col_types = FALSE
)
pathein_tmean["Date"] <- ymd(pathein_tmean$Date)
pathein_tmean$date <- pathein_tmean$Date

pathein_tmean_ens <- all_tmean_ens %>% filter(States == 1 & RCP ==45)

pathein_tmean_45_1 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_45_2 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_45_3 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_45_1
# pathein_tmean_45_2
# pathein_tmean_45_3
pathein_tmean_future <- rbind.data.frame(
  pathein_tmean_45_1,
  pathein_tmean_45_2,
  pathein_tmean_45_3
)

# all_tmean_ens <- all_tmean_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
# names(all_tmean_ens) <- c("Date", "Year", "Month", "States", "Tmean", "RCP")

pathein_tmean_ens_85 <- all_tmean_ens %>% filter(States == 1 & RCP ==85)

pathein_tmean_85_1 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_85_2 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_85_3 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_45_1
# pathein_tmean_45_2
# pathein_tmean_45_3
pathein_tmean_future_85 <- rbind.data.frame(
  pathein_tmean_85_1,
  pathein_tmean_85_2,
  pathein_tmean_85_3
)
```

#### Daily

As we have expected, RCP 8.5 projection on the baseline observed data show higher mean temperature increases than RCP 4.5 scenario. The comparison has been depicted under the following sessions such Daily, Monthly and Annually.

```{r}
p1 <- pathein_tmean_future  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line()+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
title = "Mean Temperature, Pathein, RCP 4.5",
caption = "Source: ECD-SNC, DMH")+
geom_line(aes(x = date, y = Tmean.x), color = "maroon")+
  #scale_x_discrete(limits = seq(1980, 2100, 10))+
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", hjust = 0.5, size  = 10),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
  axis.title = element_text(face = "bold", size = 7),
  axis.text = element_text(face = "bold", size = 7),
  axis.text.x = element_text(face = "bold", size = 7, angle = 45)
)

p2 <- pathein_tmean_future_85  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line()+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
title = "Mean Temperature, Pathein, RCP 8.5 ",
caption = "Source: ECD-SNC, DMH") +
geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
 # scale_x_discrete(limits = seq(2010, 2100, 10)) +
 # scale_x_discrete(limits = seq(1980, 2100, 10))+
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", hjust = 0.5, size  = 10),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
  axis.title = element_text(face = "bold", size = 7),
  axis.text = element_text(face = "bold", size = 7),
  axis.text.x = element_text(face = "bold", size = 7, angle = 45)
)

p1 / p2
```

#### Monthly

```{r}
p3 <- pathein_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
title = "Mean Temperature, Pathein, RCP 4.5 ",
caption = "Source: ECD-SNC, DMH")+
# geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", hjust = 0.5, size  = 10),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
  axis.title = element_text(face = "bold", size = 7),
  axis.text = element_text(face = "bold", size = 7),
  axis.text.x = element_text(face = "bold", size = 7, angle = 45)
)

p4 <- pathein_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
title = "Mean Temperature, Pathein, RCP 8.5 ",
caption = "Source: ECD-SNC, DMH")+
#geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", hjust = 0.5, size  = 10),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
  axis.title = element_text(face = "bold", size = 7),
  axis.text = element_text(face = "bold", size = 7),
  axis.text.x = element_text(face = "bold", size = 7, angle = 45)
)

p3/p4

```

#### Summary Table by Month

```{r}
pathein_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y),
         Mmax = max(Tmean.y),
         Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Pathein Station, Ayeyarwaddy Region, Myanmar by 2100<br><br>" )

pathein_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y),
         Mmax = max(Tmean.y),
         Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Pathein Station, Ayeyarwaddy Region, Myanmar by 2100<br><br>" )
```

#### Annual - Departure

```{r}
p5 <- pathein_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Pathein, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 11, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p6 <- pathein_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Pathein, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 11, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p5 / p6

```

#### Summary Table by Year

```{r}
pathein_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y),
         Mmax = max(Tmean.y),
         Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 4.5) at Pathein Station, Ayeyarwaddy Region, Myanmar<br><br>" )
          
pathein_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y),
         Mmax = max(Tmean.y),
         Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 8.5) at Pathein Station, Ayeyarwaddy Region, Myanmar<br><br>" )
          
```

#### Annual - Time Series

```{r}
p7 <- pathein_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Pathein, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
# scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)


p8 <- pathein_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +

labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Pathein, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
# scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)


p7 / p8
```

#### Climate Change Scenario (Mean shift from baseline) of mean temperature at Pathein station, Ayeyarwaddy Region, Myanmar

```{r fig.width=10, fig.height=8}
p1 <- ggplot(pathein_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(pathein_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Pathein station, \nAyeyarwaddy Region, Myanmar, Comparisons of 30 years cycles under RCP 4.5
  \n(Ensemble Approach)"
) +
  
  geom_density(
    data = pathein_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(pathein_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    pathein_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift to Right from Baseline (1981-2010) at Pathein station, \nAyeyarwaddy Region, Myanmar, Comparisons of 30 years cycles under RCP 8.5 \n (Ensemble Approach)"
  ) +
  
  geom_density(
    data = pathein_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Dawei Station

```{r}

dawei_tmean <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Dawei/clean_dawei_meanTem_edited.csv",
  delim = ",", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
dawei_tmean["Date"] <- ymd(dawei_tmean$Date)
dawei_tmean$date <- dawei_tmean$Date

#all_tmean_ens <- all_tmean_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
#names(all_tmean_ens) <- c("Date", "Year", "Month", "States", "Tmean", "RCP")

dawei_tmean_ens <- all_tmean_ens %>% filter(States == 18 & RCP ==45)

dawei_tmean_45_1 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_45_2 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_45_3 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_45_1
# pathein_tmean_45_2
# pathein_tmean_45_3
dawei_tmean_future <- rbind.data.frame(
  dawei_tmean_45_1,
  dawei_tmean_45_2,
  dawei_tmean_45_3
)

### RCP 8.5
dawei_tmean_ens <- all_tmean_ens %>% filter(States == 18 & RCP == 85)

dawei_tmean_85_1 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_85_2 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_85_3 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_45_1
# pathein_tmean_45_2
# pathein_tmean_45_3
dawei_tmean_future_85 <- rbind.data.frame(
  dawei_tmean_85_1,
  dawei_tmean_85_2,
  dawei_tmean_85_3
)


```


#### Daily

```{r}
p1 <- dawei_tmean_future  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line()+
geom_line(aes(x = date, y = Tmean.x), color = "maroon")+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )

p2 <- dawei_tmean_future_85  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line()+
geom_line(aes(x = date, y = Tmean.x), color = "maroon")+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )

p1 / p2

```

#### Monthly

```{r}
p3 <- dawei_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )

p4 <- dawei_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )
p3/p4
```

#### Summary Table by Month

```{r}
dawei_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
         #Pmax = max(future),
          #Pmin = min(future),
         Obmean = mean(Tmean.x),
          #Obmax = max(Tmean.x),
          #Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         #Mmax = max(Tmean.y),
         #Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar by 2100<br><br>" )
### RCP 8.5
dawei_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Dawei Station, Tanintharyi Region, Myanmar by 2100<br><br>" )
```        

#### Annual - Departure

```{r}
p5 <- dawei_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
)

p6 <- dawei_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
)

p5 / p6
```

#### Summary Table by Year

```{r}
dawei_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 4.5) at Dawei Station, Tanintharyi Region, Myanmar <br><br>" )
          
dawei_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y))%>%
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 8.5) at Dawei Station, Tanintharyi Region, Myanmar<br><br>" )
```          

#### Annual - Time Series

```{r}
p7 <- dawei_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
 # filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = dawei_tmean_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p8 <- dawei_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = dawei_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Dawei, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p7 /p8
```

#### Climate Scenario  (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(dawei_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(dawei_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)") +
  
  geom_density(
    data = dawei_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(dawei_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =dawei_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    dawei_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = dawei_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(dawei_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmean_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(dawei_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(dawei_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =dawei_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Sittwe station

```{r}
sittwe_tmean <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Sittwe/clean_Sittwe_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmean$date <- as.character(sittwe_tmean$date) ## set charactor for further analysis
sittwe_tmean["year"] <- str_sub(sittwe_tmean$date, 1, 4)
sittwe_tmean["month"] <- str_sub(sittwe_tmean$date, 5, 6)
sittwe_tmean["day"] <- str_sub(sittwe_tmean$date, 7, 8)
sittwe_tmean["Date"] <- make_date(sittwe_tmean$year, sittwe_tmean$month, sittwe_tmean$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19810101"):(which(sittwe_tmean$date == "19810101") + 58)]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmean)
names(miss_jf_1982) <- c("Date", "Tmean")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19850101"):(which(sittwe_tmean$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmean)
names(miss_whole_1986) <- c("Date", "Tmean")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19871201"):(which(sittwe_tmean$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmean)
names(miss_dec_1988) <- c("Date", "Tmean")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19900201"):(which(sittwe_tmean$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmean)
names(miss_feb_1991) <- c("Date", "Tmean")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "20040301"):which(sittwe_tmean$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmean)
names(miss_mar_2005) <- c("Date", "Tmean")

sittwe_tmean <- sittwe_tmean[, c(6, 2)]
sittwe_tmean <- rbind.data.frame(sittwe_tmean, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_tmean["date"] <- ymd(sittwe_tmean$Date)
```

```{r}
# all_tmean_ens <- all_tmean_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
# names(all_tmean_ens) <- c("Date", "Year", "Month", "States", "Tmean", "RCP")

sittwe_tmean_ens <- all_tmean_ens %>% filter(States == 12 & RCP ==45)

sittwe_tmean_45_1 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_45_2 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_45_3 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

sittwe_tmean_future <- rbind.data.frame(
  sittwe_tmean_45_1,
  sittwe_tmean_45_2,
  sittwe_tmean_45_3
)

# all_tmean_ens <- all_tmean_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
# names(all_tmean_ens) <- c("Date", "Year", "Month", "States", "Tmean", "RCP")

sittwe_tmean_ens <- all_tmean_ens %>% filter(States == 12 & RCP ==85)

sittwe_tmean_85_1 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_85_2 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_85_3 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

sittwe_tmean_future_85 <- rbind.data.frame(
  sittwe_tmean_85_1,
  sittwe_tmean_85_2,
  sittwe_tmean_85_3
)
```

#### Daily

```{r}
p1 <- sittwe_tmean_future  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line(lty = "dashed")+
geom_line(aes(x = date, y = Tmean.x), color = "maroon")+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 11, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )

p2 <- sittwe_tmean_future_85  %>% 
ggplot(aes(x = Date, y = future)) +
geom_line(lty = "dashed")+
geom_line(aes(x = date, y = Tmean.x), color = "maroon")+
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
theme_minimal() +
  theme(
  plot.title = element_text(face = "bold", size = 11, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
  )

p1 / p2
```


#### Monthly

```{r}
p3 <- sittwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2) +
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)
p4 <- sittwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Month, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Month, y = Obmean), color = "maroon") +
labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth() +
scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)
p3/p4
```

#### Summary Table by Month

```{r}
sittwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar by 2100<br><br>" )
          

sittwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y),
         Mmax = max(Tmean.y),
         Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Sittwe Station, Rakhine State, Myanmar by 2100<br><br>" )
```


#### Annual - Departure

```{r}
p5 <- sittwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p6 <- sittwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
         Obmean = mean(Tmean.x)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(aes(x = Year, y = Obmean), color = "maroon") +
# geom_smooth() +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
#scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p5 / p6
```

#### Summary Table by Year

```{r}
sittwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 4.5) at Sittwe Station, Rakhine State, Myanmar<br><br>" )
          
sittwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          # Pmax = max(future),
          # Pmin = min(future),
         Obmean = mean(Tmean.x),
          # Obmax = max(Tmean.x),
          # Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y)) %>% 
         # Mmax = max(Tmean.y),
         # Mmin = min(Tmean.y)) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP - 8.5) at Sittwe Station, Rakhine State, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
p7 <- sittwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = sittwe_tmean_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
# scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p8 <- sittwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future)) %>% 
ggplot(aes(x = Year, y = Mean)) +
geom_line(lty = 2)+
geom_line(data = sittwe_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(
         Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Sittwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
) +
# geom_smooth(method = "lm") +
# scale_x_discrete(limits = month.abb) +
theme_minimal() +
theme(
  plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
  plot.caption = element_text(face = "bold", size = 7, color = "grey60" ),
  axis.title = element_text(face = "italic", size = 7),
  axis.text = element_text(face = "italic", size = 7)
)

p7 / p8
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8, fig.cap="Mean shift from Baseline of mean temperature at Sittwe station, Rakhine State, Myanmar"}
p1 <- ggplot(sittwe_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(sittwe_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(sittwe_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift Right from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = sittwe_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(sittwe_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    sittwe_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Mean Temparature shift Right from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = sittwe_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(sittwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmean_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_2$future),
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(sittwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```


### Maximum Temperature
### Ensemble Data

```{r}
setwd("~/ClimateScenarioDevelopment_MM/data/all_tmax_ensemble/")

files <- list.files(getwd(),
                   pattern = "^t\\w{3,4}\\w\\w{6}\\w\\d{2}\\w\\d{4}\\.csv$")

#files

df <- map_df(files, ~read_csv(.x, col_names = c("Name", "States", "CFB")))

df <- df  %>% mutate(
    Year = str_sub(Name, 9, 12),
    Month = str_sub(Name, 14, 15),
    RCP = str_sub(Name, 6, 7)
) %>% mutate(
monthly = paste0(Year, "-", Month)
)

df1 <- df  %>% mutate(
    dt = ymd(paste0((monthly), "-01"))
)

all_dates <- df1  %>% select(dt) %>% 
    complete(dt = seq.Date(min(dt), max(dt) + 30, by = "days")) %>% 
    mutate(
    monthly = paste(year(dt), str_pad(month(dt), 2, pad = "0"), sep = "-"))
# all_dates
    

all_tmax_ens <- all_dates  %>% 
    left_join(df1, by = "monthly")
#all_tmax_ens

all_tmax_ens <- all_tmax_ens  %>% select(dt.x, States, CFB, RCP)
names(all_tmax_ens) <- c("Date", "States", "Tmax", "RCP")

```

### Summary plot for Maximumu Temperature

```{r fig.width=10, fig.height=8}

dryzone <- all_tmax_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(8, 9, 13, 14))
dryzone$States <- factor(dryzone$States, levels = c(8, 9, 13, 14), labels = c("Magwe", "Mandalay", "Sagaing (L)", "Sagaing (U)"))
dryzone$RCP <- factor(dryzone$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
dryzone_tmax <-ggplot(dryzone, aes(x = Date, y = Tmax, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Maximum Temperature Change in Dry Zone",
    caption = "Source: ECD - SNC, DMH"
    
)+
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                       # colors()[seq(57,657,5)]) +
                       
             #           c("Ayeyarwaddy", "Eastern Bago", "Northern Bago", "Chin", "Kachin", "Kayah", "Kayin",
             #  "Magwe", "Mandalay", "Mon", "Naypyitaw", "Rakhine", "Lower Sagaing", "Upper Sagaing",
             # "Eastern Shan", "Southern Shan", "Northern Shan", "Tanintharyi", "Yangon"), values = colors()[seq(57,657,5)]) +
theme_minimal()+
theme(
legend.position = "none",
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 10),
axis.text = element_text(face = "bold", size = 7)
)

coastal <- all_tmax_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(1, 10, 12, 18, 19))
coastal$States <- factor(coastal$States, levels = c(1, 10, 12, 18, 19), labels = c("Ayeyarwaddy", "Mon", "Rakhine", "Tanintharyi", "Yangon"))
coastal$RCP <- factor(coastal$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
coastal_tmax <-ggplot(coastal, aes(x = Date, y = Tmax, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Maximum Temperature Change in Coastal Zone",
    caption = "Source: ECD - SNC, DMH"
    
)+
  scale_color_manual(labels = month.abb, values =c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) + 
                       # colors()[seq(57,657,5)]) +
                       
             #           c("Ayeyarwaddy", "Eastern Bago", "Northern Bago", "Chin", "Kachin", "Kayah", "Kayin",
             #  "Magwe", "Mandalay", "Mon", "Naypyitaw", "Rakhine", "Lower Sagaing", "Upper Sagaing",
             # "Eastern Shan", "Southern Shan", "Northern Shan", "Tanintharyi", "Yangon"), values = colors()[seq(57,657,5)]) +
theme_minimal()+
theme(
legend.position = "none",
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 10),
axis.text = element_text(face = "bold", size = 7)
)

others <- all_tmax_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(2, 3, 4, 5, 6, 7, 11, 15, 16, 17 ))
others$States <- factor(others$States, levels = c(2, 3, 4, 5, 6, 7, 11, 15, 16, 17 ), labels = c("Bago (E)", "Bago (W)", "Chin", "Kachin", "Kayah", "Kayin", "Nay Pyi Taw", "Shan (E)", "Shan (N)", "Shan (S)"))
others$RCP <- factor(others$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
others_tmax <-ggplot(others, aes(x = Date, y = Tmax, color = factor(Month))) +
geom_line()+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Maximum Temperature Change in Mountainous Zone",
    caption = "Source: ECD - SNC, DMH"
    
)+
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                       # colors()[seq(57,657,5)]) +
                       
             #           c("Ayeyarwaddy", "Eastern Bago", "Northern Bago", "Chin", "Kachin", "Kayah", "Kayin",
             #  "Magwe", "Mandalay", "Mon", "Naypyitaw", "Rakhine", "Lower Sagaing", "Upper Sagaing",
             # "Eastern Shan", "Southern Shan", "Northern Shan", "Tanintharyi", "Yangon"), values = colors()[seq(57,657,5)]) +
theme_minimal()+
theme(
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 10),
axis.text = element_text(face = "bold", size = 7)
)
coastal_tmax
dryzone_tmax
others_tmax
coastal_tmax / dryzone_tmax / others_tmax
```

### Observed Data - Pathein Station

```{r}
pathein_tmax <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Pathein/clean_Pathein_maxTem.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
pathein_tmax["Date"] <- ymd(pathein_tmax$Date)
pathein_tmax$date <- pathein_tmax$Date


### RCP 4.5
pathein_tmax_ens = all_tmax_ens  %>% filter(States == 1 & RCP == 45)
pathein_tmax_45_1 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_45_2 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_45_3 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# pathein_tmax_45_1;pathein_tmax_45_2;pathein_tmax_45_3
pathein_tmax_future <- rbind.data.frame(
  pathein_tmax_45_1, 
  pathein_tmax_45_2, 
  pathein_tmax_45_3)
pathein_tmax_future <- pathein_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
pathein_tmax_ens_85 = all_tmax_ens  %>% filter(States == 1 & RCP == 85)
pathein_tmax_85_1 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_85_2 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_85_3 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# pathein_tmax_45_1;pathein_tmax_45_2;pathein_tmax_45_3
pathein_tmax_future_85 <- rbind.data.frame(
  pathein_tmax_85_1, 
  pathein_tmax_85_2, 
  pathein_tmax_85_3)
pathein_tmax_future_85 <- pathein_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```


#### Daily

```{r}
### RCP 4.5 

p1 <- pathein_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5 

p2 <- pathein_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5 

p3 <- pathein_tmax_future %>%
  group_by(Month) %>% 
  summarize(
  Mean = mean(future, na.rm = TRUE),
      Obmean = mean(Tmax.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5 

p4 <- pathein_tmax_future_85 %>%
  group_by(Month) %>% 
  summarize(
  Mean = mean(future, na.rm = TRUE),
      Obmean = mean(Tmax.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
pathein_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar by 2100<br><br>")

pathein_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar by 2100<br><br>")
``` 

#### Annual - Departure

```{r}

### RCP 4.5 

p5 <- pathein_tmax_future %>%
  group_by(Year) %>% 
  summarize(
  Mean = mean(future, na.rm = TRUE),
      Obmean = mean(Tmax.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5 

p6 <- pathein_tmax_future_85 %>%
  group_by(Year) %>% 
  summarize(
  Mean = mean(future, na.rm = TRUE),
      Obmean = mean(Tmax.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6

```

#### Summary Table by Year

```{r}
pathein_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar<br><br>")

pathein_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar<br><br>")
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(pathein_tmax, aes(x = Tmax, y = ..density..)) + 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(pathein_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmax$Tmax), 2), "C"),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = pathein_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2
  ) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(pathein_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    pathein_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = pathein_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(pathein_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```


### Observed Data - Dawei Station

```{r}
dawei_tmax <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Dawei/clean_dawei_maxTem_edited.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
dawei_tmax["Date"] <- ymd(dawei_tmax$Date)
dawei_tmax$date <- dawei_tmax$Date

#all_tmax_ens <- all_tmax_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
#names(all_tmax_ens) <- c("Date", "Year", "Month", "States", "Tmax", "RCP")
dawei_tmax_ens = all_tmax_ens  %>% filter(States == 18 & RCP == 45 )
dawei_tmax_45_1 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_45_2 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_45_3 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# dawei_tmax_45_1;dawei_tmax_45_2;dawei_tmax_45_3
dawei_tmax_future <- rbind.data.frame(
  dawei_tmax_45_1, 
  dawei_tmax_45_2, 
  dawei_tmax_45_3
  )

#### RCP 85 
dawei_tmax_ens_85 = all_tmax_ens  %>% filter(States == 18 & RCP == 85 )
dawei_tmax_85_1 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_85_2 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_85_3 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# dawei_tmax_45_1;dawei_tmax_45_2;dawei_tmax_45_3
dawei_tmax_future_85 <- rbind.data.frame(
  dawei_tmax_85_1, 
  dawei_tmax_85_2, 
  dawei_tmax_85_3
  )
```

#### Daily

```{r}
p1 <- dawei_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Dawei, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5

p2 <- dawei_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Dawei, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```


#### Monthly

```{r}
p3 <- dawei_tmax_future %>%
  mutate(
      Year = year(Date),
      Month = month(Date)
  ) %>% 
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Dawei, RCP 4.5",
      caption = "Source: ECD-SND, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
   
)

### RCP 8.5

p4 <- dawei_tmax_future_85 %>%
  mutate(
      Year = year(Date),
      Month = month(Date)
  ) %>% 
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Dawei, RCP 8.5",
      caption = "Source: ECD-SND, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
   
)

p3 / p4
```

#### Summary Table by Month

```{r}
dawei_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Dawei station, Tanintharyi Region, Myanmar by 2100<br><br>")

dawei_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Dawei station, Tanintharyi Region, Myanmar by 2100<br><br>")

```

#### Annual - Departure

```{r}

p5 <- dawei_tmax_future %>%
  mutate(
      Year = year(Date),
      Month = month(Date)
  ) %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Dawei, RCP 4.5",
      caption = "Source: ECD-SND, DMH"
  ) +
  theme_minimal() +
  theme(
legend.position = "bottom",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
)

### RCP 8.5

p6 <- dawei_tmax_future_85 %>%
mutate(
      Year = year(Date),
      Month = month(Date)
  ) %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Dawei, RCP 8.5",
      caption = "Source: ECD-SND, DMH"
  ) +
  theme_minimal() +
  theme(
legend.position = "bottom",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
   
)

p5 / p6
```

#### Summary Table by Year

```{r}
dawei_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 4.5) at Dawei station, Tanintharyi Region, Myanmar<br><br>")

dawei_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>%
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 8.5) at Dawei station, Tanintharyi Region, Myanmar<br><br>")
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(dawei_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(dawei_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)")
  ) +
  
  geom_density(
    data = dawei_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(dawei_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =dawei_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    dawei_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Dawei station, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = dawei_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(min(dawei_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(dawei_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =dawei_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Sittwe Station

```{r}
sittwe_tmax <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Sittwe/clean_Sittwe_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmax["date"] <- as.character(sittwe_tmax$date)
sittwe_tmax["year"] <- str_sub(sittwe_tmax$date, 1, 4)
sittwe_tmax["month"] <- str_sub(sittwe_tmax$date, 5, 6)
sittwe_tmax["day"] <- str_sub(sittwe_tmax$date, 7, 8)
sittwe_tmax["Date"] <- make_date(sittwe_tmax$year, sittwe_tmax$month, sittwe_tmax$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19810101"):(which(sittwe_tmax$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmax)
names(miss_jf_1982) <- c("Date", "Tmax")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19850101"):(which(sittwe_tmax$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmax)
names(miss_whole_1986) <- c("Date", "Tmax")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19871201"):(which(sittwe_tmax$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmax)
names(miss_dec_1988) <- c("Date", "Tmax")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19900201"):(which(sittwe_tmax$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmax)
names(miss_feb_1991) <- c("Date", "Tmax")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "20040301"):which(sittwe_tmax$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmax)
names(miss_mar_2005) <- c("Date", "Tmax")

sittwe_tmax <- sittwe_tmax[, c(6, 2)]
sittwe_tmax <- rbind.data.frame(sittwe_tmax, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)

sittwe_tmax["date"] <- ymd(sittwe_tmax$Date)

# all_tmax_ens <- all_tmax_ens  %>% select(dt.x, Year, Month, States, CFB, RCP)
# names(all_tmax_ens) <- c("Date", "Year", "Month", "States", "Tmax", "RCP")

sittwe_tmax_ens = all_tmax_ens  %>% filter(States == 12 & RCP == 45 )

sittwe_tmax_45_1 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_45_2 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_45_3 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# sittwe_tmax_45_1;sittwe_tmax_45_2;sittwe_tmax_45_3
sittwe_tmax_future <- rbind.data.frame(
  sittwe_tmax_45_1, 
  sittwe_tmax_45_2, 
  sittwe_tmax_45_3)
sittwe_tmax_future <- sittwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
### RCP 8.5

sittwe_tmax_ens = all_tmax_ens  %>% filter(States == 12 & RCP == 85 )

sittwe_tmax_85_1 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_85_2 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_85_3 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# sittwe_tmax_45_1;sittwe_tmax_45_2;sittwe_tmax_45_3
sittwe_tmax_future_85 <- rbind.data.frame(
  sittwe_tmax_85_1, 
  sittwe_tmax_85_2, 
  sittwe_tmax_85_3)
sittwe_tmax_future <- sittwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```
  
#### Daily

```{r}

p1 <- sittwe_tmax_future %>%
ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 7),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p2 <- sittwe_tmax_future_85 %>%
ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 7),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p1 / p2
```


#### Monthly

```{r}
p3 <- sittwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE)) %>% 
ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 9),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 12)
  )

p4 <- sittwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE)) %>% 
ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 9),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 12)
  )

p3 / p4
```

#### Summary Table - Monthly

```{r}
sittwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Sittwe station, Rakhine State, Myanmar by 2100 <br><br>")

sittwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1,  caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Sittwe station, Rakhine State, Myanmar by 2100<br><br>")
```

#### Annual - Departure

```{r}
p5 <- sittwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% c(2040, 2060, 2080, 2100)) %>% 
group_by(Year)  %>% 
summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE)) %>% 
ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Maximum Temperature, Sittwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 9),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p6 <- sittwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Year)  %>% 
summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE)) %>% 
ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Sittwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 9),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p5 / p6
```

#### Summary Table by Year

```{r}
sittwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 4.5) at Sittwe station, Rakhine State, Myanmar")

sittwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 8.5) at Sittwe station, Rakhine State, Myanmar<br><br>")

```

#### Climate Scenario (Mean shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(sittwe_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmax$Tmax) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(sittwe_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(sittwe_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar \nComparisons of 30 years cycles under RCP 4.5 - (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = sittwe_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(sittwe_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    sittwe_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar \nComparisons of 30 years cycles under RCP 8.5 - (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = sittwe_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(sittwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(sittwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

## Minimum Temperature
### Ensemble Data

```{r}
setwd("~/ClimateScenarioDevelopment_MM/data/all_tmin_ensemble/")

files <- list.files(getwd(),
                   pattern = "^t\\w{3,4}\\w\\w{6}\\w\\d{2}\\w\\d{4}\\.csv$")

#files

df <- map_df(files, ~read_csv(.x, col_names = c("Name", "States", "CFB")))

df <- df  %>% mutate(
    Year = str_sub(Name, 9, 12),
    Month = str_sub(Name, 14, 15),
    RCP = str_sub(Name, 6, 7)
) %>% mutate(
monthly = paste0(Year, "-", Month)
)

df1 <- df  %>% mutate(
    dt = ymd(paste0((monthly), "-01"))
)

all_dates <- df1  %>% select(dt) %>% 
    complete(dt = seq.Date(min(dt), max(dt) + 30, by = "days")) %>% 
    mutate(
    monthly = paste(year(dt), str_pad(month(dt), 2, pad = "0"), sep = "-"))
# all_dates
    

all_tmin_ens <- all_dates  %>% 
    left_join(df1, by = "monthly")
#all_tmin_ens
all_tmin_ens <- all_tmin_ens  %>% select(dt.x, States, CFB, RCP)
names(all_tmin_ens) <- c("Date", "States", "Tmin", "RCP")
```

### Summary Plot for Minimum Temperature

```{r fig.width=10, fig.height=8}
dryzone <- all_tmin_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(8, 9, 13, 14))
dryzone$States <- factor(dryzone$States, levels = c(8, 9, 13, 14), labels = c("Magwe", "Mandalay", "Sagaing (L)", "Sagaing (U)"))
dryzone$RCP <- factor(dryzone$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
dryzone_tmin <- ggplot(dryzone, aes(x = Date, y = Tmin, color = factor(Month))) +
geom_line()+
facet_grid(RCP~States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Minimum Temperature Change in Dry Zone Region",
    caption = "Source: ECD - SNC, DMH"
    
)+
   scale_color_hue(l = 85) +
  scale_colour_manual(labels = month.name, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                        # colors()[seq(6, 657, 5)]) +
 
theme_minimal()+
  #scale_color_brewer(palette = "RdBu", type = "disc") +
theme(
legend.position = "none",
panel.background = element_rect("snow"),
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7)
)

coastal <- all_tmin_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(1, 10, 12, 18, 19))
coastal$States <- factor(coastal$States, levels = c(1, 10, 12, 18, 19), labels = c("Ayeyarwaddy", "Mon", "Rakhine", "Tanintharyi", "Yangon"))
coastal$RCP <- factor(coastal$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
coastal_tmin <- ggplot(coastal, aes(x = Date, y = Tmin, color = factor(Month))) +
geom_line()+
facet_grid(RCP~States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Minimum Temperature Change in Coastal Region",
    caption = "Source: ECD - SNC, DMH"
    
)+
   scale_color_hue(l = 85) +
  scale_colour_manual(labels = month.name, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                        # colors()[seq(6, 657, 5)]) +
 
theme_minimal()+
  #scale_color_brewer(palette = "RdBu", type = "disc") +
theme(
legend.position = "none",
panel.background = element_rect("snow"),
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7)
)

others <- all_tmin_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(2, 3, 4, 5, 6, 7, 11, 15, 16, 17))
others$States <- factor(others$States, levels = c(2, 3, 4, 5, 6, 7, 11, 15, 16, 17), labels = c("Bago (E)", "Bago (W)", "Chin", "Kachin", "Kayah", "Kayin", "Nay Pyi Taw", "Shan (E)", "Shan (N)", "Shan (S)"))
others$RCP <- factor(others$RCP, levels = c(45, 85), labels = c("RCP 4.5", "RCP 8.5"))
others_tmin <- ggplot(others, aes(x = Date, y = Tmin, color = factor(Month))) +
geom_line()+
facet_grid(RCP~States, scales = "free_y") +
labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Projected Minimum Temperature Change in Mountainous Region",
    caption = "Source: ECD - SNC, DMH"
    
)+
   scale_color_hue(l = 85) +
  scale_colour_manual(labels = month.name, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon")) +
                        # colors()[seq(6, 657, 5)]) +
 
theme_minimal()+
  #scale_color_brewer(palette = "RdBu", type = "disc") +
theme(
legend.position = "right",
panel.background = element_rect("snow"),
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45),
plot.title = element_text(face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
axis.text = element_text(face = "bold", size = 7)
)

dryzone_tmin
coastal_tmin
others_tmin

others_tmin / dryzone_tmin/ coastal_tmin
```

### Observed Data - Pathein Station

```{r}
pathein_tmin <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Pathein/clean_Pathein_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
pathein_tmin["Date"] <- ymd(pathein_tmin$Date)
pathein_tmin$date <- pathein_tmin$Date

pathein_tmin_ens = all_tmin_ens  %>% filter(States == 1 & RCP == 45 )
### RCP4.5
pathein_tmin_45_1 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_45_2 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_45_3 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_future <- rbind.data.frame(
    pathein_tmin_45_1, 
    pathein_tmin_45_2, 
    pathein_tmin_45_3)
pathein_tmin_future <- pathein_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
pathein_tmin_ens_85 = all_tmin_ens  %>% filter(States == 1 & RCP == 85)

pathein_tmin_85_1 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_85_2 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_85_3 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_future_85 <- rbind.data.frame(
    pathein_tmin_85_1, 
    pathein_tmin_85_2, 
    pathein_tmin_85_3)
pathein_tmin_future_85 <- pathein_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
# RCP 4.5 
p1 <- pathein_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  #scale_x_discrete(limits = factor(2010, 2020, 2030, 2040, 2050, 2060, 2070, 2080, 2090, 2100))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11)
    )

# RCP 8.5 
p2 <- pathein_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  #scale_x_discrete(limits = factor(2010, 2020, 2030, 2040, 2050, 2060, 2070, 2080, 2090, 2100))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11)
    )

p1 / p2
```

#### Monthly

```{r}
p3 <- pathein_tmin_future %>%
  group_by(Month) %>% 
  summarize(Mean = mean(future, na.rm = TRUE),
           Obmean = mean(Tmin.x, na.rm = TRUE)) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
    )

# RCP 8.5 
p4 <- pathein_tmin_future_85 %>%
  group_by(Month) %>% 
  summarize(Mean = mean(future, na.rm = TRUE),
           Obmean = mean(Tmin.x, na.rm = TRUE)) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
    )

p3 / p4

```

#### Summary Table by Month

```{r}
pathein_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar by 2100<br><b>")

pathein_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar by 2100<br><br>")

```

#### Annual - Departure

```{r}
p5 <- pathein_tmin_future %>%
  group_by(Year) %>% 
  summarize(Mean = mean(future, na.rm = TRUE),
           Obmean = mean(Tmin.x, na.rm = TRUE)) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
    )

# RCP 8.5 
p6 <- pathein_tmin_future_85 %>%
  group_by(Year) %>% 
  summarize(Mean = mean(future, na.rm = TRUE),
           Obmean = mean(Tmin.x, na.rm = TRUE)) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
    )

p5 / p6

```

#### Summary Table by Year

```{r}
pathein_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    MMean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar<br><br>")

pathein_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    MMean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar<br><br>")
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(pathein_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5, 
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmin$Tmin) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(pathein_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = pathein_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5, 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmin_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(pathein_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmin
p2 <-  ggplot(
    pathein_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = pathein_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(pathein_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(pathein_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Dawei Station

```{r}
dawei_tmin <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Dawei/clean_dawei_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
dawei_tmin["Date"] <- ymd(dawei_tmin$Date)
dawei_tmin$date <- dawei_tmin$Date

# all_tmin_ens <- all_tmin_ens  %>% select(dt.x, States, CFB, RCP)
# names(all_tmin_ens) <- c("Date", "States", "Tmin", "RCP")

# RCP 4.5
dawei_tmin_ens = all_tmin_ens  %>% filter(States == 18 & RCP == 45 )
dawei_tmin_45_1 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_45_2 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_45_3 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )

dawei_tmin_future <- rbind.data.frame(
  dawei_tmin_45_1, 
  dawei_tmin_45_2, 
  dawei_tmin_45_3)
dawei_tmin_future <- dawei_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
dawei_tmin_ens_85 = all_tmin_ens  %>% filter(States == 18 & RCP == 85 )
dawei_tmin_85_1 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_85_2 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_85_3 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )

dawei_tmin_future_85 <- rbind.data.frame(
  dawei_tmin_85_1, 
  dawei_tmin_85_2, 
  dawei_tmin_85_3)
dawei_tmin_future_85 <- dawei_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
p1 <- dawei_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = c("2000", "2010", "2020", "2030", "2040", "2050", "2060", "2070", "2080", "2090", "2100"))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p2 <- dawei_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = c("2000", "2010", "2020", "2030", "2040", "2050", "2060", "2070", "2080", "2090", "2100"))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```

#### Monthly

```{r}

p3 <- dawei_tmin_future %>%
  group_by(Month) %>% 
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- dawei_tmin_future_85 %>%
  group_by(Month) %>% 
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
dawei_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    MMean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Dawei station, Tanintharyi Region, Myanmar by 2100**<br><br>")

dawei_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    MMean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Dawei station, Tanintharyi Region, Myanmar by 2100**<br><br>")
```

#### Annual - Departure

```{r}
p5 <- dawei_tmin_future %>%
  group_by(Year) %>% 
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p6 <- dawei_tmin_future_85 %>%
  group_by(Year) %>% 
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE)
  ) %>% 
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "lightcyan"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
dawei_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Dawei station, Tanintharyi Region, Myanmar")

dawei_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Dawei station, Tanintharyi Region, Myanmar")
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(dawei_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5, 
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmin$Tmin) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(dawei_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = dawei_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5, 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmin_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(dawei_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =dawei_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Dawei Tmin
p2 <-  ggplot(
    dawei_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = dawei_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(dawei_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(dawei_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(dawei_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(dawei_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =dawei_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(dawei_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```



### Observe Data - Sittwe Station


```{r}
sittwe_tmin <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Sittwe/clean_Sittwe_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmin["date"] <- as.character(sittwe_tmin$date)
sittwe_tmin["year"] <- str_sub(sittwe_tmin$date, 1, 4)
sittwe_tmin["month"] <- str_sub(sittwe_tmin$date, 5, 6)
sittwe_tmin["day"] <- str_sub(sittwe_tmin$date, 7, 8)
sittwe_tmin["Date"] <- make_date(sittwe_tmin$year, sittwe_tmin$month, sittwe_tmin$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19810101"):(which(sittwe_tmin$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmin)
names(miss_jf_1982) <- c("Date", "Tmin")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19850101"):(which(sittwe_tmin$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmin)
names(miss_whole_1986) <- c("Date", "Tmin")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19871201"):(which(sittwe_tmin$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmin)
names(miss_dec_1988) <- c("Date", "Tmin")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19900201"):(which(sittwe_tmin$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmin)
names(miss_feb_1991) <- c("Date", "Tmin")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "20040301"):which(sittwe_tmin$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmin)
names(miss_mar_2005) <- c("Date", "Tmin")

sittwe_tmin <- sittwe_tmin[, c(6, 2)]
sittwe_tmin <- rbind.data.frame(sittwe_tmin, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_tmin["date"] <- ymd(sittwe_tmin$Date)

# all_tmin_ens <- all_tmin_ens  %>% select(dt.x, States, CFB, RCP)
# names(all_tmin_ens) <- c("Date", "States", "Tmin", "RCP")

# RCP 4.5
sittwe_tmin_ens = all_tmin_ens  %>% filter(States == 12 & RCP == 45 )

sittwe_tmin_45_1 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_45_2 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_45_3 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_tmin_future <- rbind.data.frame(
  sittwe_tmin_45_1,
  sittwe_tmin_45_2,
  sittwe_tmin_45_3
)

sittwe_tmin_future <- sittwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


# RCP 8.5
sittwe_tmin_ens_85 = all_tmin_ens  %>% filter(States == 12 & RCP == 85 )

sittwe_tmin_85_1 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_85_2 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_85_3 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_tmin_future_85 <- rbind.data.frame(
  sittwe_tmin_85_1,
  sittwe_tmin_85_2,
  sittwe_tmin_85_3
)

sittwe_tmin_future_85 <- sittwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
p1 <- sittwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p2 <- sittwe_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p1 / p2
```


#### Monthly

```{r}
p3 <- sittwe_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
           Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p4 <- sittwe_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
           Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p3 / p4
```

#### Summary Table - Monthly

```{r}
sittwe_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Sittwe station, Rakhine State, Myanmar by 2100<br><br>")

sittwe_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Sittwe station, Rakhine State, Myanmar by 2100<br><br>")
```

#### Annual - Departure

```{r}
p5 <- sittwe_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
           Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p6 <- sittwe_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
           Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
sittwe_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Sittwe station, Rakhine State, Myanmar")

sittwe_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Sittwe station, Rakhine State, Myanmar")
```

#### Annual - Departure

```{r}
p7 <- sittwe_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
           ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = sittwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p8 <- sittwe_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = sittwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
      title = "Minimum Temperature, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7)
  )

p7 / p8
```

#### Climate Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
p1 <- ggplot(sittwe_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5, 
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmin$Tmin) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(sittwe_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(sittwe_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = sittwe_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5, 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmin_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(sittwe_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Sittwe Tmin
p2 <-  ggplot(
    sittwe_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 - (Ensemble Approach)"
  ) +
  
  geom_density(
    data = sittwe_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(sittwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(sittwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(sittwe_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```






## Precipitation
### Ensemble Data

```{r}
setwd("~/ClimateScenarioDevelopment_MM/data/all_precip_ensemble/")

files <- list.files(getwd(),
                   pattern = "^p\\w{3,4}\\w\\w{6}\\w\\d{2}\\w\\d{4}\\.csv$")

#files

df <- map_df(files, ~read_csv(.x, col_names = c("Name", "States", "CFB")))

#df$Name <- str_replace(df$Name, "i", "")
#df["RCP"] <- str_sub(df$Name, 6, 7)
df <- df  %>% mutate(
    Year = str_extract(Name, pattern = "\\d{4}"),
    Month = str_extract(Name, pattern = "\\d{2}$"),
    RCP = str_replace_all(Name, pattern = "^P\\w{3,4}|\\d{2}$|\\d{4}|\\_", "")
) %>% mutate(
monthly = paste0(Year, "-", Month)
)

df1 <- df  %>% mutate(
    dt = ymd(paste0((monthly), "-01"))
)

#df1

all_dates <- df1  %>% select(dt) %>% 
    complete(dt = seq.Date(min(dt), max(dt) + 30, by = "days")) %>% 
    mutate(
    monthly = paste(year(dt), str_pad(month(dt), 2, pad = "0"), sep = "-"))
#all_dates
    

all_preci_ens <- all_dates  %>% 
    left_join(df1, by = "monthly") %>% distinct()
#all_tmin_ens
all_preci_ens <- all_preci_ens  %>% select(dt.x, States, CFB, RCP)
names(all_preci_ens) <- c("Date", "States", "preci", "RCP")

# all_preci_ens[which(is.na(all_preci_ens$CFB)),]
```

#### Summary Plot for Precipitation

```{r fig.width=10, fig.height=8}
all_preci_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP) %>% 
ggplot(aes(x = Date, y = preci, color = as.factor(States), fill = factor(Month))) +
geom_jitter(alpha = 5, size = 0.2)+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y =  "Precipitation in (%) change",
    title = "Precipitation Change in (%) from Baseline at different Regions and States of Myanmar",
    caption = "Source: ECD - SNC, DMH")+
  scale_color_manual(labels = c("Ayeyarwaddy", "Eastern Bago", "Northern Bago", "Chin", "Kachin", "Kayah", "Kayin",
              "Magwe", "Mandalay", "Mon", "Naypyitaw", "Rakhine", "Lower Sagaing", "Upper Sagaing",
             "Eastern Shan", "Southern Shan", "Northern Shan", "Tanintharyi", "Yangon"), values = colors()[seq(57, 657, 5)]
)+
    
theme_minimal()+
theme(
plot.background = element_rect(fill = "grey90"),
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 7),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45)
)
```

```{r fig.width=10, fig.height=8}
dryzone <- all_preci_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(8, 9, 13, 14))
dryzone$States <- factor(dryzone$States, levels = c(8, 9, 13, 14), labels = c("Magwe", "Mandalay", "Sagaing (L)", "Sagaing (U)"))
dryzone$RCP <- factor(dryzone$RCP, levels = c(45, 85), labels = c("RCP4.5", "RCP8.5"))
dryzone_prec <- ggplot(dryzone, aes(x = Date, y = preci, color = factor(Month))) +
geom_line(size = 1)+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y =  "Precipitation in (%) change",
    title = "Precipitation Change in (%) from Baseline in Dry Zone Region",
    caption = "Source: ECD - SNC, DMH")+
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon") #colors()[seq(57, 657, 5)]
)+
theme_minimal()+
theme(
plot.background = element_rect(fill = "snow"),
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 10),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45)
)

coastal <- all_preci_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(1, 10, 12, 18, 19))
coastal$States <- factor(coastal$States, levels = c(1, 10, 12, 18, 19), labels = c("Ayeyarwaddy", "Mon", "Rakhine", "Tanintharyi", "Yangon"))
coastal$RCP <- factor(coastal$RCP, levels = c(45, 85), labels = c("RCP4.5", "RCP8.5"))
coastal_prec <- ggplot(coastal, aes(x = Date, y = preci, color = factor(Month))) +
geom_line(size = 1)+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y =  "Precipitation in (%) change",
    title = "Precipitation Change in (%) from Baseline in Coastal Region",
    caption = "Source: ECD - SNC, DMH")+
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon") #colors()[seq(57, 657, 5)]
)+
theme_minimal()+
theme(
plot.background = element_rect(fill = "snow"),
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 10),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45)
)

others <- all_preci_ens  %>% mutate(Month = month(Date)) %>% group_by(States, RCP, Month) %>% filter(States %in% c(2:7, 11, 15:17))
others$States <- factor(others$States, levels = c(2:7, 11, 15:17), labels = c("Bago (E)", "Bago (W)", "Chin", "Kachin", "Kayah", "Kayin", "Nay Pyi Taw", "Shan (E)", "Shan (N)", "Shan (S)"))
others$RCP <- factor(others$RCP, levels = c(45, 85), labels = c("RCP4.5", "RCP8.5"))
others_prec <- ggplot(others, aes(x = Date, y = preci, color = factor(Month))) +
geom_line(size = 1)+
scale_color_hue(l = 45) +
facet_grid(RCP ~ States, scales = "free_y") +
labs(
    x = "Year",
    y =  "Precipitation in (%) change",
    title = "Precipitation Change in (%) from Baseline in Mountainous Region",
    caption = "Source: ECD - SNC, DMH")+
  scale_color_manual(labels = month.abb, values = c("orange", "blue", "darkolivegreen", "green", "deeppink", "red", "black", "violet", "steelblue", "cyan", "deepskyblue", "maroon") #colors()[seq(57, 657, 5)]
)+
theme_minimal()+
theme(
plot.background = element_rect(fill = "snow"),
legend.position = "bottom",
legend.text = element_text(face = "bold", size = 10),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45)
)
#ggpoggplotly(dryzone_prec)
dryzone_prec
coastal_prec
others_prec
```


### Observed Data - Pathein Station

```{r}
pathein_preci <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Pathein/clean_Pathein_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
pathein_preci["Date"] <- ymd(pathein_preci$Date)
# checking NA values
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))]),]
## One day before to NA value
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))] -1),]
## One day after to NA value
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))] +1),]
pathein_preci <- pathein_preci %>% mutate(
  preci = Hmisc::impute(preci, "random")
)
pathein_preci$date <- pathein_preci$Date
### RCP4.5
pathein_preci_ens = all_preci_ens  %>% filter(States == 1 & RCP == 45 )

pathein_preci_45_1 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_45_2 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_45_3 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
pathein_preci_future <- rbind.data.frame(
  pathein_preci_45_1, 
  pathein_preci_45_2, 
  pathein_preci_45_3)
pathein_preci_future <- pathein_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5

pathein_preci_ens_85 = all_preci_ens  %>% filter(States == 1 & RCP == 85 )

pathein_preci_85_1 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(pathein_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_85_2 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(pathein_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_85_3 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(pathein_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
pathein_preci_future_85 <- rbind.data.frame(
  pathein_preci_85_1, 
  pathein_preci_85_2, 
  pathein_preci_85_3)
pathein_preci_future_85 <- pathein_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- pathein_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

### RCP 8.5
p2 <- pathein_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- pathein_preci_future %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
      Obtotal = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed") +
  geom_col(aes(x = Month, y = Obtotal), fill = "deepskyblue") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

### RCP 8.5
p4 <- pathein_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future)/90,
      Obtotal = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed") +
  geom_col(aes(x = Month, y = Obtotal), fill = "deepskyblue") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p3/p4
```

#### Summary Table by Month

```{r}
pathein_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Pathein Station**, Ayeyarwaddy Region, Myanmar") 

pathein_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at Pathein Station, Ayeyarwaddy Region, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- pathein_preci_future %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
      Obtotal = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

### RCP 8.5
p6 <- pathein_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future),
      Obtotal = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
      title = "Precipitation, Pathein, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p5/p6
```

#### Summary Table by Year

```{r}
pathein_preci_future %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Annual Precipitation Changes under RCP 4.5 by 2100 at Pathein Station, Ayeyarwaddy Region, Myanmar") 

pathein_preci_future_85 %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Annual Precipitation Changes under RCP 4.5 by 2100 at Pathein Station, Ayeyarwaddy Region, Myanmar") 
```

### Observe Data - Dawei Station

```{r}
dawei_preci <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Dawei/clean_dawei_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
dawei_preci["Date"] <- ymd(dawei_preci$Date)
dawei_preci$date <- dawei_preci$Date


#all_preci_ens <- all_preci_ens  %>% select(dt.x, States, CFB, RCP)
#names(all_preci_ens) <- c("Date", "States", "preci", "RCP")

### RCP 4.5
dawei_preci_ens = all_preci_ens  %>% filter(States == 18 & RCP == 45 )

dawei_preci_45_1 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_45_2 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_45_3 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )

dawei_preci_future <- rbind.data.frame(
  dawei_preci_45_1, 
  dawei_preci_45_2, 
  dawei_preci_45_3)
dawei_preci_future <- dawei_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


### RCP 8.5

dawei_preci_ens_85 = all_preci_ens  %>% filter(States == 18 & RCP == 85 )

dawei_preci_85_1 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(dawei_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_85_2 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(dawei_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_85_3 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(dawei_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )

dawei_preci_future_85 <- rbind.data.frame(
  dawei_preci_85_1, 
  dawei_preci_85_2, 
  dawei_preci_85_3)
dawei_preci_future_85 <- dawei_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
p1 <- dawei_preci_future %>%
  group_by(Year) %>%
  # summarize(
  #   Pmax = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = preci.x),color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5

p2 <- dawei_preci_future_85 %>%
  group_by(Year) %>%
  # summarize(
  #   Pmax = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = preci.x),color = "deepskyblue") +
  scale_color_hue(l = 45) +
  #scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

p1 / p2

```

#### Monthly

```{r}
p3 <- dawei_preci_future %>%
  group_by(Month) %>%
  summarize(
  Total = sum(future, na.rm = TRUE)/90,
      Obtotal = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb)+
  labs(
    x = "Month",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5

p4 <- dawei_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
  Total = sum(future, na.rm = TRUE)/90,
      Obtotal = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb)+
  labs(
    x = "Month",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

p3 / p4
```

#### Summary Table by Month

```{r}
dawei_preci_future %>%
  group_by(Month) %>%
  summarize(
    Obmax = max(preci.x, na.rm = TRUE),
    Obmean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Observed, Modeled and Projected Precipitationunder RCP 4.5 by 2100 at Dawei Station, Tanintharyi Region, Myanmar<br><br>") 

dawei_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    Mmean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Observed, Modeled and Projected Precipitation under RCP 8.5 by 2100 at Dawei Station, Tanintharyi Region, Myanmar<br><br>") 
```

#### Annual - Departure

```{r}
p5 <- dawei_preci_future %>%
  group_by(Year) %>%
  summarize(
  Total = sum(future, na.rm = TRUE),
      Obtotal = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5

p6 <- dawei_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
  Total = sum(future, na.rm = TRUE),
      Obtotal = sum(preci.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Dawei, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

p5 / p6



```

#### Summary Table by Year

```{r}
### RCP 4.5
dawei_preci_future %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Observed, Modeled and Projected Precipitation under RCP 4.5 by 2100 at Dawei Station, Tanintharyi Region, Myanmar<br><br>") 

### RCP 8.5
dawei_preci_future_85 %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE),
    Growth = (PTotal - ObTotal)/ObTotal * 100
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Observed, Modeled and Projected Precipitation under RCP 8.5 by 2100 at Dawei Station, Tanintharyi Region, Myanmar<br><br>") 
```

### Observed Data - Sittwe Station

```{r}
sittwe_preci <- vroom::vroom("~/ClimateScenarioDevelopment_MM/data/Area-1/Sittwe/clean_Sittwe_rainfall.csv",
  delim = " ", col_names = c("date", "preci"), na = "-999.0", show_col_types = FALSE
)
sittwe_preci["date"] <- as.character(sittwe_preci$date)
sittwe_preci["year"] <- str_sub(sittwe_preci$date, 1, 4)
sittwe_preci["month"] <- str_sub(sittwe_preci$date, 5, 6)
sittwe_preci["day"] <- str_sub(sittwe_preci$date, 7, 8)
sittwe_preci["Date"] <- make_date(sittwe_preci$year, sittwe_preci$month, sittwe_preci$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19810101"):(which(sittwe_preci$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_preci)
names(miss_jf_1982) <- c("Date", "preci")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19850101"):(which(sittwe_preci$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_preci)
names(miss_whole_1986) <- c("Date", "preci")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19871201"):(which(sittwe_preci$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_preci)
names(miss_dec_1988) <- c("Date", "preci")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19900201"):(which(sittwe_preci$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_preci)
names(miss_feb_1991) <- c("Date", "preci")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_preci <- sittwe_preci$preci[which(sittwe_preci$date == "20040301"):which(sittwe_preci$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_preci)
names(miss_mar_2005) <- c("Date", "preci")

sittwe_preci <- sittwe_preci[, c(6, 2)]
sittwe_preci <- rbind.data.frame(sittwe_preci, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_preci["date"] <- ymd(sittwe_preci$Date)

#all_preci_ens <- all_preci_ens  %>% select(dt.x, States, CFB, RCP)
#names(all_preci_ens) <- c("Date", "States", "preci", "RCP")

### RCP 4.5
sittwe_preci_ens = all_preci_ens  %>% filter(States == 12 & RCP == 45 )

sittwe_preci_45_1 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_45_2 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_45_3 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_preci_future <- rbind.data.frame(
  sittwe_preci_45_1, 
  sittwe_preci_45_2, 
  sittwe_preci_45_3
  ) 
sittwe_preci_future <- sittwe_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5
sittwe_preci_ens_85 = all_preci_ens  %>% filter(States == 12 & RCP == 85 )

sittwe_preci_85_1 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(sittwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_85_2 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(sittwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_85_3 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(sittwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_preci_future_85 <- rbind.data.frame(
  sittwe_preci_85_1, 
  sittwe_preci_85_2, 
  sittwe_preci_85_3
  ) 
sittwe_preci_future_85 <- sittwe_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()


```

#### Daily

```{r}
### RCP 4.5 
p1 <- sittwe_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deeppink") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5 
p2 <- sittwe_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deeppink") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5 
p3 <- sittwe_preci_future %>%
  group_by(Month) %>%
  summarize(
  Total = sum(future, na.rm = TRUE)/90,
  Obtotal = sum(preci.x, na.rm = TRUE)/90,
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obtotal), color = "deeppink") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5 
p4 <- sittwe_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
  Total = sum(future, na.rm = TRUE)/90,
  Obtotal = sum(preci.x, na.rm = TRUE)/90,
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obtotal), color = "deeppink") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
p3 / p4
```

#### Summary Table by Month

```{r}
sittwe_preci_future %>%
#filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Observed, Modeled and Projected Precipitation under RCP 4.5 by 2100 at Sittwe Station, Rakhine State, Myanmar") 

sittwe_preci_future_85 %>%
#filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Observed, Modeled and Projected Precipitation under RCP 8.5 by 2100 at Sittwe Station, Rakhine State, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5 
p5 <- sittwe_preci_future %>%
  group_by(Year) %>%
  summarize(
  Total = sum(future, na.rm = TRUE),
  Obtotal = sum(preci.x, na.rm = TRUE),
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2000, 2010, by = 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 4.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

### RCP 8.5 
p6 <- sittwe_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
  Total = sum(future, na.rm = TRUE),
  Obtotal = sum(preci.x, na.rm = TRUE),
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2000, 2100, by = 10)) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
      title = "Precipitation, Sittwe, RCP 8.5",
      caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
p5 / p6
```

#### Summary Table by Year

```{r}
sittwe_preci_future %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Observed, Modeled and Projected Precipitation under RCP 4.5 by 2100 at Sittwe Station, Rakhine Region, Myanmar") 

sittwe_preci_future_85 %>%
filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Observed, Modeled and Projected Precipitation under RCP 8.5 by 2100 at Dawei Station, Tanintharyi Region, Myanmar") 
```

## Mountainous Region
### Mean Temperature
### Ensemble Data
### Observed Data - Hakha station

```{r}
hakha_tmean <- vroom::vroom(
  "data/Area-2/Hakha/clean_hakha_meanTem.csv",
  delim = " ",
  col_names = c("date", "Tmean"),
  na = "-999.0",
  show_col_types = FALSE
)
hakha_tmean$date <- as.character(hakha_tmean$date)
## set charactor for further analysis
##hakha_tmean$date <- ymd(hakha_tmean$date)
hakha_tmean["year"] <- str_sub(hakha_tmean$date, 1, 4)
hakha_tmean["month"] <- str_sub(hakha_tmean$date, 5, 6)
hakha_tmean["day"] <- str_sub(hakha_tmean$date, 7, 8)
hakha_tmean["Date"] <- make_date(
  hakha_tmean$year,
  hakha_tmean$month,
  hakha_tmean$day
)

## August, September, October, November 1991 missing
miss_ason_date <- seq.Date(ymd("1991-08-01"), ymd("1991-11-30"), "days")
miss_ason_tmean <- hakha_tmean$Tmean[which(hakha_tmean$date == "19900801"):(which(hakha_tmean$date == "19901130"))]
miss_ason_1991 <- bind_cols(miss_ason_date, miss_ason_tmean)
names(miss_ason_1991) <- c("Date", "Tmean")
hakha_tmean$date <- ymd(hakha_tmean$date)
hakha_tmean <- hakha_tmean[, c(1, 6, 2)]
hakha_tmean <- hakha_tmean %>%
  drop_na() %>%
  bind_rows(miss_ason_1991) %>%
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  ) %>% 
  arrange(Date)
### subset only 20 years
hakha_tmean <- hakha_tmean[730:nrow(hakha_tmean), ]


hakha_tmean["Date"] <- ymd(hakha_tmean$Date)
```
```{r}
hakha_tmean_ens <- all_tmean_ens %>% filter(States == 4 & RCP ==45)

hakha_tmean_45_1 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 1 
  ) %>%
  left_join(hakha_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_2 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_3 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 3 
  ) %>%
  left_join(hakha_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_45_4 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 4 + 1
  ) %>%
  left_join(hakha_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

hakha_tmean_future <- bind_rows(
  hakha_tmean_45_1,
  hakha_tmean_45_2,
  hakha_tmean_45_3,
  hakha_tmean_45_4
)


### RCP 8.5

hakha_tmean_ens_85 <- all_tmean_ens %>% filter(States == 4 & RCP == 85)

hakha_tmean_85_1 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 1 
  ) %>%
  left_join(hakha_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_2 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_3 <- hakha_tmean %>%
  mutate(
    Date = Date + 7305 * 3 
  ) %>%
  left_join(hakha_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
hakha_tmean_85_4 <- hakha_tmean %>%
  mutate(
    Date = Date + 7304 * 4 + 1
  ) %>%
  left_join(hakha_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

hakha_tmean_future_85 <- bind_rows(
  hakha_tmean_85_1,
  hakha_tmean_85_2,
  hakha_tmean_85_3,
  hakha_tmean_85_4
)
```

#### Daily

```{r}
hakha_tmean_future <- hakha_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
p1 <- hakha_tmean_future %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  ) 

hakha_tmean_future_85 <- hakha_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
p2 <- hakha_tmean_future_85 %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  ) 

p1 / p2
```

#### Monthly

```{r}
p3 <- hakha_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = month.abb) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p4 <- hakha_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = month.abb) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p3 /p4

```

#### Summary Table by Month

```{r}
hakha_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          Mmean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected mean temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar by 2100<br><br>**" )

hakha_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected mean temperature (RCP 8.5) at Hakha Station, Chin State, Myanmar by 2100<br><br>**" )
```

#### Annual - Departure

```{r}
p5 <- hakha_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p6 <- hakha_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p5 /p6
```

#### Summary Table by Year

```{r}
hakha_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Hakha Station, Chin State, Myanmar<br><br>" )

hakha_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Hakha Station, Chin State, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
p7 <- hakha_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = hakha_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p8 <- hakha_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = hakha_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "darkgreen") +
  #scale_color_manual(sample(colors()), na.value = "white")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_y_discrete(limits = c(10:22)) + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  scale_color_hue(l = 45) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    
  )

p7 / p8
```

### Climate Scenario (Mean shift from baseline) of projected Mean Temperature at Hakha station, Chin State, Myanmar

```{r Fig1-18, fig.width=10, fig.height=8, fig.cap="Density plot of Mean Temperature at Hakha station, Chin State, Myanmar"}
####  Density Plot for hakha station

### RCP 4.5
p1 <- ggplot(hakha_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmean$Tmean) -0.2, 2)), 
           y = 0.025, 
           label = paste(round(mean(hakha_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = hakha_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 2,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_1$future) -0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 2,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_2$future) -0.2,  2),
    y = 0.025,
    label = paste(round(mean(hakha_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 2,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmean_45_4, 
    aes(x = future, y = ..density..),
    adjust = 2,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmean_45_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_45_4$future) -0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_45_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmean_45_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmean_45_4$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.title = element_text(size = 7),
    axis.text  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    hakha_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 2,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = hakha_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 2,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(hakha_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(hakha_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 2,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(hakha_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(hakha_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmean_85_3, 
    aes(x = future, y = ..density..),
    adjust = 2, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
   geom_density(
    data =hakha_tmean_85_4, 
    aes(x = future, y = ..density..), 
    adjust = 2,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmean_85_4$future), 
    color = "steelblue", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmean_85_4$future) - 0.2, 2), 
    y = 0.025, 
    label = paste(round(mean(hakha_tmean_85_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmean_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmean_85_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmean_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmean_85_4$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.title = element_text(size = 7),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```


### Observed Data - Myitkyina Station

```{r}
myitkyina_tmean <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmean$date <- as.character(myitkyina_tmean$date) ## set charactor for further analysis
myitkyina_tmean["year"] <- str_sub(myitkyina_tmean$date, 1, 4)
myitkyina_tmean["month"] <- str_sub(myitkyina_tmean$date, 5, 6)
myitkyina_tmean["day"] <- str_sub(myitkyina_tmean$date, 7, 8)
myitkyina_tmean["Date"] <- make_date(myitkyina_tmean$year, myitkyina_tmean$month, myitkyina_tmean$day)

## September, October, November 11 1988 missing
miss_son_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-11-11"), "days")
miss_son_tmean <- myitkyina_tmean$Tmean[which(myitkyina_tmean$date == "19870918"):(which(myitkyina_tmean$date == "19871111"))]
miss_son_1988 <- cbind.data.frame(miss_son_date, miss_son_tmean)
names(miss_son_1988) <- c("Date", "Tmean")

myitkyina_tmean <- myitkyina_tmean[, c(1, 6, 2)]
myitkyina_tmean <- myitkyina_tmean %>%
  drop_na() %>%
  dplyr::bind_rows(miss_son_1988) %>%
  dplyr::arrange(Date) 

myitkyina_tmean["date"] <- ymd(myitkyina_tmean$date)

### RCP 4.5
myitkyina_tmean_ens <- all_tmean_ens %>% filter(States == 5 & RCP == 45)

myitkyina_tmean_45_1 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(myitkyina_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_45_2 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(myitkyina_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_45_3 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(myitkyina_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# myitkyina_tmean_45_1
# myitkyina_tmean_45_2
# myitkyina_tmean_45_3
myitkyina_tmean_future <- bind_rows(
  myitkyina_tmean_45_1, 
  myitkyina_tmean_45_2, 
  myitkyina_tmean_45_3
  )
myitkyina_tmean_future <- myitkyina_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5
myitkyina_tmean_ens_85 <- all_tmean_ens %>% filter(States == 5 & RCP == 85)

myitkyina_tmean_85_1 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(myitkyina_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_85_2 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(myitkyina_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
myitkyina_tmean_85_3 <- myitkyina_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(myitkyina_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# myitkyina_tmean_45_1
# myitkyina_tmean_45_2
# myitkyina_tmean_45_3
myitkyina_tmean_future_85 <- bind_rows(
  myitkyina_tmean_85_1, 
  myitkyina_tmean_85_2, 
  myitkyina_tmean_85_3
  )
myitkyina_tmean_future_85 <- myitkyina_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- myitkyina_tmean_future %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") + 
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm")
  )

### RCP 8.5

p2 <- myitkyina_tmean_future_85 %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") + 
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm")
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- myitkyina_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = month.abb) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- myitkyina_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = month.abb) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

p3 / p4
```

#### Summary Table by Month

```{r}
myitkyina_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          Mmean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar by 2100<br><br>" )

myitkyina_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Myitkyina Station, Kachin State, Myanmar by 2100<br><br>" )
```


#### Annual - Departure

```{r}
### RCP 4.5
p5 <- myitkyina_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- myitkyina_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

p5 / p6
```

#### Summary Table by Year

```{r}
myitkyina_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          Mmean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Myitkyina Station, Kachin State, Myanmar<br><br>" )

myitkyina_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Myitkyina Station, Kachin State, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- myitkyina_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
           ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = myitkyina_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize( Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- myitkyina_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = myitkyina_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize( Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45)+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom",
   # panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
   axis.title = element_text(face = "bold", size = 7),
   axis.text = element_text(face = "bold", size = 7)
    #axis.text.x = element_blank()
  )

p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of Mean Temperature at Myitkyina station, Kachin State, Myanmar

```{r Fig1-85, fig.width=10, fig.height=8, fig.cap="Mean shift to Right from baseline (1981-2010) of Mean Temperature at Myitkyina station, Kachin State, Myanmar"}
####  Density Plot for Pathein station

### RCP 4.5
p1 <- ggplot(myitkyina_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmean$Tmean) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(myitkyina_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3, 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(myitkyina_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    myitkyina_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(myitkyina_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text  = element_text(size = 9),
        axis.title = element_text(face = "bold", size = 9, color = "grey60"))

p1 + p2 + plot_layout(ncol = 1)
```


### Observed Data - Taunggyi Station

```{r}
taunggyi_tmean <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmean$date <- as.character(taunggyi_tmean$date) ## set charactor for further analysis
taunggyi_tmean["year"] <- str_sub(taunggyi_tmean$date, 1, 4)
taunggyi_tmean["month"] <- str_sub(taunggyi_tmean$date, 5, 6)
taunggyi_tmean["day"] <- str_sub(taunggyi_tmean$date, 7, 8)
taunggyi_tmean["Date"] <- make_date(taunggyi_tmean$year, taunggyi_tmean$month, taunggyi_tmean$day)

## November and December 1984 missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmean <- taunggyi_tmean$Tmean[which(taunggyi_tmean$date == "19831101"):(which(taunggyi_tmean$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmean)
names(miss_nd_1984) <- c("Date", "Tmean")

taunggyi_tmean <- taunggyi_tmean[, c(6, 2)]
taunggyi_tmean <- taunggyi_tmean %>%
  drop_na() %>%
  bind_rows(miss_nd_1984) %>%
  fill()
### subset only 20 years
# taunggyi_tmean <- taunggyi_tmean[731:nrow(taunggyi_tmean),]

taunggyi_tmean["Date"] <- ymd(taunggyi_tmean$Date)
taunggyi_tmean <- taunggyi_tmean %>% mutate(
  Tmean = Hmisc::impute(Tmean, mean)
)
taunggyi_tmean$date <- taunggyi_tmean$Date
```

```{r}
### RCP 4.5
taunggyi_tmean_ens <- all_tmean_ens %>% filter(States == 16 & RCP == 45)
taunggyi_tmean_45_1 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(taunggyi_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_45_2 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(taunggyi_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_45_3 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(taunggyi_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# taunggyi_tmean_45_1
# taunggyi_tmean_45_2
# taunggyi_tmean_45_3
taunggyi_tmean_future <- bind_rows(
  taunggyi_tmean_45_1, 
  taunggyi_tmean_45_2, 
  taunggyi_tmean_45_3
  )
taunggyi_tmean_future <- taunggyi_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
taunggyi_tmean_ens_85 <- all_tmean_ens %>% filter(States == 16 & RCP == 85)
taunggyi_tmean_85_1 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(taunggyi_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_85_2 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(taunggyi_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
taunggyi_tmean_85_3 <- taunggyi_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(taunggyi_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )

# taunggyi_tmean_45_1
# taunggyi_tmean_45_2
# taunggyi_tmean_45_3
taunggyi_tmean_future_85 <- bind_rows(
  taunggyi_tmean_85_1, 
  taunggyi_tmean_85_2, 
  taunggyi_tmean_85_3
  )
taunggyi_tmean_future_85 <- taunggyi_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- taunggyi_tmean_future %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_alpha(0.5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH", 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
  )

p2 <- taunggyi_tmean_future_85 %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_alpha(0.5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH", 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45),
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- taunggyi_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

### RCP 8.5

p4 <- taunggyi_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
taunggyi_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          Mmean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar<br><br>" )

taunggyi_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Taunggyi Station, Southern Shan State, Myanmar<br><br>" )
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- taunggyi_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

### RCP 8.5

p6 <- taunggyi_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
taunggyi_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          Mmean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Taunggyi Station, Southern Shan State, Myanmar<br><br>" )

taunggyi_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Pmean = mean(future),
          Pmax = max(future),
          Pmin = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         Mmean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Taunggyi Station, Southern Shan State, Myanmar<br><br>" )
```

#### Annual - Departure

```{r}
### RCP 4.5
p7 <- taunggyi_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = taunggyi_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

### RCP 8.5

p8 <- taunggyi_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = taunggyi_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "steelblue"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", color = "cyan", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(.9, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.background = element_rect(fill = "lightyellow"),
    strip.background = element_rect(fill = "steelblue"),
    strip.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.title = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text = element_text(face = "bold", size = 7, color = "lightyellow"),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )

p7 / p8
```

#### Climate Change Scenario (Mean Shift from baseline) of projected Mean Temperature at Taunggyi station, Southern Shan State, Myanmar

```{r Fig1-156, fig.width=10, fig.height=8, fig.cap="Mean shift from the baseline (1981-2010) of projected mean temperature at Taunggyi station, Southern Shan State, Myanmar"}
####  Density Plot for Pathein station

### RCP 4.5
p1 <- ggplot(taunggyi_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(taunggyi_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(taunggyi_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(taunggyi_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(taunggyi_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    taunggyi_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift to Right from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(taunggyi_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature
### Observed Data - Hakha Station

```{r}
hakha_tmax <- vroom::vroom(
  "data/Area-2/Hakha/clean_hakha_maxTem.csv",
  delim = " ",
  col_names = c("date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)

hakha_tmax <- hakha_tmax[731:nrow(hakha_tmax), ]
hakha_tmax$date <- ymd(hakha_tmax$date)

 hakha_tmax["Date"] <- ymd(hakha_tmax$date)
 hakha_tmax <- hakha_tmax %>% 
   select(date, Date, Tmax)
 
 ### RCP 4.5
 hakha_tmax_ens <- all_tmax_ens %>% filter(States == 4 & RCP == 45)
 
 hakha_tmax_45_1 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_2 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_3 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_45_4 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# hakha_tmax_45_1;hakha_tmax_45_2;hakha_tmax_45_3
hakha_tmax_future <- bind_rows(
  hakha_tmax_45_1,
  hakha_tmax_45_2,
  hakha_tmax_45_3,
  hakha_tmax_45_4
)
hakha_tmax_future <- hakha_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

 ### RCP 4.5
 hakha_tmax_ens_85 <- all_tmax_ens %>% filter(States == 4 & RCP == 85)
 
 hakha_tmax_85_1 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_2 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_3 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
hakha_tmax_85_4 <- hakha_tmax %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# hakha_tmax_45_1;hakha_tmax_45_2;hakha_tmax_45_3
hakha_tmax_future_85 <- bind_rows(
  hakha_tmax_85_1,
  hakha_tmax_85_2,
  hakha_tmax_85_3,
  hakha_tmax_85_4
)
hakha_tmax_future_85 <- hakha_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

#### Daily

```{r}
### RCP 4.5

p1 <- hakha_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p2 <- hakha_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- hakha_tmax_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Month) %>% 
              summarize(Obmean = mean(Tmax.x)), aes(x = Month, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )

### RCP 8.5
p4 <- hakha_tmax_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Month) %>% 
              summarize(Obmean = mean(Tmax.x)), aes(x = Month, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )
p3 / p4
```

#### Summary Table by Month

```{r}
hakha_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Hakha station, Chin State, Myanmar")

hakha_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Mmax = max(future, na.rm = TRUE),
    Mmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Hakha station, Chin State, Myanmar")
``` 




#### Annual - Departure

```{r}
### RCP 4.5
p5 <- hakha_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 'dashed') +
  geom_line(aes(x = Year, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )

### RCP 8.5
p6 <- hakha_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 'dashed') +
  geom_line(aes(x = Year, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )
p5 / p6
```

#### Summary Table by Year

```{r}
hakha_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Hakha station, Chin State, Myanmar")

hakha_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Hakha station, Chin State, Myanmar")
``` 


#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- hakha_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 'dashed') +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Year) %>% 
              summarize(Obmean = mean(Tmax.x)), aes(x = Year, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )

### RCP 8.5
p8 <- hakha_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 'dashed', size = 0.5) +
  geom_line(data = hakha_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Year) %>% 
              summarize(Obmean = mean(Tmax.x)), aes(x = Year, y = Obmean), color = "darkred") + 
  # geom_hline(yintercept=34)+
  scale_color_hue(l = 50) +
  scale_color_viridis_d(option = "C" ) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    axis.text.x = element_text(face = "bold", size = 7, )
  )
p7 / p8
```

#### Climate Change Scenario (Mean Shift from the baseline)

```{r fig.width=10, fig.height=8}
####  Density Plot for Hakha station

### RCP 4.5
p1 <- ggplot(hakha_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(hakha_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 4.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = hakha_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(hakha_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmax_45_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmax_45_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_45_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmax_45_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmax_45_4$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Hakha Tmax
p2 <-  ggplot(
    hakha_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1991-2010) at Hakha station, Chin State, Myanmar \nComparisons of 20 years cycles under RCP 8.5 (Ensemble Approach)"
  ) +
  
  geom_density(
    data = hakha_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(hakha_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(hakha_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(hakha_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(hakha_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
    geom_density(
    data =hakha_tmax_85_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmax_85_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(hakha_tmax_85_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmax_85_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmax_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmax_85_4$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Oberved Data - Myitkyina station

```{r}
myitkyina_tmax <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmax$date <- as.character(myitkyina_tmax$date) ## set charactor for further analysis
myitkyina_tmax["year"] <- str_sub(myitkyina_tmax$date, 1, 4)
myitkyina_tmax["month"] <- str_sub(myitkyina_tmax$date, 5, 6)
myitkyina_tmax["day"] <- str_sub(myitkyina_tmax$date, 7, 8)
myitkyina_tmax["Date"] <- make_date(myitkyina_tmax$year, myitkyina_tmax$month, myitkyina_tmax$day)
## September, October, November 11 1988 missing
miss_son_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-11-11"), "days")
miss_son_tmax <- myitkyina_tmax$Tmax[(2818 - 365):(2872 - 365)]
miss_son_1988 <- cbind.data.frame(miss_son_date, miss_son_tmax)
names(miss_son_1988) <- c("Date", "Tmax")

myitkyina_tmax <- myitkyina_tmax[, c(1, 6, 2)]
myitkyina_tmax <- myitkyina_tmax %>%
  drop_na() %>%
  bind_rows(miss_son_1988) %>%
  fill()
myitkyina_tmax$date <- ymd(myitkyina_tmax$date)

### RCP 4.5

myitkyina_tmax_ens <- all_tmax_ens %>% filter(States == 5, RCP == 45)

myitkyina_tmax_45_1 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(myitkyina_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_45_2 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(myitkyina_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_45_3 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(myitkyina_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_future <- bind_rows(
  myitkyina_tmax_45_1, 
  myitkyina_tmax_45_2, 
  myitkyina_tmax_45_3)
myitkyina_tmax_future <- myitkyina_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5

myitkyina_tmax_ens_85 <- all_tmax_ens %>% filter(States == 5, RCP == 85)

myitkyina_tmax_85_1 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(myitkyina_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_85_2 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(myitkyina_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_85_3 <- myitkyina_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(myitkyina_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
myitkyina_tmax_future_85 <- bind_rows(
  myitkyina_tmax_85_1, 
  myitkyina_tmax_85_2, 
  myitkyina_tmax_85_3)
myitkyina_tmax_future_85 <- myitkyina_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- myitkyina_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y= Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color ="grey85"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )

### RCP 8.5
p2 <- myitkyina_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y= Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color ="grey85"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- myitkyina_tmax_future %>%
  group_by(Month) %>%
   summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p4 <- myitkyina_tmax_future_85 %>%
  group_by(Month) %>%
   summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
myitkyina_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Myitkyina station, Kachin State, Myanmar")

myitkyina_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Myitkyina station, Kachin State, Myanmar")
``` 

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- myitkyina_tmax_future %>%
  group_by(Year) %>%
   summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p6 <- myitkyina_tmax_future_85 %>%
  group_by(Year) %>%
   summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
myitkyina_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Maximum Temperature (RCP 4.5) at Myitkyina station, Kachin State, Myanmar<br><br>")

myitkyina_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Maximum Temperature (RCP 8.5) at Myitkyina station, Kachin State, Myanmar<br><br>")
``` 

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- myitkyina_tmax_future %>%
  group_by(Year) %>%
   summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = myitkyina_tmax_future %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p8 <- myitkyina_tmax_future_85 %>%
  group_by(Year) %>%
   summarize(Mean = mean(future)
             ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = myitkyina_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "darkgreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of projected maximum temperature at Myitkyina station

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(myitkyina_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(myitkyina_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar\nComparisons of 30 years cycles under RCP 4.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(myitkyina_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text  = element_text(size = 7),
    axis.title = element_text(size = 7),
    plot.caption = element_text(face = "italic", size = 7, color = "grey60"),)
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    myitkyina_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source:ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(myitkyina_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(myitkyina_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(myitkyina_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),)

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Taunggyi station

```{r}
taunggyi_tmax <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmax$date <- as.character(taunggyi_tmax$date) ## set charactor for further analysis
taunggyi_tmax["year"] <- str_sub(taunggyi_tmax$date, 1, 4)
taunggyi_tmax["month"] <- str_sub(taunggyi_tmax$date, 5, 6)
taunggyi_tmax["day"] <- str_sub(taunggyi_tmax$date, 7, 8)
taunggyi_tmax["Date"] <- make_date(taunggyi_tmax$year, taunggyi_tmax$month, taunggyi_tmax$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmax <- taunggyi_tmax$Tmax[(which(taunggyi_tmax$date == "19831101")):(which(taunggyi_tmax$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmax)
names(miss_nd_1984) <- c("Date", "Tmax")

taunggyi_tmax <- taunggyi_tmax[, c(1, 6, 2)]
taunggyi_tmax <- taunggyi_tmax %>%
  drop_na() %>%
  bind_rows(miss_nd_1984)

taunggyi_tmax$date <- ymd(taunggyi_tmax$Date)

### RCP 4.5

taunggyi_tmax_ens <- all_tmax_ens %>% filter(States == 16 & RCP == 45)

taunggyi_tmax_45_1 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(taunggyi_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_45_2 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(taunggyi_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_45_3 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(taunggyi_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

# taunggyi_tmax_45_1;taunggyi_tmax_45_2;taunggyi_tmax_45_3
taunggyi_tmax_future <- bind_rows(
  taunggyi_tmax_45_1, 
  taunggyi_tmax_45_2, 
  taunggyi_tmax_45_3)
taunggyi_tmax_future <- taunggyi_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5

taunggyi_tmax_ens_85 <- all_tmax_ens %>% filter(States == 16 & RCP == 85)

taunggyi_tmax_85_1 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(taunggyi_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_85_2 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(taunggyi_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
taunggyi_tmax_85_3 <- taunggyi_tmax %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(taunggyi_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )

taunggyi_tmax_future_85 <- bind_rows(
  taunggyi_tmax_85_1, 
  taunggyi_tmax_85_2, 
  taunggyi_tmax_85_3)
taunggyi_tmax_future_85 <- taunggyi_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()


```

#### Daily

```{r}
### RCP 4.5
p1 <- taunggyi_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

### RCP 8.5
p2 <- taunggyi_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- taunggyi_tmax_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

### RCP 8.5
p4 <- taunggyi_tmax_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
taunggyi_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Taunggyi station, Southern Shan State, Myanmar<br><br>")

taunggyi_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Taunggyi station, Southern Shan State, Myanmar<br><br>")
``` 

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- taunggyi_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

### RCP 8.5
p6 <- taunggyi_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
taunggyi_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Maximum Temperature (RCP 4.5) at Taunggyi station, Southern Shan State, Myanmar<br><br>")

taunggyi_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    MMean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Maximum Temperature (RCP 8.5) at Taunggyi station, Southern Shan State, Myanmar<br><br>")
``` 

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- taunggyi_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = taunggyi_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

### RCP 8.5
p8 <- taunggyi_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = taunggyi_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    plot.title = element_text(family = "Pyidaungsu", face = "bold", hjust = 0.5, size = 12),
    plot.caption = element_text(family = "Pyidaungsu", face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

p7 / p8
```

#### Climate Change Scenario (Mean Shift from Baseline)

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(taunggyi_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(taunggyi_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(taunggyi_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(taunggyi_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(taunggyi_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmax_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  # facet_wrap(~Model, ncol = 4) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    plot.caption = element_text(size = 7, color = "grey60"),
    axis.text  = element_text(size = 7),
    strip.text = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    taunggyi_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(taunggyi_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  #facet_wrap(~Model, ncol = 4) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        plot.caption = element_text(size = 7, color = "grey60"),
        axis.text  = element_text(size = 7),
        strip.text = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature
### Observed Data - Hakha station

```{r}
hakha_tmin <- vroom::vroom("data/Area-2/Hakha/clean_hakha_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
## set charactor for further analysis
hakha_tmin$date <- as.character(hakha_tmin$date)
hakha_tmin["year"] <- str_sub(hakha_tmin$date, 1, 4)
hakha_tmin["month"] <- str_sub(hakha_tmin$date, 5, 6)
hakha_tmin["day"] <- str_sub(hakha_tmin$date, 7, 8)
hakha_tmin["Date"] <- make_date(
  hakha_tmin$year,
  hakha_tmin$month,
  hakha_tmin$day
)

## August, September, October, November 1991 missing
miss_ason_date <- seq.Date(ymd("1991-08-01"), ymd("1991-11-30"), "days")
miss_ason_tmin <- hakha_tmin$Tmin[which(hakha_tmin$Date == as.Date("1990-08-01")):(which(hakha_tmin$Date == as.Date("1990-11-30")))]
miss_ason_1991 <- bind_cols(miss_ason_date, miss_ason_tmin)
names(miss_ason_1991) <- c("Date", "Tmin")

hakha_tmin <- hakha_tmin[, c(1, 6, 2)]
hakha_tmin <- hakha_tmin %>%
  drop_na() %>%
  bind_rows(miss_ason_1991) %>%
  mutate(
    Tmin = Hmisc::impute(Tmin, mean)
  ) %>% 
  arrange(Date)
### subset only 20 years
hakha_tmin <- hakha_tmin[730:nrow(hakha_tmin), ]
hakha_tmin["Date"] <- ymd(hakha_tmin$Date)
hakha_tmin$date <- ymd(hakha_tmin$Date)


### RCP 4.5

hakha_tmin_ens <- all_tmin_ens %>% filter(States == 4 & RCP == 45)

hakha_tmin_45_1 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_2 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_3 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_45_4 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_tmin_future <- bind_rows(
  hakha_tmin_45_1,
  hakha_tmin_45_2,
  hakha_tmin_45_3,
  hakha_tmin_45_4
)
hakha_tmin_future <- hakha_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5

hakha_tmin_ens_85 <- all_tmin_ens %>% filter(States == 4 & RCP == 85)

hakha_tmin_85_1 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_2 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_3 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
hakha_tmin_85_4 <- hakha_tmin %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_tmin_future_85 <- bind_rows(
  hakha_tmin_85_1,
  hakha_tmin_85_2,
  hakha_tmin_85_3,
  hakha_tmin_85_4
)
hakha_tmin_future_85 <- hakha_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily 

```{r}
### RCP 4.5
p1 <- hakha_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon")+
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

### RCP 8.5
p2 <- hakha_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon")+
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7),
    axis.text.x = element_text(angle = 45)
  )

p1 / p2

```

#### Monthly

```{r}
### RCP 4.5
p3 <- hakha_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Month) %>% 
              summarize(Obmean = mean(Tmin.x)), aes(x = Month, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )

p4 <- hakha_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Month = month(date)) %>% 
              group_by(Month) %>% 
              summarize(Obmean = mean(Tmin.x)), aes(x = Month, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )
p3 / p4
```

#### Summary Table by Month

```{r}
hakha_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    MMean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Hakha station, Chin State, Myanmar")

hakha_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Hakha station, Chin State, Myanmar")

```


#### Annual - Departure

```{r}
### RCP 4.5
p5 <- hakha_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )

p6 <- hakha_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )
p5 / p6
```

#### Summary Table by Year

```{r}
hakha_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 4.5) at Hakha station, Chin State, Myanmar")

hakha_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 8.5) at Hakha station, Chin State, Myanmar")

```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- hakha_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Year) %>% 
              summarize(Obmean = mean(Tmin.x)), aes(x = Year, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )

p8 <- hakha_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = hakha_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Year) %>% 
              summarize(Obmean = mean(Tmin.x)), aes(x = Year, y = Obmean), color = "maroon") + 
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  scale_x_discrete(limits= seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold")
  )
p7 / p8
```

#### Climate Change Scenario (Mean Shift from Baseline) of projected minimum temperature at Hakha station, Chin State, Myanmar

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(hakha_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(hakha_tmin$Tmin) -0.2, 2)), 
           y = 0.03, 
           label = paste(round(mean(hakha_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(hakha_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(hakha_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(hakha_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(hakha_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar, \nComparisons of 20 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = hakha_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(hakha_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(hakha_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_2$future) -0.2,  2),
    y = 0.03,
    label = paste(round(mean(hakha_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(hakha_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =hakha_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  
    geom_density(
    data =hakha_tmin_45_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(hakha_tmin_45_4$future), 
    color = "steelblue", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_45_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmin_45_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_45_4$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmin_45_4$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    hakha_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(hakha_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(hakha_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(hakha_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift to Right from Baseline (1991-2010) at Hakha station, Chin State, Myanmar, \nComparisons of 20 years cycles under RCP 8.5 (Ensemble Approach)",
    caption = "ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = hakha_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(hakha_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(min(hakha_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = hakha_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(max(hakha_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(min(hakha_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =hakha_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(hakha_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(hakha_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
    geom_density(
    data =hakha_tmin_85_4, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "lightsteelblue", 
    color = "steelblue", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(hakha_tmin_85_4$future), 
    color = "steelblue", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(mean(hakha_tmin_85_4$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(max(hakha_tmin_85_4$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(hakha_tmin_85_4$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(min(hakha_tmin_85_4$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Myitkyina station

```{r}
myitkyina_tmin <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
myitkyina_tmin$date <- as.character(myitkyina_tmin$date) ## set charactor for further analysis
myitkyina_tmin["year"] <- str_sub(myitkyina_tmin$date, 1, 4)
myitkyina_tmin["month"] <- str_sub(myitkyina_tmin$date, 5, 6)
myitkyina_tmin["day"] <- str_sub(myitkyina_tmin$date, 7, 8)
myitkyina_tmin["Date"] <- make_date(myitkyina_tmin$year, myitkyina_tmin$month, myitkyina_tmin$day)
## September18-30 1988 missing
miss_s_date <- seq.Date(as.Date("1988-09-18"), as.Date("1988-09-30"), "days")
miss_s_tmin <- myitkyina_tmin$Tmin[(2818 - 365):(2830 - 365)]
miss_s_1988 <- cbind.data.frame(miss_s_date, miss_s_tmin)
names(miss_s_1988) <- c("Date", "Tmin")

myitkyina_tmin <- myitkyina_tmin[, c(1, 6, 2)]
myitkyina_tmin <- myitkyina_tmin %>%
  drop_na() %>%
  bind_rows(miss_s_1988)

myitkyina_tmin$date <- ymd(myitkyina_tmin$date)

### RCP 4.5
myitkyina_tmin_ens <- all_tmin_ens %>% filter(States == 5 & RCP == 45)

myitkyina_tmin_45_1 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(myitkyina_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_45_2 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(myitkyina_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_45_3 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(myitkyina_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_tmin_future <- bind_rows(
  myitkyina_tmin_45_1, 
  myitkyina_tmin_45_2, 
  myitkyina_tmin_45_3)
myitkyina_tmin_future <- myitkyina_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5
myitkyina_tmin_ens_85 <- all_tmin_ens %>% filter(States == 5 & RCP == 85)

myitkyina_tmin_85_1 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(myitkyina_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_85_2 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(myitkyina_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
myitkyina_tmin_85_3 <- myitkyina_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(myitkyina_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_tmin_future_85 <- bind_rows(
  myitkyina_tmin_85_1, 
  myitkyina_tmin_85_2, 
  myitkyina_tmin_85_3)
myitkyina_tmin_future_85 <- myitkyina_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- myitkyina_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )

### RCP 8.5
p2 <- myitkyina_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 360)
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- myitkyina_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "red") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p4 <- myitkyina_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "red") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
myitkyina_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Myitkyina station, Kachin State, Myanmar")

myitkyina_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Myitkyina station, Kachin State, Myanmar")

```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- myitkyina_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p6 <- myitkyina_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
myitkyina_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 4.5) at Myitkyina station, Kachin State, Myanmar")

myitkyina_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 8.5) at Myitkyina station, Kachin State, Myanmar")

```

#### Annual - Departure

```{r}
### RCP 4.5
p7 <- myitkyina_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(data = myitkyina_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p8 <- myitkyina_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.5) +
  geom_line(data = myitkyina_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 70) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 45, 0, 0, "pt"),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.background = element_rect(fill = "lightyellow", color = "orange"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of minimum temperature at Myitkyina station, Kachin State, Myanmar

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(myitkyina_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(myitkyina_tmin$Tmin) -0.2, 2)), 
           y = 0.06, 
           label = paste(round(mean(myitkyina_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(myitkyina_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(myitkyina_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(myitkyina_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(myitkyina_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(myitkyina_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(myitkyina_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_2$future) -0.2,  2),
    y = 0.06,
    label = paste(round(mean(myitkyina_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(myitkyina_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(myitkyina_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(myitkyina_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =myitkyina_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
   theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    myitkyina_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(myitkyina_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(myitkyina_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(myitkyina_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Myitkyina station, Kachin State, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = myitkyina_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(myitkyina_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(myitkyina_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = myitkyina_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(myitkyina_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(myitkyina_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =myitkyina_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(myitkyina_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(myitkyina_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(myitkyina_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(myitkyina_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(myitkyina_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Taunggyi Station

```{r}
taunggyi_tmin <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
taunggyi_tmin$date <- as.character(taunggyi_tmin$date) ## set charactor for further analysis
taunggyi_tmin["year"] <- str_sub(taunggyi_tmin$date, 1, 4)
taunggyi_tmin["month"] <- str_sub(taunggyi_tmin$date, 5, 6)
taunggyi_tmin["day"] <- str_sub(taunggyi_tmin$date, 7, 8)
taunggyi_tmin["Date"] <- make_date(taunggyi_tmin$year, taunggyi_tmin$month, taunggyi_tmin$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_tmin <- taunggyi_tmin$Tmin[(which(taunggyi_tmin$date == "19831101")):(which(taunggyi_tmin$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_tmin)
names(miss_nd_1984) <- c("Date", "Tmin")

taunggyi_tmin <- taunggyi_tmin[, c(1, 6, 2)]
taunggyi_tmin <- taunggyi_tmin %>%
  
  bind_rows(miss_nd_1984) %>%
  mutate(
  Tmin = Hmisc::impute(Tmin, mean)
  )

taunggyi_tmin$date <- ymd(taunggyi_tmin$Date)

### RCP 4.5
taunggyi_tmin_ens <- all_tmin_ens %>% filter(States == 16 & RCP == 45)

taunggyi_tmin_45_1 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(taunggyi_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_45_2 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(taunggyi_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_45_3 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(taunggyi_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# taunggyi_tmin_45_1;taunggyi_tmin_45_2;taunggyi_tmin_45_3
taunggyi_tmin_future <- bind_rows(
  taunggyi_tmin_45_1, 
  taunggyi_tmin_45_2, 
  taunggyi_tmin_45_3)
taunggyi_tmin_future <- taunggyi_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5
taunggyi_tmin_ens_85 <- all_tmin_ens %>% filter(States == 16, RCP == 85)

taunggyi_tmin_85_1 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 1
  ) %>%
  left_join(taunggyi_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_85_2 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 2
  ) %>%
  left_join(taunggyi_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
taunggyi_tmin_85_3 <- taunggyi_tmin %>%
  mutate(
    Date = Date + 10957 * 3
  ) %>%
  left_join(taunggyi_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# taunggyi_tmin_45_1;taunggyi_tmin_45_2;taunggyi_tmin_45_3
taunggyi_tmin_future_85 <- bind_rows(
  taunggyi_tmin_85_1, 
  taunggyi_tmin_85_2, 
  taunggyi_tmin_85_3)
taunggyi_tmin_future_85 <- taunggyi_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```


#### Daily

```{r}
p1 <- taunggyi_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 360)
  )

### RCP 8.5
p2 <- taunggyi_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 360)
  )

p1 / p2
```

#### Monthly

```{r}

### RCP 4.5
p3 <- taunggyi_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 4.5
p4 <- taunggyi_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
taunggyi_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Taunggyi station, Southern Shan State, Myanmar")

taunggyi_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Taunggyi station, Southern Shan State, Myanmar")

```

#### Annual - Departure

```{r}

### RCP 4.5
p5 <- taunggyi_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 4.5
p6 <- taunggyi_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
taunggyi_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 4.5) at Taunggyi station, Southern Shan State, Myanmar")

taunggyi_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Yearly Minimum Temperature (RCP 8.5) at Taunggyi station, Southern Shan State, Myanmar")

```

#### Annual - Time Series

```{r}

### RCP 4.5
p7 <- taunggyi_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
           ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize( Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 4.5
p8 <- taunggyi_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
           ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = taunggyi_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize( Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(family = "Pyidaungsu", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p7 / p8
```

#### Climate Change Scenario (Mean Shift from the Baseline) of minimum temperature at Taunggyi Station, Southern Shan State, Myanmar

```{r fig.width=10, fig.height=8}
p1 <- ggplot(taunggyi_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(taunggyi_tmin$Tmin) -0.2, 2)), 
           y = 0.10, 
           label = paste(round(mean(taunggyi_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(taunggyi_tmin$Tmin) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(taunggyi_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmin$Tmin) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(taunggyi_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"),
    caption = "Source:ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(taunggyi_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(taunggyi_tmin_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(taunggyi_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(taunggyi_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(taunggyi_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(taunggyi_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(taunggyi_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =taunggyi_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    taunggyi_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(taunggyi_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(taunggyi_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(taunggyi_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Taunggyi station, Southern Shan State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = taunggyi_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(taunggyi_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(taunggyi_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = taunggyi_tmin_85_2, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(taunggyi_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(taunggyi_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =taunggyi_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(taunggyi_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(taunggyi_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(taunggyi_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(taunggyi_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(taunggyi_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation
### Observed Data

```{r}
hakha_preci <- vroom::vroom("data/Area-2/Hakha/clean_hakha_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
hakha_preci$Date  <- ymd(hakha_preci$Date)
hakha_preci$preci[32:59] <- hakha_preci$preci[which(hakha_preci$Date == "1990-02-01"):(which(hakha_preci$Date == "1990-02-28"))]
hakha_preci$preci[which(hakha_preci$Date == "1991-01-01"):(which(hakha_preci$Date == "1991-01-31"))] <- hakha_preci$preci[which(hakha_preci$Date == "1990-01-01"):(which(hakha_preci$Date == "1990-01-31"))]
# hakha_preci$date <- as.character(hakha_preci$date) ## set charactor for further analysis
# hakha_preci["year"] <- str_sub(hakha_preci$date, 1, 4)
# hakha_preci["month"] <- str_sub(hakha_preci$date, 5, 6)
# hakha_preci["day"] <- str_sub(hakha_preci$date, 7, 8)
# hakha_preci["Date"] <- make_date(hakha_preci$year, hakha_preci$month, hakha_preci$day)
# 
# ## Feb 1989 missing
# miss_feb_date <- seq.Date(ymd("1989-02-01"), ymd("1989-02-28"), "days")
# miss_feb_prec <- hakha_preci$preci[which(hakha_preci$Date == "1990-02-01"):(which(hakha_preci$Date == "1990-02-28"))]
# miss_feb_1989 <- bind_cols(miss_feb_date, miss_feb_prec)
# names(miss_feb_1989) <- c("Date", "preci")
# miss_j_date <- seq.Date(as.Date("1991-01-01"), as.Date("1991-01-31"), "days")
# miss_j_preci <- hakha_preci$preci[which(hakha_preci$Date == "1990-01-01"):(which(hakha_preci$Date == "1990-01-31"))]
# miss_j_1991 <- cbind.data.frame(miss_j_date, miss_j_preci)
# names(miss_j_1991) <- c("Date", "preci")
# missing_2months <- bind_rows(miss_feb_1989, miss_j_1991)
# hakha_preci <- hakha_preci[, c( 6, 2)]
hakha_preci <- hakha_preci %>%
   #left_join(missing_2months, by = c("Date", "preci")) %>% 
  #arrange(Date) %>%
  mutate(
    preci = Hmisc::impute(preci, mean)
  )

hakha_preci <- hakha_preci[731:nrow(hakha_preci), ]
hakha_preci <- hakha_preci[, c(1, 2)]
hakha_preci["Date"] <- ymd(hakha_preci$Date)
hakha_preci$date <- hakha_preci$Date

### RCP 4.5
hakha_preci_ens <- all_preci_ens %>% filter(States == 4 & RCP == 45)

hakha_preci_45_1 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_2 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_3 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_45_4 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_preci_future <- bind_rows(
  hakha_preci_45_1, 
  hakha_preci_45_2, 
  hakha_preci_45_3, 
  hakha_preci_45_4)
hakha_preci_future <- hakha_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

### RCP 8.5
hakha_preci_ens_85 <- all_preci_ens %>% filter(States == 4 & RCP == 85)

hakha_preci_85_1 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 1
  ) %>%
  left_join(hakha_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_85_2 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 2
  ) %>%
  left_join(hakha_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_85_3 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 3
  ) %>%
  left_join(hakha_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
hakha_preci_85_4 <- hakha_preci %>%
  mutate(
    Date = Date + 7305 * 4
  ) %>%
  left_join(hakha_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# hakha_tmin_45_1;hakha_tmin_45_2;hakha_tmin_45_3
hakha_preci_future_85 <- bind_rows(
  hakha_preci_85_1, 
  hakha_preci_85_2, 
  hakha_preci_85_3, 
  hakha_preci_85_4)
hakha_preci_future_85 <- hakha_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- hakha_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7)
  )

### RCP 4.5
p2 <- hakha_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7)
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5 
p3 <- hakha_preci_future %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/80,
    Obtotal = sum(preci.x, na.rm = TRUE)/80,
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "darkred", size = 1) +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 70) +
  #scale_color_brewer(palette = "Spectral") +
  #scale_color_viridis_d(direction = 1)+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

### RCP 8.5 
p4 <- hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/80,
    Obtotal = sum(preci.x, na.rm = TRUE)/80,
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "darkred", size = 1) +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 70) +
  #scale_color_brewer(palette = "Spectral") +
  #scale_color_viridis_d(direction = 1)+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

p3 / p4
```

#### Summary Table by Month

```{r}
hakha_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/80/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/80,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar") 

hakha_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/80/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/80,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/80/12,
    PTotal = sum(future, na.rm = TRUE)/80
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Hakha Station, Chin State, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5 
p5 <- hakha_preci_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "darkred", size = 1) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  scale_color_hue(l = 70) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

### RCP 8.5 
p6 <- hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "darkred", size = 1) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  scale_color_hue(l = 70) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

p5 / p6
```

#### Summary Table by Year

```{r}
hakha_preci_future %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Hakha Station**, Chin State, Myanmar") 

hakha_preci_future_85 %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Hakha Station, Chin State, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5 
p7 <- hakha_preci_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = hakha_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/ 4), color = "darkred", size = 1) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  scale_color_hue(l = 70) +
  #scale_color_brewer(palette = "Spectral") +
  #scale_color_viridis_d(direction = 1)+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

### RCP 8.5 
p8 <- hakha_preci_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = hakha_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal / 4), color = "darkred", size = 1) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  scale_color_hue(l = 70) +
  #scale_color_brewer(palette = "Spectral") +
  #scale_color_viridis_d(direction = 1)+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Precipitation, Hakha, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )

p7 / p8
```

### Observed Data - Myitkyina station

```{r}
myitkyina_preci <- vroom::vroom("data/Area-2/Myitkyina/clean_Myitkyina_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
myitkyina_preci["Date"] <- ymd(myitkyina_preci$Date)
myitkyina_preci$date <- myitkyina_preci$Date

myitkyina_preci_ens <- all_preci_ens %>% filter(States == 5 & RCP == 45)
myitkyina_preci_ens_85 <- all_preci_ens %>% filter(States == 5 & RCP == 85)

# RCP 4.5

myitkyina_preci_45_1 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(myitkyina_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_45_2 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(myitkyina_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_45_3 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(myitkyina_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
### myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_preci_future <- bind_rows(
  myitkyina_preci_45_1, 
  myitkyina_preci_45_2, 
  myitkyina_preci_45_3)
myitkyina_preci_future <- myitkyina_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

# RCP 8.5

myitkyina_preci_85_1 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(myitkyina_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_85_2 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(myitkyina_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
myitkyina_preci_85_3 <- myitkyina_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(myitkyina_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
### myitkyina_tmin_45_1;myitkyina_tmin_45_2;myitkyina_tmin_45_3
myitkyina_preci_future_85 <- bind_rows(
  myitkyina_preci_85_1, 
  myitkyina_preci_85_2, 
  myitkyina_preci_85_3)
myitkyina_preci_future_85 <- myitkyina_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- myitkyina_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p2 <- myitkyina_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p1 / p2
```

#### Monthly

```{r}

### RCP 4.5
p3 <- myitkyina_preci_future %>%
  group_by(Month) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90
      ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Month, y = Obtotal), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- myitkyina_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90
      ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Month, y = Obtotal), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p3 / p4
```

#### Summary Table by Month

```{r}
myitkyina_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Myitkyina Station**, Kachin State, Myanmar") 

myitkyina_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Myitkyina Station, Kachin State, Myanmar") 
```

#### Annual - Departure

```{r}

### RCP 4.5
p5 <- myitkyina_preci_future %>%
  group_by(Year) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE)
      ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Year, y = Obtotal), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- myitkyina_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE)
      ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(aes(x = Year, y = Obtotal), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p5 / p6
```


#### Summary Table by Year

```{r}
myitkyina_preci_future %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 4.5 by 2100 at Myitkyina Station, Kachin State, Myanmar") 

myitkyina_preci_future_85 %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 8.5 by 2100 at Myitkyina Station, Kachin State, Myanmar") 
```


#### Annual - Time Series

```{r}

### RCP 4.5
p7 <- myitkyina_preci_future %>%
  group_by(Year) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)
      ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(data = myitkyina_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- myitkyina_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Pmax = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE)
      ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  # geom_smooth(method = "lm", se =FALSE, lty = 'dashed') +
  geom_line(data = myitkyina_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "darkblue") +

 # geom_col(aes(x = Month, y = Obtotal/360), fill = "darkblue", alpha = 0.5) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Myitkyina, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p7 / p8
```

### Observed Data - Taunggyi Station

```{r}
taunggyi_preci <- vroom::vroom("data/Area-2/Taunggyi/clean_Taunggyi_rainfall.csv",
  delim = " ", col_names = c("date", "preci"), na = "-999.0", show_col_types = FALSE
)
taunggyi_preci$date <- as.character(taunggyi_preci$date) ## set charactor for further analysis
taunggyi_preci["year"] <- str_sub(taunggyi_preci$date, 1, 4)
taunggyi_preci["month"] <- str_sub(taunggyi_preci$date, 5, 6)
taunggyi_preci["day"] <- str_sub(taunggyi_preci$date, 7, 8)
taunggyi_preci["Date"] <- make_date(taunggyi_preci$year, taunggyi_preci$month, taunggyi_preci$day)
## November and December 1984 is missing
miss_nd_date <- seq.Date(as.Date("1984-11-01"), as.Date("1984-12-31"), "days")
miss_nd_preci <- taunggyi_preci$preci[(which(taunggyi_preci$date == "19831101")):(which(taunggyi_preci$date == "19831231"))]
miss_nd_1984 <- cbind.data.frame(miss_nd_date, miss_nd_preci)
names(miss_nd_1984) <- c("Date", "preci")

taunggyi_preci <- taunggyi_preci[, c(1, 6, 2)]
taunggyi_preci <- taunggyi_preci %>%
  
  bind_rows(miss_nd_1984) %>%
  mutate(
  preci = Hmisc::impute(preci, mean)
  )

taunggyi_preci$date <- ymd(taunggyi_preci$Date)

taunggyi_preci_ens <- all_preci_ens %>% filter(States == 16 & RCP == 45)
taunggyi_preci_ens_85 <- all_preci_ens %>% filter(States == 16 & RCP == 85)

### RCP 4.5
taunggyi_preci_45_1 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(taunggyi_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_45_2 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(taunggyi_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_45_3 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(taunggyi_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
taunggyi_preci_future <- bind_rows(
  taunggyi_preci_45_1, 
  taunggyi_preci_45_2, 
  taunggyi_preci_45_3)
taunggyi_preci_future <- taunggyi_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
taunggyi_preci_85_1 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(taunggyi_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_85_2 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(taunggyi_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
taunggyi_preci_85_3 <- taunggyi_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(taunggyi_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
taunggyi_preci_future_85 <- bind_rows(
  taunggyi_preci_85_1, 
  taunggyi_preci_85_2, 
  taunggyi_preci_85_3)
taunggyi_preci_future_85 <- taunggyi_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- taunggyi_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 3) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  
  )

### RCP 8.5
p2 <- taunggyi_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 3) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- taunggyi_preci_future %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Month, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- taunggyi_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Month, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
taunggyi_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at Taunggyi Station, Southern Shan State, Myanmar") 

taunggyi_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Taunggyi Station, Southern Shan State, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- taunggyi_preci_future %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Year, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- taunggyi_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Year, y = Obtotal), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, 10)) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Year

```{r}
taunggyi_preci_future %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at Taunggyi Station, Southern Shan State, Myanmar") 

taunggyi_preci_future_85 %>%
  filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Taunggyi Station, Southern Shan State, Myanmar") 
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- taunggyi_preci_future %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  geom_line(data = taunggyi_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- taunggyi_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 3) +
  geom_line(data = taunggyi_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, 10)) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Taunggyi, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "Pyidaungsu", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title =  element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    #axis.text.x = element_blank()
  )
p7 / p8
```


## Dry Zone Region
### Mean Temperature
### Observed Data - Magwe station

```{r}
magwe_tmean <- vroom::vroom("data/Area-3/Magway/clean_Magway_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

magwe_tmean["Date"] <- ymd(magwe_tmean$Date)
magwe_tmean$date <- magwe_tmean$Date
magwe_tmean <- magwe_tmean %>% 
  select(date, Date, Tmean)


magwe_tmean <- magwe_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )

### RCP 4.5
magwe_tmean_ens <- all_tmean_ens %>% filter(States == 8 & RCP == 45)

magwe_tmean_45_1 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_45_2 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_45_3 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# magwe_tmean_45_1
# magwe_tmean_45_2
# magwe_tmean_45_3
magwe_tmean_future <- rbind.data.frame(
  magwe_tmean_45_1, 
  magwe_tmean_45_2, 
  magwe_tmean_45_3
  )
magwe_tmean_future <- magwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 4.5
magwe_tmean_ens_85 <- all_tmean_ens %>% filter(States == 8 & RCP == 85)

magwe_tmean_85_1 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_85_2 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_85_3 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# magwe_tmean_45_1
# magwe_tmean_45_2
# magwe_tmean_45_3
magwe_tmean_future_85 <- rbind.data.frame(
  magwe_tmean_85_1, 
  magwe_tmean_85_2, 
  magwe_tmean_85_3
  )
magwe_tmean_future_85 <- magwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- magwe_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.size = unit(rel(2), "mm"),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
### RCP 8.5
p2 <- magwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.size = unit(rel(2), "mm"),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- magwe_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = month.abb) +
  theme_minimal() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

### RCP 8.5
p4 <- magwe_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

p3 / p4
```

#### Summary Table by Month

```{r}
magwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar<br><br>" )

magwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Magwe Station, Magwe Region, Myanmar<br><br>" )
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- magwe_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  theme_minimal() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

### RCP 8.5
p6 <- magwe_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

p5 / p6
```

#### Summary Table by Year

```{r}
magwe_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar<br><br>" )

magwe_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Magwe Station, Magwe Region, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- magwe_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = magwe_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  theme_minimal() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

### RCP 8.5
p8 <- magwe_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )

p7 / p8
```
#### Climate Change Scenario (Mean Shift from baseline) of projected Mean Temperature at Magwe Station, Magwe Region

```{r Fig1-14, fig.width=10, fig.height=8, fig.cap= "Density plot of mean temperature at Magwe Station, Magwe Region, Myanmar"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(magwe_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmean$Tmean) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(magwe_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmean$Tmean) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(magwe_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmean$Tmean) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(magwe_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmean_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(magwe_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    magwe_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmean_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmean_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```


### Observed Data - Mandalay station

```{r}
mandalay_tmean <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

mandalay_tmean["Date"] <- ymd(mandalay_tmean$Date)
mandalay_tmean$date <- mandalay_tmean$Date
mandalay_tmean <- mandalay_tmean %>% 
  select(date, Date, Tmean)

naCount <- function(df) {
  df %>%
    is.na() %>% 
    colSums()
}
mandalay_tmean <- mandalay_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )


### RCP 4.5
mandalay_tmean_ens <- all_tmean_ens %>% filter(States == 9 & RCP == 45)

mandalay_tmean_45_1 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_45_2 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_45_3 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# mandalay_tmean_45_1
# mandalay_tmean_45_2
# mandalay_tmean_45_3
mandalay_tmean_future <- rbind.data.frame(
  mandalay_tmean_45_1, 
  mandalay_tmean_45_2, 
  mandalay_tmean_45_3)
mandalay_tmean_future <- mandalay_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
mandalay_tmean_ens_85 <- all_tmean_ens %>% filter(States == 9 & RCP == 85)

mandalay_tmean_85_1 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_85_2 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_85_3 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# mandalay_tmean_45_1
# mandalay_tmean_45_2
# mandalay_tmean_45_3
mandalay_tmean_future_85 <- rbind.data.frame(
  mandalay_tmean_85_1, 
  mandalay_tmean_85_2, 
  mandalay_tmean_85_3)
mandalay_tmean_future_85 <- mandalay_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- mandalay_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = rel(0.7)),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )

### RCP 4.5
p2 <- mandalay_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = rel(0.7)),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- mandalay_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )
### RCP 8.5
p4 <- mandalay_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )

p3 / p4
```

#### Summary Table by Month

```{r}
mandalay_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar<br><br>" )

mandalay_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Mandalay Station, Mandalay Region, Myanmar<br><br>" )
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- mandalay_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )
### RCP 8.5
p6 <- mandalay_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )

p5 / p6
```

#### Summary Table by Year

```{r}
mandalay_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar<br><br>" )

mandalay_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Mandalay Station, Mandalay Region, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
### RCP 4.5
p5 <- mandalay_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )
### RCP 8.5
p6 <- mandalay_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme_minimal() +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )

p5 / p6
```

#### Climate Change Scenario (Mean Shift from Baseline) of Mean Temperature at Mandalay station, Mandalay Region, Myanmar

```{r Fig1-73, fig.width=10, fig.height=8, fig.regina=2, fig.cap= "Density plot of mean temperature at Mandalay Station, Mandalay Region, Myanmar"}
####  Density Plot for mandalay station

### RCP 4.5
p1 <- ggplot(mandalay_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmean$Tmean) -0.2, 2)), 
           y = 0.04, 
           label = paste(round(mean(mandalay_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift from Baseline (1981-2010) at Mandalay Station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_1$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_2$future) -0.2,  2),
    y = 0.04,
    label = paste(round(mean(mandalay_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    mandalay_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift to Right from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(mandalay_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(mandalay_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmean_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(mandalay_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(mandalay_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmean_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(mean(mandalay_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Monywa Station

```{r}
monywa_tmean <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

monywa_tmean["Date"] <- ymd(monywa_tmean$Date)
monywa_tmean$date <- monywa_tmean$Date
monywa_tmean <- monywa_tmean %>% 
  select(date, Date, Tmean)

monywa_tmean <- monywa_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )

### RCP 4.5
monywa_tmean_ens <- all_tmean_ens %>% filter(States == 13 & RCP == 45)

monywa_tmean_45_1 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_45_2 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_45_3 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmean_ens, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# monywa_tmean_45_1
# monywa_tmean_45_2
# monywa_tmean_45_3
monywa_tmean_future <- rbind.data.frame(
  monywa_tmean_45_1, 
  monywa_tmean_45_2, 
  monywa_tmean_45_3)
monywa_tmean_future <- monywa_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct

### RCP 8.5
monywa_tmean_ens_85 <- all_tmean_ens %>% filter(States == 13 & RCP == 85)

monywa_tmean_85_1 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_85_2 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_85_3 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmean_ens_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# monywa_tmean_45_1
# monywa_tmean_45_2
# monywa_tmean_45_3
monywa_tmean_future_85 <- rbind.data.frame(
  monywa_tmean_85_1, 
  monywa_tmean_85_2, 
  monywa_tmean_85_3)
monywa_tmean_future_85 <- monywa_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct

```

#### Daily

```{r}
### RCP 4.5
p1 <- monywa_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan")
    
  )

### RCP 8.5
p2 <- monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan")
    
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- monywa_tmean_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- monywa_tmean_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
monywa_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region, Myanmar<br><br>" )

monywa_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  #filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Monywa Station, Lower Sagaing Region, Myanmar<br><br>" )
```


#### Annual - Departure

```{r}
### RCP 4.5
p5 <- monywa_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- monywa_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Month

```{r}
monywa_tmean_future  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
          Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
          M_mean = mean(Tmean.y, na.rm = TRUE),
          Mmax = max(Tmean.y, na.rm = TRUE),
          Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region, Myanmar<br><br>" )

monywa_tmean_future_85  %>% 
mutate(
    Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year) %>% 
summarize(Mean = mean(future),
          Max = max(future),
          Min = min(future),
         Obmean = mean(Tmean.x),
          Obmax = max(Tmean.x),
          Obmin = min(Tmean.x),
         M_mean = mean(Tmean.y, na.rm = TRUE),
         Mmax = max(Tmean.y, na.rm = TRUE),
         Mmin = min(Tmean.y, na.rm = TRUE)
         ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected mean temperature (RCP 8.5) at Monywa Station, Lower Sagaing Region, Myanmar<br><br>" )
```

#### Annual - Time Series

```{r}
### RCP 4.5
p5 <- monywa_tmean_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_tmean_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- monywa_tmean_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Mean Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
p5 / p6
```

#### Climate Change Scenario (Mean Shift from Baseline) of projected Mean Temperature at Monywa Station, Lower Sagaing Region, Myanmar

```{r Fig1-142, fig.width=10, fig.height=8, fig.cap="Density plot for mean temperature of Monywa station, Lower Sagaing Region, Myanmar"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(monywa_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmean$Tmean) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(monywa_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmean$Tmean) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(monywa_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmean$Tmean) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(monywa_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = monywa_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmean_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(monywa_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    monywa_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = monywa_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmean_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```

### Maximum Temperature
### Ensemble Data
### Observed Data - Magwe station

```{r}
magwe_tmax <- vroom::vroom(
  "data/Area-3/Magway/clean_Magway_maxTem.csv",
  delim = " ",
  col_names = c("Date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)
magwe_tmax$Date <- ymd(magwe_tmax$Date)
magwe_tmax$date <- magwe_tmax$Date
magwe_tmax <- magwe_tmax %>% 
  select(date, Date, Tmax)

### RCP 4.5
magwe_tmax_ens = all_tmax_ens  %>% filter(States == 8 & RCP == 45)

magwe_tmax_45_1 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_45_2 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_45_3 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# magwe_tmax_45_1;magwe_tmax_45_2;magwe_tmax_45_3
magwe_tmax_future <- rbind.data.frame(
  magwe_tmax_45_1, 
  magwe_tmax_45_2, 
  magwe_tmax_45_3)
magwe_tmax_future <- magwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
magwe_tmax_ens_85 = all_tmax_ens  %>% filter(States == 8 & RCP == 85)

magwe_tmax_85_1 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_85_2 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_85_3 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# magwe_tmax_45_1;magwe_tmax_45_2;magwe_tmax_45_3
magwe_tmax_future_85 <- rbind.data.frame(
  magwe_tmax_85_1, 
  magwe_tmax_85_2, 
  magwe_tmax_85_3)
magwe_tmax_future_85 <- magwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- magwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(t = 5),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "snow"),
    panel.grid.major = element_line(linetype = 'dotdash', size = 0.3, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.3, color = "grey85")
  )

### RCP 8.5
p2 <- magwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(t = 5),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "snow"),
    panel.grid.major = element_line(linetype = 'dotdash', size = 0.3, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.3, color = "grey85")
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- magwe_tmax_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dotted") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- magwe_tmax_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(alpha = 0.7, lty = "dotted") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

p3 / p4
```

#### Summary Table by Month

```{r}
magwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Magwe station, Magwe Region, Myanmar**<br><br>")

magwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "**Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Magwe station, Magwe Region, Myanmar**<br><br>")
``` 

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- magwe_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- magwe_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

p5 / p6
```

#### Summary Table by Year

```{r}
magwe_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 4.5) at Magwe station, Magwe Region, Myanmar")

magwe_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Maximum Temperature (RCP 8.5) at Magwe station, Magwe Region, Myanmar")
``` 

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- magwe_tmax_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dotted") +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- magwe_tmax_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dotted") +
  geom_line(data = magwe_tmax_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )

p7 / p8
```

#### Climate Change Scenario (Mean Shift from baseline ) of Maximum Temperature at Magwe Station, Magwe Region

```{r Fig1-28, fig.width=10, fig.height=8, fig.cap="Density plot of Maximum Temperature at Magwe Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(magwe_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(magwe_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(magwe_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(magwe_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(magwe_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmax_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1",
    adjust = 5,
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text  = element_text(size = 7),
    axis.title = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    magwe_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Mandalay Station

```{r}
mandalay_tmax <- vroom::vroom(
  "data/Area-3/Mandalay/clean_Mandalay_maxTem.csv",
  delim = " ",
  col_names = c("date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)


mandalay_tmax$date <- ymd(mandalay_tmax$date)

 mandalay_tmax["Date"] <- ymd(mandalay_tmax$date)
 mandalay_tmax <- mandalay_tmax %>% 
   select(date, Date, Tmax)
 
 ### RCP 4.5
 mandalay_tmax_ens = all_tmax_ens  %>% filter(States == 9 & RCP == 45)
 mandalay_tmax_45_1 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_45_2 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_45_3 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# mandalay_tmax_45_1;mandalay_tmax_45_2;mandalay_tmax_45_3
mandalay_tmax_future <- rbind.data.frame(
  mandalay_tmax_45_1, 
  mandalay_tmax_45_2, 
  mandalay_tmax_45_3)
mandalay_tmax_future <- mandalay_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

 ### RCP 8.5
 mandalay_tmax_ens_85 = all_tmax_ens  %>% filter(States == 9 & RCP == 85)
 mandalay_tmax_85_1 <- mandalay_tmax %>% 
   mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_85_2 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_85_3 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# mandalay_tmax_45_1;mandalay_tmax_45_2;mandalay_tmax_45_3
mandalay_tmax_future_85 <- rbind.data.frame(
  mandalay_tmax_85_1, 
  mandalay_tmax_85_2, 
  mandalay_tmax_85_3)
mandalay_tmax_future_85 <- mandalay_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


```

#### Daily

```{r}
# RCP 4.5
p1 <- mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = rel(0.6)),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

# RCP 8.5
p2 <- mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = rel(0.6)),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p4 <- mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Month) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
mandalay_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Mandalay station, Mandalay Region, Myanmar")

mandalay_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar")
``` 

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p6 <- mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
mandalay_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Mandalay station, Mandalay Region, Myanmar")

mandalay_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar")
``` 

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
      plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p8 <- mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future),
            Obmean = mean(Tmax.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
      plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p7 / p8
```

#### Climate Change Scenario (Mean Shift from Baseline) of projected Maximum Temperature at Mandalay Station

```{r Fig1-89, fig.width=10, fig.height=8, fig.cap="Density plots fo maximum temperature at Mandalay Station, Mandalay Region, Myanmar"}
####  Density Plot for Mandalay station

### RCP 4.5
p1 <- ggplot(mandalay_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust =5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(mandalay_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift Right from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(mandalay_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    mandalay_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(mandalay_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(mandalay_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(mandalay_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(mandalay_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Observed Data - Monywa station

```{r}
monywa_tmax <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_maxTem.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)


monywa_tmax$Date <- ymd(monywa_tmax$Date)
monywa_tmax$date <- monywa_tmax$Date
monywa_tmax <- monywa_tmax %>% 
  select(date, Date, Tmax)
monywa_tmax <- monywa_tmax %>% 
  mutate(Tmax = Hmisc::impute(Tmax, mean))

### RCP 4.5
monywa_tmax_ens = all_tmax_ens  %>% filter(States == 13 & RCP == 45)
monywa_tmax_45_1 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_45_2 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_45_3 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmax_ens, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# monywa_tmax_45_1;monywa_tmax_45_2;monywa_tmax_45_3
monywa_tmax_future <- rbind.data.frame(
  monywa_tmax_45_1, 
  monywa_tmax_45_2, 
  monywa_tmax_45_3)
monywa_tmax_future <- monywa_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


### RCP 8.5
monywa_tmax_ens_85 = all_tmax_ens  %>% filter(States == 13 & RCP == 85)
monywa_tmax_85_1 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_85_2 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_85_3 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmax_ens_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# monywa_tmax_45_1;monywa_tmax_45_2;monywa_tmax_45_3
monywa_tmax_future_85 <- rbind.data.frame(
  monywa_tmax_85_1, 
  monywa_tmax_85_2, 
  monywa_tmax_85_3)
monywa_tmax_future_85 <- monywa_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
p1 <- monywa_tmax_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 3) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p2 <- monywa_tmax_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 3) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
### RCP 8.5
p4 <- monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p3 / p4
```

#### Summary Table by Month

```{r}
monywa_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Monywa station, Lower Sagaing Region, Myanmar")

mandalay_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Monywa station, Lower Sagain Region, Myanmar")
``` 


#### Annual - Departure

```{r}
### RCP 4.5
p5 <- monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
### RCP 8.5
p6 <- monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p5 / p6
```

#### Summary Table by Year

```{r}
monywa_tmax_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Monywa station, Lower Sagaing Region, Myanmar")

mandalay_tmax_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
  filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmax.x, na.rm = TRUE),
    Obmax = max(Tmax.x, na.rm = TRUE),
    Obmin = min(Tmax.x, na.rm = TRUE),
    Mmean = mean(Tmax.y, na.rm = TRUE),
    Mmax = max(Tmax.y, na.rm = TRUE),
    Mmin = min(Tmax.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Maximum Temperature (RCP 8.5) at Monywa station, Lower Sagain Region, Myanmar")
``` 

#### Annual - Time Series

```{r}
### RCP 4.5
p5 <- monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
### RCP 8.5
p6 <- monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 3) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmax.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Maximum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p5 / p6
```

#### Climate Change Scenario (Mean Shift from Baseline) of Maximum Temperature at Monywa Station

```{r Fig1-160, fig.width=10, fig.height=8, fig.cap= "Density plot of Maximum Temperature at Monywa Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(monywa_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(monywa_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(monywa_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(monywa_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift to Right from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = monywa_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(monywa_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmax_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 11),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    monywa_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift to Right from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = monywa_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 11),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```


### Minimum Temperature
### Ensemble Data
### Observed Data - Magwe Station

```{r}
magwe_tmin <- vroom::vroom("data/Area-3/Magway/clean_Magway_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)

magwe_tmin["Date"] <- ymd(magwe_tmin$Date)

magwe_tmin <- magwe_tmin %>% 
  mutate(
    Tmin = Hmisc::impute(Tmin, "random")
  )
magwe_tmin$date <- magwe_tmin$Date

### RCP 4.5
magwe_tmin_ens = all_tmin_ens %>% filter(States == 8 & RCP == 45)
magwe_tmin_45_1 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_45_2 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_45_3 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_tmin_future <- rbind.data.frame(
  magwe_tmin_45_1, 
  magwe_tmin_45_2, 
  magwe_tmin_45_3)
magwe_tmin_future <- magwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
magwe_tmin_ens_85 = all_tmin_ens %>% filter(States == 8 & RCP == 85)
magwe_tmin_85_1 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_85_2 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_85_3 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_tmin_future_85 <- rbind.data.frame(
  magwe_tmin_85_1, 
  magwe_tmin_85_2, 
  magwe_tmin_85_3)
magwe_tmin_future_85 <- magwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- magwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Pmax = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.5, lty = "dotted") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon")  +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )


### RCP 8.5
p2 <- magwe_tmin_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Pmax = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(alpha = 0.5, lty = "dotted") +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon")  +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- magwe_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- magwe_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
magwe_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Magwe station, Magwe Region, Myanmar")

magwe_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Magwe station, Magwe Region, Myanmar")

```

#### Annal - Departure

```{r}
### RCP 4.5
p5 <- magwe_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- magwe_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Year

```{r}
magwe_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Magwe station, Magwe Region, Myanmar")

magwe_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Magwe station, Magwe Region, Myanmar")

```

#### Annal - Time Series

```{r}
### RCP 4.5
p7 <- magwe_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- magwe_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = "dashed") +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )
p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of minimum temperature at Magwe station, Magwe Region, Myanmar

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(magwe_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmin$Tmin) -0.2, 2)), 
           y = 0.06, 
           label = paste(round(mean(magwe_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(magwe_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(magwe_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Magwe station, Magwe Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_2$future) -0.2,  2),
    y = 0.06,
    label = paste(round(mean(magwe_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
   theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    magwe_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Magwe station, Magwe Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = magwe_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(magwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(magwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(magwe_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )

p1 + p2 + plot_layout(ncol = 1)
```



### Observed Data - Mandalay Station

```{r}
mandalay_tmin <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)

mandalay_tmin["Date"] <- ymd(mandalay_tmin$Date)
mandalay_tmin$date <- mandalay_tmin$Date

### RCP 4.5

mandalay_tmin_ens <- all_tmin_ens %>% filter(States == 9 & RCP == 45)

mandalay_tmin_45_1 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_45_2 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_45_3 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# mandalay_tmin_45_1;mandalay_tmin_45_2;mandalay_tmin_45_3
mandalay_tmin_future <- rbind.data.frame(
  mandalay_tmin_45_1, 
  mandalay_tmin_45_2, 
  mandalay_tmin_45_3)
mandalay_tmin_future <- mandalay_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


### RCP 8.5

mandalay_tmin_ens_85 <- all_tmin_ens %>% filter(States == 9 & RCP == 85)

mandalay_tmin_85_1 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_85_2 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_85_3 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# mandalay_tmin_45_1;mandalay_tmin_45_2;mandalay_tmin_45_3
mandalay_tmin_future_85 <- rbind.data.frame(
  mandalay_tmin_85_1, 
  mandalay_tmin_85_2, 
  mandalay_tmin_85_3)
mandalay_tmin_future_85 <- mandalay_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


```


#### Daily

```{r}
### RCP 4.5
p1 <- mandalay_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p2 <- mandalay_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.background = element_rect(fill = "lightyellow"),
    panel.background = element_rect(fill = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p1 / p2

```

#### Monthly

```{r}
### RCP 4.5
p3 <- mandalay_tmin_future %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p4 <- mandalay_tmin_future_85 %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p3 / p4
```

#### Summary Table by Month

```{r}
mandalay_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Mandalay station, Mandalay Region, Myanmar")

mandalay_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar")

```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- mandalay_tmin_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p6 <- mandalay_tmin_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p5 / p6
```

#### Summary Table by Year

```{r}
mandalay_tmin_future %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Mandalay station, Mandalay Region, Myanmar")

mandalay_tmin_future_85 %>%
mutate(
  Year = year(Date),
    Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar")

```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- mandalay_tmin_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

### RCP 8.5
p8 <- mandalay_tmin_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of minimum temperature at Mandalay station, Mandalay Region, Myanmar

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(mandalay_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmin$Tmin) -0.2, 2)), 
           y = 0.06, 
           label = paste(round(mean(mandalay_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_2$future) -0.2,  2),
    y = 0.06,
    label = paste(round(mean(mandalay_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
   theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    mandalay_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = mandalay_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(mandalay_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(mandalay_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(mandalay_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(mandalay_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(mandalay_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )

p1 + p2 + plot_layout(ncol = 1)
```





### Observed Data - Monywa station

```{r}
monywa_tmin <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
monywa_tmin$Date <- ymd(monywa_tmin$Date)
monywa_tmin$date <- monywa_tmin$Date
monywa_tmin <- monywa_tmin %>% 
  select(date, Date, Tmin)
monywa_tmin <- monywa_tmin %>% 
  mutate(Tmin = Hmisc::impute(Tmin, mean))

### RCP 4.5 
monywa_tmin_ens <- all_tmin_ens %>% filter(States == 13 & RCP == 45)

monywa_tmin_45_1 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_45_2 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_45_3 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmin_ens, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# monywa_tmin_45_1;monywa_tmin_45_2;monywa_tmin_45_3
monywa_tmin_future <- rbind.data.frame(
  monywa_tmin_45_1, 
  monywa_tmin_45_2, 
  monywa_tmin_45_3)
monywa_tmin_future <- monywa_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5 
monywa_tmin_ens_85 <- all_tmin_ens %>% filter(States == 13 & RCP == 85)

monywa_tmin_85_1 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_85_2 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_85_3 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_tmin_ens_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# monywa_tmin_45_1;monywa_tmin_45_2;monywa_tmin_45_3
monywa_tmin_future_85 <- rbind.data.frame(
  monywa_tmin_85_1, 
  monywa_tmin_85_2, 
  monywa_tmin_85_3)
monywa_tmin_future_85 <- monywa_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5
p1 <- monywa_tmin_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  #geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p2 <- monywa_tmin_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  #geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p1 / p2
```

#### Monthly

```{r}
p3 <- monywa_tmin_future %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
  #geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p4 <- monywa_tmin_future_85 %>%
  group_by(Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obmean), color = "darkolivegreen") +
 # geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
monywa_tmin_future %>%
mutate(
  Year = year(Date),
  Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10)) %>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Monywa station, Lower Sagaing Region, Myanmar")

mandalay_tmin_future_85 %>%
mutate(
  Year = year(Date),
  Month = month(Date)
) %>% 
#filter(Year %in% seq(2010, 2100, 10))%>% 
group_by(Month)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Monywa station, Lower Sagaing Region, Myanmar")

```

#### Annual - Departure

```{r}
p5 <- monywa_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
  #geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p6 <- monywa_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obmean), color = "darkolivegreen") +
 # geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Year

```{r}
monywa_tmin_future %>%
mutate(
  Year = year(Date),
  Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10)) %>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 4.5) at Monywa station, Lower Sagaing Region, Myanmar")

mandalay_tmin_future_85 %>%
mutate(
  Year = year(Date),
  Month = month(Date)
) %>% 
filter(Year %in% seq(2020, 2100, 10))%>% 
group_by(Year)  %>% 
summarize(
    Pmean = mean(future, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE),
    Obmean = mean(Tmin.x, na.rm = TRUE),
    Obmax = max(Tmin.x, na.rm = TRUE),
    Obmin = min(Tmin.x, na.rm = TRUE),
    Mmean = mean(Tmin.y, na.rm = TRUE),
    Mmax = max(Tmin.y, na.rm = TRUE),
    Mmin = min(Tmin.y, na.rm = TRUE)
    ) %>% 
knitr::kable("pipe", digits = 1, caption = "Observed and Projected Annual Minimum Temperature (RCP 8.5) at Monywa station, Lower Sagaing Region, Myanmar")

```


#### Annual - Time Series

```{r}
p7 <- monywa_tmin_future %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            ) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
  #geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p8 <- monywa_tmin_future_85 %>%
  group_by(Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Obmean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obmean = mean(Tmin.x, na.rm = TRUE)),
    aes(x = Year, y = Obmean), color = "darkolivegreen") +
 # geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Minimum Temperature, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p7 / p8
```

### Climate Change Scenario (Mean Shift from Baseline) of minimum temperature at Mandalay station, Mandalay Region, Myanmar

```{r fig.width=10, fig.height=8}
### RCP 4.5
p1 <- ggplot(monywa_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmin$Tmin) -0.2, 2)), 
           y = 0.06, 
           label = paste(round(mean(monywa_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(monywa_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(monywa_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Monywa station, Lower Sagaing Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5 (Ensemble Approach)",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = monywa_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.2) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.2
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_2$future) -0.2,  2),
    y = 0.06,
    label = paste(round(mean(monywa_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.2
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
   theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    monywa_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.2) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Monywa station, Lower Sagaing Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5 (Ensemble Approach)"),
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  geom_density(
    data = monywa_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(monywa_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(monywa_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.2, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.06, 
    label = paste(round(mean(monywa_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7),
        plot.caption = element_text(face = "italic", size = 7, color = "grey60"),
  )

p1 + p2 + plot_layout(ncol = 1)
```



### Precipitation
#### Observed Data - Magwe station

```{r}
magwe_preci <- vroom::vroom("data/Area-3/Magway/clean_Magway_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
magwe_preci["Date"] <- ymd(magwe_preci$Date)
magwe_preci <- magwe_preci %>% 
  mutate(
    preci = round(Hmisc::impute(preci, mean), 1)
  )
magwe_preci$date <- magwe_preci$Date

### RCP 4.5
magwe_preci_ens <- all_preci_ens %>% filter(States == 8 & RCP == 45)

magwe_preci_45_1 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_45_2 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_45_3 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_preci_future <- rbind.data.frame(
  magwe_preci_45_1, 
  magwe_preci_45_2, 
  magwe_preci_45_3)
magwe_preci_future <- magwe_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
magwe_preci_ens_85 <- all_preci_ens %>% filter(States == 8 & RCP == 85)

magwe_preci_85_1 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(magwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_85_2 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(magwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_85_3 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(magwe_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_preci_future_85 <- rbind.data.frame(
  magwe_preci_85_1, 
  magwe_preci_85_2, 
  magwe_preci_85_3)
magwe_preci_future_85 <- magwe_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()


```

#### Daily

```{r}
p1 <- magwe_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue", alpha = 0.5, pch = 1, size = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p2 <- magwe_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue", alpha = 0.5, pch = 1, size = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Precipitation, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- magwe_preci_future %>%
  
  group_by(Month) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)/90,
            Obtotal = sum(preci.x, na.rm = TRUE)/90) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "lightskyblue") +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 4.5"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )

### RCP 8.5
p4 <- magwe_preci_future_85 %>%
  
  group_by(Month) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)/90,
            Obtotal = sum(preci.x, na.rm = TRUE)/90) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "lightskyblue") +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 8.5"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )
p3 / p4

```

#### Summary Table by Month

```{r}
magwe_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar") 

magwe_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Magwe Station, Magwe Region, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- magwe_preci_future %>%
  
  group_by(Year) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE),
            Obtotal = sum(preci.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "lightskyblue") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 4.5"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )

### RCP 8.5
p6 <- magwe_preci_future_85 %>%
  
  group_by(Year) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE),
            Obtotal = sum(preci.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "lightskyblue") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 8.5"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )
p5 / p6

```

#### Summary Table by Year

```{r}
magwe_preci_future %>%
  filter(Year %in% seq(2020, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar") 

magwe_preci_future_85 %>%
  filter(Year %in% seq(2020, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 8.5 by 2100 at Magwe Station, Magwe Region, Myanmar") 
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- magwe_preci_future %>%
  
  group_by(Year) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = magwe_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "lightskyblue") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )

### RCP 8.5
p8 <- magwe_preci_future_85 %>%
  
  group_by(Year) %>%
  summarize(Pmax = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)
            ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = magwe_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "lightskyblue") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Magwe, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )
p7 / p8

```

### Observed Data - Mandalay Station

```{r}
mandalay_preci <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)

mandalay_preci["Date"] <- ymd(mandalay_preci$Date)
mandalay_preci$preci[1643:1673] <- mandalay_preci$preci[(which(mandalay_preci$Date == "1984-07-01")):(which(mandalay_preci$Date == "1984-07-31"))]
mandalay_preci["date"] <- ymd(mandalay_preci$Date)

### RCP 4.5
mandalay_preci_ens <- all_preci_ens %>% filter(States == 9, RCP == 45)

mandalay_preci_45_1 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_45_2 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_45_3 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
mandalay_preci_future <- rbind.data.frame(
  mandalay_preci_45_1, 
  mandalay_preci_45_2, 
  mandalay_preci_45_3)
mandalay_preci_future <- mandalay_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
mandalay_preci_ens_85 <- all_preci_ens %>% filter(States == 9, RCP == 85)

mandalay_preci_85_1 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(mandalay_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_85_2 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(mandalay_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_85_3 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(mandalay_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
mandalay_preci_future_85 <- rbind.data.frame(
  mandalay_preci_85_1, 
  mandalay_preci_85_2, 
  mandalay_preci_85_3)
mandalay_preci_future_85 <- mandalay_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

#### Daily

```{r}
### RCP 4.5
p1 <- mandalay_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Daily Precipitation, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
### RCP 8.5
p2 <- mandalay_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Daily Precipitation, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- mandalay_preci_future %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  #geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p4 <- mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
 # geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
mandalay_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar") 

mandalay_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Mandalay Station, Mandalay Region, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- mandalay_preci_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p6 <- mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
 # geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Year

```{r}
mandalay_preci_future %>%
   filter(Year %in% seq(2020, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar") 

mandalay_preci_future_85 %>%
   filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 8.5 by 2100 at Mandalay Station, Mandalay Region, Myanmar") 
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- mandalay_preci_future %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  #geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Mandalay, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

### RCP 8.5
p8 <- mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = mandalay_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "darkolivegreen") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
 # geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Mandalay, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p7 / p8
```

### Observed Data - Monywa Station

```{r}
monywa_preci <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
monywa_preci["Date"] <- ymd(monywa_preci$Date)

monywa_preci["date"] <- ymd(monywa_preci$Date)

### RCP 4.5
monywa_preci_ens <- all_preci_ens %>% filter(States == 13 & RCP == 45)

monywa_preci_45_1 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_45_2 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_45_3 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_preci_ens, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
monywa_preci_future <- rbind.data.frame(
  monywa_preci_45_1, 
  monywa_preci_45_2, 
  monywa_preci_45_3)
monywa_preci_future <- monywa_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

### RCP 8.5
monywa_preci_ens_85 <- all_preci_ens %>% filter(States == 13 & RCP == 85)

monywa_preci_85_1 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(monywa_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_85_2 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(monywa_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_85_3 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(monywa_preci_ens_85, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
monywa_preci_future_85 <- rbind.data.frame(
  monywa_preci_85_1, 
  monywa_preci_85_2, 
  monywa_preci_85_3)
monywa_preci_future_85 <- monywa_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

#### Daily

```{r}
### RCP 4.5 
p1 <- monywa_preci_future %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "skyblue") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Daily Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
### RCP 8.5 
p2 <- monywa_preci_future_85 %>%
  ggplot(aes(x = Date, y = future)) +
  geom_line(lty = 2) +
  geom_line(aes(x = date, y = preci.x), color = "skyblue") +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    title = "Daily Precipitation, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p1 / p2
```

#### Monthly

```{r}
### RCP 4.5
p3 <- monywa_preci_future %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "deepskyblue") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p4 <- monywa_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Obtotal = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Month, y = Obtotal), color = "deepskyblue") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Monthly Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p3 / p4
```

#### Summary Table by Month

```{r}
monywa_preci_future %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 4.5 by 2100 at **Monywa Station**, Lower Sagaing Region, Myanmar") 

monywa_preci_future_85 %>%
  group_by(Month) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = sum(preci.x, na.rm = TRUE)/90/12,
    ObTotal = sum(preci.x, na.rm = TRUE)/90,
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Monthly Precipitation Changes under RCP 8.5 by 2100 at Monywa Station, Lower Sagaing Region, Myanmar") 
```

#### Annual - Departure

```{r}
### RCP 4.5
p5 <- monywa_preci_future %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p6 <- monywa_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(aes(x = Year, y = Obtotal), color = "deepskyblue") +
  scale_x_discrete(limits = seq(2010, 2100, by = 10)) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p5 / p6
```

#### Summary Table by Year

```{r}
monywa_preci_future %>%
   filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 4.5 by 2100 at **Monywa Station**, Lower Sagaing Region, Myanmar") 

monywa_preci_future_85 %>%
   filter(Year %in% seq(2010, 2100, 10)) %>% 
  group_by(Year) %>%
  summarize(
    ObMax = max(preci.x, na.rm = TRUE),
    ObMean = mean(preci.x, na.rm = TRUE),
    ObTotal = sum(preci.x, na.rm = TRUE),
    Mmax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    Mmin = min(preci.y, na.rm = TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmean = mean(future, na.rm = TRUE),
    PTotal = sum(future, na.rm = TRUE)
  ) %>%
  filter(Mmax > 0) %>%
  arrange(desc(Mmax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Yearly Precipitation Changes under RCP 8.5 by 2100 at Monywa Station, Lower Sagaing Region, Myanmar") 
```

#### Annual - Time Series

```{r}
### RCP 4.5
p7 <- monywa_preci_future %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_preci_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
            aes(x = Year, y = Obtotal/3), color = "deepskyblue") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Monywa, RCP 4.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

p8 <- monywa_preci_future_85 %>%
  group_by(Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Obtotal = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Pmax = max(future, na.rm = TRUE),
    Pmin = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_line(lty = 2) +
  geom_line(data = monywa_preci_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Year) %>% summarize(Obtotal = sum(preci.x, na.rm = TRUE)),
    aes(x = Year, y = Obtotal/3), color = "deepskyblue") +
  scale_x_discrete(limits = seq(1980, 2100, by = 10)) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    title = "Yearly Precipitation, Monywa, RCP 8.5",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
p7 / p8
```



