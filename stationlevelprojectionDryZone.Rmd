---
title: "Climate Scenrio Development for Dry Zone Regions"
subtitle: "Myanmar Climate Change Scenario Atlas- II"
author:
  - "Kyaw Moe Aung, Environmental Conservation Department - MONREC"
  - "Tin Mar Htay, Department of Meteorology and Hydrology"
  - "Hla Tun, Department of Meteorology and Hydrology"
  - "May Khin Chaw, Department of Meteorology and Hydrology"
  - "Shwe Mar Than, Yezin Agriculture University"
  - "Aung Than Oo, Irrigation and Water Utilization Resource Management"
  - "Kyaw Zeya Htun, Yangon Technology University"
  - "Kyaw San Naing, Environmental Conservation Department"
  - "Thanda Wint Wint Khaing, Environmental Conservation"
  - "Thi Thi Soe Min, Environmental Conservation Department"
  - "San Win, Environmental Conservation Department"
  - "Khin Cho Cho Shein, Department of Meteorology and Hydrology"

date: "1/6/2022"
output:
  bookdown::word_document2: 
    toc: true
    toc_depth: 4
    number_sections: true
    fig_caption: true
  pdf_document: default
  html_document:
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

```{=openxml}
<w:p><w:r><w:br w:type="page"/></w:r></w:p>
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, fig.width = 6, fig.height = 4)
library(tidyverse)
library(readr)
library(purrr)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(patchwork)
library(lubridate)
library(vroom)
require(knitr)
library(gt)
require(ggthemes)
if (!require(kableExtra)) install.packages("kableExtra")
if (!require(fs)) install.packages("fs")

abb.month <- c("J ", "F", "M", "A", "M ", "J", " J", "A ", "S", "O", "N", "D")
```

# Central Dry Zone

## Magwe Region

### Mean Temperature

#### Observed data

```{r}
magwe_tmean <- vroom::vroom("data/Area-3/Magway/clean_Magway_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

magwe_tmean["Date"] <- ymd(magwe_tmean$Date)
magwe_tmean$date <- magwe_tmean$Date
magwe_tmean <- magwe_tmean %>% 
  select(date, Date, Tmean)

naCount <- function(df) {
  df %>%
    is.na() %>% 
    colSums()
}
magwe_tmean <- magwe_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )
```

```{r Fig1-1, fig.width=4, fig.height= 6,  fig.regina=2, fig.cap="30 years Observed mean temperature at Magwe station in central dry zone of Myanmar"}

p1 <- magwe_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- magwe_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- magwe_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Mean Temperature at Magwe Station"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- magwe_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(magwe_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(magwe_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(magwe_tmean$Tmean), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Magwe"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-2, fig.cap="Observed and Projected Daily Mean Temperature - RCP 4.5 at Magwe Station, Magwe Region, during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_8_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
tmean_models_combined_45 <- tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_8_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")
tmean_models_combined_85 <- tmean_models_combined_85 %>%
  distinct()


magwe_tmean_45_1 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_45_2 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_45_3 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# magwe_tmean_45_1
# magwe_tmean_45_2
# magwe_tmean_45_3
magwe_tmean_future <- rbind.data.frame(
  magwe_tmean_45_1, 
  magwe_tmean_45_2, 
  magwe_tmean_45_3
  )
magwe_tmean_future <- magwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.size = unit(rel(2), "mm"),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-3, fig.width=7, fig.height=9, fig.regina=2, fig.cap = "Observed and Projected Daily Mean Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 4) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    strip.background = element_rect(fill = "lightcyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.text = element_text(face = "bold", size = 7)
  )

```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-1, Include = TRUE}
magwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
   caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar<br><br>")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```



```{r include=FALSE}
magwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed Vs. Projected Monthly Mean Temperature

```{r  Fig1-4, fig.cap="Monthly Mean Temperature - RCP 4.5 among GCM/RCMs at Magwe Station during 2011-2100"}
magwe_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +

  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
```

##### Observed Vs. Projected Monthly Mean Temperature by Model

```{r Fig1-5, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Mean Temperature - RCP 4.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size =0.5) +
   geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d(option = "A") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    #axis.text.x = element_blank(),
    
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-6, fig.cap="Observed and Projected Annual Mean Temperature - RCP 4.5 among GCM/RCMs at Magwe Station, Magwe Region during 2011-2100"}
magwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean),color = "darkred", lty = "dashed") +
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y") +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "cornsilk"),
    plot.background = element_rect(fill = "lightcyan1"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-7, fig.width = 8, fig.height= 10, fig.regina=2, fig.cap="Observed and Projected Annual Mean Temperature - RCP 4.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)
            ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(size = 0.3) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60", lty = "twodash")+
  scale_color_hue(l = 45) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SND, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(2), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### RCP8.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-8, fig.cap="Observed and Projected Daily Mean Temperature - RCP 8.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_85_1 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_85_2 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
magwe_tmean_85_3 <- magwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# magwe_tmean_85_1
# magwe_tmean_85_2
# magwe_tmean_85_3
magwe_tmean_future_85 <- rbind.data.frame(
  magwe_tmean_85_1, 
  magwe_tmean_85_2, 
  magwe_tmean_85_3)
magwe_tmean_future_85 <- magwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
    
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-9, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature - RCP 8.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  scale_color_hue(l = 45) +
  
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_classic() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    strip.background = element_rect(fill = "skyblue", color = "pink"),
    strip.text = element_text(face = "bold", size = "6", color = "darkred"),
    axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

Under this scenario RCP 8.5, the analysis shows that CSIRO-MK3-6-0,
HADCM3, WAS-44i-MPI-ESM-LR-RCA4, GFDL-ESM2G and MIROC5 are dominant
climate models based upon their maximum values which range from 7.19 to
8.0 as shown in the table below. Observed maximum temperature for this
station is 36.5 degree centigrade which will be increase up to 42.06 C
under CSIRO-MK3-6-0, 42.25 under HADCM3, 42.32 under
WAS-44i-MPI-ESM-LR-RCA4, 42.88 (highest) under GFDL-ESM2G, and 42.1
under MIROC5 model respectively. The expected mean temperature in the
future range from 29.03 to 29.87 which means 2 to 2.8 º will be
expected to increase in this region based upon the data from Magwe
station.

```{r Table1-2, include = TRUE}
magwe_tmean_future_85 %>%
  distinct() %>% 
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    `Observed Max` = max(Tmean.x),
    `Observed Mean` = mean(Tmean.x),
    `Observed Min` = min(Tmean.x),
    `Model Max` = max(Tmean.y),
    `Model Mean` = mean(Tmean.y),
    `Model Min` = min(Tmean.y),
    `Projected Max` = max(future),
    `Projected Mean` = mean(future),
    `Projected Min` = min(future)
  ) %>%
  filter(`Model Max` > 4.0) %>%
  arrange(desc(`Model Max`)) %>%
  head(20) %>% 
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at Magwe Station, Magwe Region, Myanmar") 
#%>%
  # kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
# knitr::knit_exit()
```



```{r include=FALSE}
magwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at Magwe Station, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed and Projected Monthly Mean Temperature

Under monthly option, all models agree to increase temperature in the
future and the highest temperature is expected to be in May and June of
every coming years as shown in the following figure.

```{r Fig1-10, fig.cap = "Observed Vs. Projected Monthly Mean Temperature - RCP 8.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-11, fig.width=7, fig.height=9, fig.cap="Observed Vs. Projected Monthly Mean Temperature - RCP 8.5 among GCM/RCMs at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(magwe_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_excel_new() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-12, fig.width=6, fig.height=4, fig.regina=2, fig.cap="Observed and Projected Annual Mean Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar"}

magwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
    geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmean.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.9) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey"),
    plot.background = element_rect(fill = "steelblue", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(0, 5, 0, 0, "mm"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "lightcyan"),
    panel.grid.major = element_line(linetype = 'twodash', size = 0.5, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.5, color = "grey85")
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-13, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Mean Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar"}
magwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = magwe_tmean_future_85 %>% 
  mutate(
    Year = year(date), 
  Month = month(date)
  ) %>% 
  group_by(Year) %>%  
  summarize(Ob_mean = mean(Tmean.x)),
   aes(x = Year, y = Ob_mean),
    color = "maroon") +
  geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmean.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmean_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmean.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
     legend.position = "none",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(t = 5),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "snow"),
    panel.grid.major = element_line(linetype = 'twodash', size = 0.4, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.2, color = "grey85")
  )
```

#### Density Plot of Mean Temperature at Magwe Station

```{r Fig1-14, fig.width=10, fig.height=8, fig.cap= "Density plot of mean temperature at Magwe Station, Magwe Region, Myanmar"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(magwe_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmean$Tmean) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(magwe_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmean$Tmean) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(magwe_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmean$Tmean) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(magwe_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = magwe_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmean_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmean_45_2, 
    aes(x = future, y = ..density..), 
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(magwe_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmean_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    magwe_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = magwe_tmean_85_1, 
    aes(x = future, y = ..density..), 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmean_85_2, 
    aes(x = future, y = ..density..), 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmean_85_3, 
    aes(x = future, y = ..density..), 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```

### Maximum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

#### Observed Data

More than 700 data points are missing for 1981 and 1982. These were
filled by using "Next Observation Carried Backward", which is also
called BOCF in short. Thus it has been assumed that information from
year 1983 and 1984 are

```{r}
magwe_tmax <- vroom::vroom(
  "data/Area-3/Magway/clean_Magway_maxTem.csv",
  delim = " ",
  col_names = c("Date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)
magwe_tmax$Date <- ymd(magwe_tmax$Date)
magwe_tmax$date <- magwe_tmax$Date
magwe_tmax <- magwe_tmax %>% 
  select(date, Date, Tmax)
```

```{r Fig1-15, fig.width=5, fig.height=6, fig.cap="30 years observed maximum data at Magwe Station"}
p1 <- magwe_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
                              axis.title = element_text(face = "bold", size = 7),
                              axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- magwe_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- magwe_tmax %>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  geom_hline(yintercept = mean(magwe_tmax$Tmax)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Magwe Station"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p4 <- magwe_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  geom_histogram(fill = "cornsilk", color = "blue", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(magwe_tmax$Tmax), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(magwe_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(magwe_tmax$Tmax), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Magwe"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig1-16, echo=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_18_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_18_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

magwe_tmax_45_1 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_45_2 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_45_3 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# magwe_tmax_45_1;magwe_tmax_45_2;magwe_tmax_45_3
magwe_tmax_future <- rbind.data.frame(
  magwe_tmax_45_1, 
  magwe_tmax_45_2, 
  magwe_tmax_45_3)
magwe_tmax_future <- magwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(t = 5),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "snow"),
    panel.grid.major = element_line(linetype = 'dotdash', size = 0.3, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.3, color = "grey85")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-17, fig.width=7, fig.height=9,fig.cap = "Observed and Projected Daily Maximum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar"}
magwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey85") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"), 
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    legend.box.margin = margin(t = 5),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    panel.background = element_rect(fill = "lightcyan"),
    panel.grid.major = element_line(linetype = 'dotdash', size = 0.4, color = "grey60"),
    panel.grid.minor = element_line(linetype = 'twodash', size = 0.2, color = "grey85")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.
```{r Table1-3, include = TRUE}
magwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>% 
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar")
  # %>%
  # kable_styling("striped", c("Observed" = 3, "Modeled" = 3, "Projected" = 3))
```



```{r include=FALSE}
magwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 46.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 46.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-18, fig.cap = "Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar"}
magwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7, lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-19, fig.width=7, fig.height=9, fig.cap = "Monthly Maximum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar"}
magwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature

```{r Fig1-20, echo=FALSE, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Magwe Station, Magwe Region, Myanmar"}
magwe_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
      geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size =7, color = "grey60")
  )
```


##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature

```{r Fig1-21, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Magwe Station, Magwe Region, Myanmar"}
magwe_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
      geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```


#### RCP 8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig1-22, echo=FALSE, fig.cap="Observed and Projected Daily Maximum temperature among different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmax_18_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# magwe_tmax <- vroom::vroom("data/Area-1/magwe/clean_magwe_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
magwe_tmax["Date"] <- ymd(magwe_tmax$Date)
magwe_tmax_85_1 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_85_2 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
magwe_tmax_85_3 <- magwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# magwe_tmax_85_1
# magwe_tmax_85_2
# magwe_tmax_85_3
magwe_tmax_future_85 <- rbind.data.frame(
  magwe_tmax_85_1, 
  magwe_tmax_85_2, 
  magwe_tmax_85_3)
magwe_tmax_future_85 <- magwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size =7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(face = "bold", size = rel(0.8))
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-23, fig.width=10, fig.height=8, fig.cap="Observed and Projected Daily Maximum temperature scenario by GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5) "}
magwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    strip.text = element_text(face = "bold", size = rel(0.7))
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.
```{r Table1-4, include = TRUE}
magwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar") 
# %>% 
#   kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```



```{r include=FALSE}
magwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-24, fig.cap="Observed and Projected Monthly Maximum temperature scenario among different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5)"}
magwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: EDC-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-25, fig.width=10, fig.height=8, fig.cap="Monthly Maximum temperature scenario  among different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5)"}
magwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature

```{r Fig1-26, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar under different GCMs 2011-2100"}
magwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
        geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, " C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "steelblue", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5, color = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```


##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature by Model

```{r Fig1-27, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar under different GCMs 2011-2100"}
magwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
        geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmax_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, " C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "steelblue", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5, color = "snow"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```


#### Density Plot of Maximum Temperature at Magwe Station

```{r Fig1-28, fig.width=10, fig.height=8, fig.cap="Density plot of Maximum Temperature at Magwe Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(magwe_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(magwe_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(magwe_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(magwe_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = magwe_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(magwe_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmax_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1",
    adjust = 5,
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text  = element_text(size = 7),
    axis.title = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    magwe_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = magwe_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text  = element_text(size = 7),
        axis.title = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```


### Minimum Temperature

#### Observed Data

```{r}
magwe_tmin <- vroom::vroom("data/Area-3/Magway/clean_Magway_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)

magwe_tmin["Date"] <- ymd(magwe_tmin$Date)
naCount <- function(df) {
  df %>%
    is.na() %>% 
    colSums()
}
magwe_tmin <- magwe_tmin %>% 
  mutate(
    Tmin = Hmisc::impute(Tmin, "random")
  )
magwe_tmin$date <- magwe_tmin$Date
```

```{r Fig1-29, fig.width=5, fig.height=6, fig.cap="30 years observed data of Minimum Temperature at Magwe Station"}
p1 <- magwe_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- magwe_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimun Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle =45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- magwe_tmin %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimumn Temperature at Magwe Station, Magwe Region, Myanmar"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- magwe_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Distribution",
    title = "Probability Distribution of Minimum Temperature at Magwe Station"
  ) +
  geom_vline(xintercept = mean(magwe_tmin$Tmin),
             lty = "dotted", size = 0.3) +
  annotate("text", 
           x = round(mean(magwe_tmin$Tmin),2),
           y = 0.01,
           label = paste(round(mean(magwe_tmin$Tmin), 2), "C")) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
                              axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-30, echo=FALSE, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_18_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_18_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

magwe_tmin_45_1 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_45_2 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_45_3 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_tmin_future <- rbind.data.frame(
  magwe_tmin_45_1, 
  magwe_tmin_45_2, 
  magwe_tmin_45_3)
magwe_tmin_future <- magwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5, lty = "dotted") +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60")  +
  scale_color_hue(l = 45) +
  #facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-31, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
```

##### Summary Table 4.5


Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-5}
magwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Magwe Station*, Magwe Region, Myanmar") 
# %>% 
#   kable_styling("striped", c("Observed" = 3, "Modeled" = 3, "Projected" = 3))
```


```{r include=TRUE}
magwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-32, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5, lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-33, fig.width = 8, fig.height=10, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(size = 0.5, lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature

```{r Fig1-34, echo=FALSE, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
         geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 1) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, " C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```

##### Observed and Projected Annual Mean, Max and Min of Minimum Temperature by Model

```{r Fig1-35, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
         geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmin_future %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 1) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, " C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
     legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```


#### RCP 8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig1-36, echo=FALSE, fig.cap=" Observed and Projected Daily Minimum temperature among different GCMs at Magwe Station, Magwe Region, Myanmar RCP 8.5"}
files <- fs::dir_ls(glob = "*tmin_18_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


magwe_tmin_85_1 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_85_2 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
magwe_tmin_85_3 <- magwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# magwe_tmin_85_1
# magwe_tmin_85_2
# magwe_tmin_85_3
magwe_tmin_future_85 <- rbind.data.frame(
  magwe_tmin_85_1, 
  magwe_tmin_85_2, 
  magwe_tmin_85_3)
magwe_tmin_future_85 <- magwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-37, fig.height=9, fig.width=7, fig.regina=2, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs at Magwe Station, Magwe Region, Myanmar - RCP 8.5"}
magwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
```

##### Summary Table 8.5

```{r Table1-6, include = TRUE}
magwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar") 
# %>% 
#   kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```



```{r include=FALSE}
magwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed Vs. Projected Monthly Minimum Temperature

```{r Fig1-38, fig.cap="Observed Vs. Projected Monthly Minimum Temperature scenario among different GCMs at Magwe Station, Magwe Region, Myanmar - RCP 8.5"}
magwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE), 
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-39, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Minimum temperature among different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5)"}
magwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    #axis.text.x = element_blank()
  )

```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-40, echo=FALSE, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar under different GCMs 2011-2100"}
magwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature by Model

```{r Fig1-41, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Magwe Station, Magwe Region, Myanmar under different GCMs"}
magwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max),  color = "maroon", alpha = 0.5) +
  geom_line(data = magwe_tmin_future_85 %>% mutate(Year = year(date), Month = month(date)) %>% group_by(Model, Year) %>%  summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
```

#### Density Plot of Minimum Temperature at Magwe Station

```{r Fig1-42, fig.width=10, fig.height=8, fig.cap="Density plot of minimum temperature at Magwe Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(magwe_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(magwe_tmin$Tmin) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(magwe_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(magwe_tmin$Tmin) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(magwe_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(magwe_tmin$Tmin) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(magwe_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = magwe_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(magwe_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(magwe_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(magwe_tmin_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(magwe_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(magwe_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(magwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(magwe_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =magwe_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(magwe_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmin
p2 <-  ggplot(
    magwe_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(magwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(magwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(magwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Magwe Station, Magwe Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = magwe_tmin_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(magwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(magwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = magwe_tmin_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(magwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(magwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =magwe_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(magwe_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(magwe_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(magwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(magwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(magwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```


### Precipitation

#### Observed Data

There is only one missing data points at 8th August 1993. The missing
data can quickly be viewed with the following
script`magwe_preci[which(is.na(magwe_preci$preci)),] %>% view()`. It is
easily filled by applying average value of the data set by using
`impute` method of `Hmisc` package. Once it is filled it is checked
again using `is.na` method to make sure that it is correct.

```{r}
magwe_preci <- vroom::vroom("data/Area-3/Magway/clean_Magway_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
magwe_preci["Date"] <- ymd(magwe_preci$Date)
magwe_preci <- magwe_preci %>% 
  mutate(
    preci = round(Hmisc::impute(preci, mean), 1)
  )
magwe_preci$date <- magwe_preci$Date
```

```{r Fig1-43, fig.width=5, fig.height=6, fig.regina=2, fig.cap="30 years observed data at Magwe Station"}
p1 <- magwe_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/30,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Monthly total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(angle = 45)
  )
p2 <- magwe_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(angle = 45)
  )
p3 <-  magwe_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipatation at Magwe Stataion (1981-2010)")+
    theme_minimal() +
  theme(
    legend.position = "none",
     plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  
p4 <-  magwe_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(magwe_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(magwe_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(magwe_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipatation at Magwe Stataion  (1981-2010)") +
    theme_minimal() +
  theme(
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Total Precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_8_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_8_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


magwe_preci_45_1 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_45_2 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
magwe_preci_45_3 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# magwe_tmin_45_1;magwe_tmin_45_2;magwe_tmin_45_3
magwe_preci_future <- rbind.data.frame(
  magwe_preci_45_1, 
  magwe_preci_45_2, 
  magwe_preci_45_3)
magwe_preci_future <- magwe_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-44, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue", alpha = 0.5, pch = 1, size = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-45, fig.width=8, fig.height = 10, fig.regina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_jitter(aes(x = date, y = preci.x), alpha = 0.5, pch = 1, size = 0.3) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
   strip.background = element_rect(fill = "darkblue", color = "black"),
    strip.text = element_text(size = 7, face = "bold", color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
   )

```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-7, include = TRUE}
magwe_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 1, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region<br>")
```


```{r include=FALSE}
magwe_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Magwe Station**, Magwe Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

magwe_yearly_summary <- magwe_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(magwe_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(magwe_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(magwe_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Magwe is ", mean(magwe_yearly_summary$Total), " mm."))

```

##### Observed Vs. Projected Monthly Precipitation

```{r Fig1-46, fig.cap="Observed and Projected Monthly Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  group_by(Model, Month) %>%
  summarize(Max = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)/90,
            Ob_total = sum(preci.x, na.rm = TRUE)/90) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(size = 0.5) +
  geom_line(aes(x = Month, y = Ob_total), lty = "dashed", pch = 1, size = 1, color = "white") +
  scale_x_discrete(limits = month.abb) +
  scale_color_hue(l = 45) +
 # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.text = element_text(size = 7, face = "bold"),
    axis.text = element_text(size = 7, face = "bold")
    
  )

```

##### Observed Vs. Projected Monthly Precipitation by model

```{r Fig1-47, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  group_by(Model, Month) %>%
  summarize(Max = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE)/90,
            Ob_total = sum(preci.x, na.rm = TRUE)/90) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
 facet_wrap(~Model, scales = "free_y", strip.position = "top", ncol = 5) +
  labs(
    x = "Month",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    strip.text = element_text(size = 6, face = "bold"),
    axis.text = element_text(size = 6, face = "bold")
    
  )

```

##### Observed and Projected Annual Precipitation

```{r Fig1-48, echo=FALSE, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "maroon")+
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  geom_line(data = magwe_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)),
            aes(x = Year, y = Ob_total/3)) +
  scale_x_discrete(limits=c(seq(1980, 2105, 20)))+
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "cornsilk", colour = "black"),
    panel.background = element_rect(fill = "white"),
    legend.text = element_text(face = "bold", size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt")
  )
```

##### Observed Vs. Projected Annual Total Precipitation by Model (Overlap Approach)

```{r Fig1-49, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Total Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  group_by(Model, Year) %>%
  summarize(Max = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE),
            Ob_total = sum(preci.x)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_total), color = "grey85")+
  # geom_line(data = magwe_preci_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_total = sum(preci.x)),
  #           aes(x = Year, y = Ob_total)) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm")
  )
```


##### Observed and Projected Annual Precipitation

```{r Fig1-50, echo=FALSE, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "maroon")+
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  geom_line(data = magwe_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)),
            aes(x = Year, y = Ob_total/3)) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "grey", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

##### Observed and Projected Annual Total Precipitation by Model (Timeseries Approach)

```{r Fig1-51, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Total Precipitation (RCP 4.5) at Magwe Station, Magwe Region, Myanmar during 2011-2100"}
magwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>% 
  group_by(Model, Year) %>%
  summarize(Max = max(future, na.rm = TRUE),
            Total = sum(future, na.rm = TRUE),
            ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  geom_line(data = magwe_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "grey85")+
  # geom_line(data = magwe_preci_future %>% 
  #             mutate(Year = year(date)) %>% 
  #             group_by(Model, Year) %>% 
  #             summarize(Ob_total = sum(preci.x)),
  #           aes(x = Year, y = Ob_total)) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5 ) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm")
  )
```



```{r, include=FALSE}
# Checking observed data
magwe_preci %>% 
  mutate(Year = year(Date),
         Month = month(Date)) %>%
  group_by(Year) %>%
  summarize(Sum = sum(preci),
            Max = max(preci),
            Min = min(preci),
            Mean = mean(preci)) %>%
  ggplot(aes(x = Year, y= Sum))+
  geom_col() +
  geom_text(aes(label=Sum), vjust= -1) +
  geom_line(aes(x = Year, y = Sum, color ="red"))+
  geom_point(aes(x = Year, y = Max), color = "yellow") +
   geom_text(aes(label=Max), vjust = 10, color = "yellow") 
```



```{r include=FALSE}
magwe_preci %>% 
  mutate(
  Year = as.factor(year(Date)),
  Month = as.factor(month(Date))
  ) %>% 
  group_by(Year, Month) %>% 
    summarize(Total = sum(preci),
      Mean = mean(preci),
      Max = max(preci),
      Min = min(preci)
    ) %>% 
    ggplot(aes(x = Month, y=Total, color=Month))+
      geom_boxplot()+
  geom_jitter(aes(x=Month, y=Max, color = Month))+
  #geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Total rainfall in mm",
    title = "Monthly total and max precipitation of 1981-2010 data \nat Magwe Station, Magwe Region, Myanmar",
    caption = "Source: DMH, 2019"
  )+ 
  theme_minimal() +
  theme(
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10)
  )
 
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r Fig1-52, echo=FALSE, fig.cap="Observed and Projected Precipitation scenarios by different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5) "}
files <- fs::dir_ls(glob = "*precip_8_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


magwe_preci_85_1 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
magwe_preci_85_2 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
magwe_preci_85_3 <- magwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
# magwe_preci_85_1
# magwe_preci_85_2
# magwe_preci_85_3
magwe_preci_future_85 <- rbind.data.frame(
  magwe_preci_85_1,
  magwe_preci_85_2,
  magwe_preci_85_3)
magwe_preci_future_85 <- magwe_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
magwe_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(data = magwe_preci_future_85, aes(x = date, y = preci.x), color = "grey85") +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm")
  )
```

##### Observed and Projected Daily Precipitation by model

```{r Fig1-53, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Precipitation scenarios by different GCMs  at Magwe Station, Magwe Region, Myanmar (RCP 8.5) "}
magwe_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(data = magwe_preci_future_85, aes(x = date, y = preci.x), color = "grey85") +
  facet_wrap(~Model, scales = "free_y", strip.position = "top", ncol = 5)+
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    strip.background = element_rect(fill = "lightsteelblue3"),
    strip.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-8, include = TRUE}
magwe_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 100.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 1, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region")
```


```{r, include=FALSE}
magwe_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

magwe_yearly_summary <- magwe_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(magwe_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(magwe_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(magwe_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Magwe is ", mean(magwe_yearly_summary$Total), " mm."))

```

##### Observed and Projected Monthly Precipitation

```{r Fig1-54, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  #geom_smooth(method = "lm", color = "blue")+
  geom_line(aes(x = Month, y = Ob_total), color = "maroon") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "grey", colour = "black"),
    panel.background = element_rect(fill = "white"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 7),
    legend.title = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    
  )
```

##### Observed and Projected Monthly Precipitation by Models

```{r Fig1-55, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  #geom_smooth(method = "lm", color = "blue")+
  geom_line(aes(x = Month, y = Ob_total), color = "maroon") +
  scale_x_discrete(limits = abb.month) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", strip.position =  "right", ncol = 5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "grey", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue3"),
    strip.text = element_text(face = "bold", size = 7)
  )
```

##### Observed Vs. Projected Annual Precipitation

```{r Fig1-56, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Magwe Station, Magwe Region, Myanmar 2011-2100"}
magwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "maroon")+
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #geom_line(data = magwe_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)),
#            aes(x = Year, y = Ob_total/3)) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "cornsilk", colour = "black"),
    panel.background = element_rect(fill = "white"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.title = element_blank(),
    legend.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed Vs. Projected Annual Precipitation by Model


```{r Fig1-57, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Magwe Station, Magwe Region in Myanmar 2011-2100"}
magwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "maroon")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #geom_line(data = magwe_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)),
#            aes(x = Year, y = Ob_total/3)) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "cornsilk", colour = "black"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
#knitr::knit_exit()
```


## Mandalay Region

### Mean Temperature

#### Observed data

```{r}
mandalay_tmean <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

mandalay_tmean["Date"] <- ymd(mandalay_tmean$Date)
mandalay_tmean$date <- mandalay_tmean$Date
mandalay_tmean <- mandalay_tmean %>% 
  select(date, Date, Tmean)

naCount <- function(df) {
  df %>%
    is.na() %>% 
    colSums()
}
mandalay_tmean <- mandalay_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )
```

```{r Fig1-58, fig.width=5, fig.height=6, fig.cap= "30 year observed mean temperature data at Mandalay station"}

p1 <- mandalay_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- mandalay_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- mandalay_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Mean Temperature at Mandalay Station, Mandalay Region, Myanmar"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9, color = "deeppink"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )

p4 <- mandalay_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(mandalay_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(mandalay_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(mandalay_tmean$Tmean), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Mandalay"
  ) + theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-59, echo=FALSE, fig.cap="Observed and Projected Mean Temperature (RCP 4.5) at Mandalay Station during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_9_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
tmean_models_combined_45 <- tmean_models_combined_45 %>%
  distinct()
files <- fs::dir_ls(glob = "*tmean_9_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")
tmean_models_combined_85 <- tmean_models_combined_85 %>%
  distinct()


mandalay_tmean_45_1 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_45_2 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_45_3 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# mandalay_tmean_45_1
# mandalay_tmean_45_2
# mandalay_tmean_45_3
mandalay_tmean_future <- rbind.data.frame(
  mandalay_tmean_45_1, 
  mandalay_tmean_45_2, 
  mandalay_tmean_45_3)
mandalay_tmean_future <- mandalay_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = rel(0.7)),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-60, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Mean Temperature under RCP - 4.5 at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "grey85") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = rel(0.7)),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = rel(2)),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", color = "snow", size = 7)
  )
```

##### Summary Table 4.5
Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-9, include = TRUE}
mandalay_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Mean Temperature exceeding 2 ºC under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar <br>") 
# %>% 
#   kable_styling(latex_options = c("repeat_header", "striped"))
```


```{r include=FALSE}
mandalay_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig1-61, echo=FALSE, fig.cap="Observed and Projected Monthly Mean Temperature under RCP 4.5 by GCM/RCMs at Mandalay Station, Mandalay Region over 1981 - 2100"}
mandalay_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(0.7), "mm"),
    legend.key.size = unit(rel(0.7), "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.7))
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-62, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Mean Temperature under RCP 4.5 by GCM/RCMs at Mandalay Station, Mandalay Region over 1981 - 2100"}
mandalay_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme(legend.position = "none",
    panel.background = element_rect(fill = "snow"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(2), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    strip.background = element_rect(fill = "lightcyan"),
    strip.text = element_text(face = "bold", color = "deeppink", size = rel(0.7))
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-63, fig.cap="Observed and Projected Annual Mean Temperature under RCP 4.5 among GCM/RCMs at Mandalay Station, Mandalay Region over 1981 - 2100"}
mandalay_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  #scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme( legend.position = "bottom",
    panel.background = element_rect(fill = "lightcyan"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.title = element_text(face = "bold", size = 7), 
    axis.text = element_text(size = 7)
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-64, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Mean Temperature under RCP 4.5 by GCM/RCMs at Mandalay Station, Mandalay Region over 1981 - 2100"}
mandalay_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = rel(0.2), alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
    ) +
  theme( legend.position = "none",
    panel.background = element_rect(fill = "white"), 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit((2), "pt"),
    legend.key.size = unit(rel(1), "pt"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan"),
    strip.text = element_text(face = "bold", color = "deeppink", size = 7)
  )
```

#### RCP 8.5

##### Observed and Projected Daily Mean Temperature at Mandalay Region

```{r Fig1-65, echo=FALSE, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_tmean_85_1 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_85_2 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
mandalay_tmean_85_3 <- mandalay_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# mandalay_tmean_85_1
# mandalay_tmean_85_2
# mandalay_tmean_85_3
mandalay_tmean_future_85 <- rbind.data.frame(
  mandalay_tmean_85_1, 
  mandalay_tmean_85_2, 
  mandalay_tmean_85_3)
mandalay_tmean_future_85 <- mandalay_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(mandalay_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan",size = 7),
    strip.text = element_text(face = "bold", color = "deeppink", size = 7)
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-66, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Mandalay Station, Mandalay Region in Myanmar during 2011-2100"}
mandalay_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(mandalay_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(), #element_blank(),
    legend.key.height = unit(rel(0.5), "mm"),
    legend.key.size = unit(rel(0.5), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_blank(),#element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightcyan"),
    strip.text = element_text(face = "bold", color = "deeppink", size = 7)
  )
```

##### Summary Table 8.5
Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-10, include = TRUE}
mandalay_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1, caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 º C** under RCP *8.5* by 2100 at **Mandalay Station**, Mandalay Region, Myanmar")
```



```{r include=FALSE}
mandalay_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Mandalay Station*, Mandalay Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig1-67, fig.cap="Observed and Projected Monthly Temperature (RCP 8.5) among GCM/RCMs at Mandalay Station, Mandalay Region during 2011-2100"}
mandalay_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(mandalay_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
     plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit((2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "cyan"),
    strip.text = element_text(face = "bold", color = "deeppink", size = 7)
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-68, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Mandalay Station, Mandalay Region in Myanmar during 2011-2100"}
mandalay_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 70) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(mandalay_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_classic() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit((2), "mm"),
    legend.key.size = unit(rel(1), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "skyblue"),
    strip.text = element_text(face = "bold", color = "deeppink", size = 7)
  )
```

##### Observed and Projected Annual Mean Temperature (1)

```{r Fig1-69, fig.cap="Observed and Projected Annual Mean Temperature under RCP 8.5 at Mandalay Station, Mandalay Region in Myanmar"}
mandalay_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean))+
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = rel(0.7)),
    legend.title = element_blank(),
    legend.key.height = unit((2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    strip.background = element_rect(fill = "skyblue"),
    strip.text = element_text(face = "bold", color = "deeppink", size = rel(0.7))
  )
```

##### Observed and Projected Annual Mean Temperature by Model (1)

```{r Fig1-70, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Mandalay Station, Mandalay Region in Myanmar"}
mandalay_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "whitesmoke"),
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    #axis.text.x = element_blank(),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    strip.background = element_rect(fill = "skyblue"),
    strip.text = element_text(face = "bold", color = "deeppink", size = rel(0.7))
  )
```

##### Observed and Projected Annual Mean Temperature (2)

```{r Fig1-71, fig.cap="Observed and projected mean temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_mean)) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_min), alpha = 0.5)+
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "bottom",
    legend.key.height = unit(rel(2), "mm"),
    legend.key.size = unit(rel(3), "mm"),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    strip.text = element_text(size = rel(0.7))
  )
```

##### Observed and Projected Annual Mean Temperature by Model (2)

```{r Fig1-72, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_mean)) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_min), alpha = 0.5)+
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "none",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size  = 7, color = "grey60"),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 90)
  )
```

#### Density Plot of Mean Temperature

```{r Fig1-73, fig.width=10, fig.height=8, fig.regina=2, fig.cap= "Density plot of mean temperature at Mandalay Station, Mandalay Region, Myanmar"}
####  Density Plot for mandalay station

### RCP 4.5
p1 <- ggplot(mandalay_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(mandalay_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift from Baseline (1981-2010) at Mandalay Station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = mandalay_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(mandalay_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmean_45_2, 
    aes(x = future, y = ..density..), 
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(mandalay_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmean_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(mandalay_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    mandalay_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(mandalay_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift to Right from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = mandalay_tmean_85_1, 
    aes(x = future, y = ..density..), 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(mandalay_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(mandalay_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(mandalay_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmean_85_2, 
    aes(x = future, y = ..density..), 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(mandalay_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(mandalay_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(mandalay_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmean_85_3, 
    aes(x = future, y = ..density..), 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(mandalay_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

#### Observed Data

```{r}
mandalay_tmax <- vroom::vroom(
  "data/Area-3/Mandalay/clean_Mandalay_maxTem.csv",
  delim = " ",
  col_names = c("date", "Tmax"),
  na = "-999.0",
  show_col_types = FALSE
)


mandalay_tmax$date <- ymd(mandalay_tmax$date)

 mandalay_tmax["Date"] <- ymd(mandalay_tmax$date)
 mandalay_tmax <- mandalay_tmax %>% 
   select(date, Date, Tmax)
```

```{r Fig1-74, fig.width=5, fig.height=6, fig.cap="30 years observed maximum temperature at Mandalay Station, Mandalay Region, Myanmar"}
p1 <- mandalay_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- mandalay_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    legend.key.height = unit(2, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- mandalay_tmax %>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  geom_hline(yintercept = mean(mandalay_tmax$Tmax)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Mandalay Station"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p4 <- mandalay_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(adjust = 5) +
  geom_vline(xintercept = mean(mandalay_tmax$Tmax), lty = "dotted", size = 0.3) +
  annotate("text", 
           x = round(mean(mandalay_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(mandalay_tmax$Tmax), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Mandalay"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Maximum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-75, echo=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_9_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_9_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# mandalay_tmax <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_maxTem.csv",
#   delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
# )
# 
# mandalay_tmax["Date"] <- ymd(mandalay_tmax$Date)
mandalay_tmax_45_1 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_45_2 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_45_3 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# mandalay_tmax_45_1;mandalay_tmax_45_2;mandalay_tmax_45_3
mandalay_tmax_future <- rbind.data.frame(
  mandalay_tmax_45_1, 
  mandalay_tmax_45_2, 
  mandalay_tmax_45_3)
mandalay_tmax_future <- mandalay_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = rel(0.6)),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-76, fig.width=7, fig.height = 9, fig.cap="Observed and Projected Maximum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = rel(0.6)),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue3"),
    strip.text = element_text(face = "bold", size = 7, color = "yellow"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 4.5
Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.
```{r Table1-11, include = TRUE}
mandalay_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktabs = T, digits = 1, 
               caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar")

```


```{r include=FALSE}
mandalay_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 32.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 32.5)
    ) %>% 
  fmt_number(
    columns = c(Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-77, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-78, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Maximum Temperature (RCP 4.5) at Mandalay Station"}
mandalay_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.title = element_text(face = "bold", hjust = 0.5, size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue3"),
    strip.text = element_text(face = "bold", size = 7, color = "darkblue")
  )
```

##### Observed and Projected Annual Maximum Temperature (1)

```{r Fig1-79, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Ob_max = max(Tmax.x),
    Min = min(future),
    Ob_min = min(Tmax.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60") +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Maximum Temperature by model(1)

```{r Fig1-80, echo=FALSE, fig.widt=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Ob_max = max(Tmax.x),
    Min = min(future),
    Ob_min = min(Tmax.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60") +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 75) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =7)
  )
```

##### Observed and Projected Annual Maximum Temperature (2)

```{r Fig1-81, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +

  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey80"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face ="bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Maximum Temperature by Model (2)

```{r Fig1-82, fig.height=9, fig.width=7, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar"}
mandalay_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  
  geom_line(data = mandalay_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +

  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.direction = "horizontal",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    plot.background = element_rect(fill = "lightyellow", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(family = "Times", face = "bold", size = 10, hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey80"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan')
  )
```

#### RCP 8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig1-83, echo=FALSE, fig.cap="Observed and Projected Daily Maximum temperature among different GCMs (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_9_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# mandalay_tmax <- vroom::vroom("data/Area-1/mandalay/clean_mandalay_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
# mandalay_tmax["Date"] <- ymd(mandalay_tmax$Date)
mandalay_tmax_85_1 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_85_2 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
mandalay_tmax_85_3 <- mandalay_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# mandalay_tmax_85_1
# mandalay_tmax_85_2
# mandalay_tmax_85_3
mandalay_tmax_future_85 <- rbind.data.frame(
  mandalay_tmax_85_1, 
  mandalay_tmax_85_2, 
  mandalay_tmax_85_3)
mandalay_tmax_future_85 <- mandalay_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey85") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-84, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Maximum temperature among different GCMs (RCP 8.5)  at Mandalay station, Mandalay Region, Myanmar"}
mandalay_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "grey85") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "lightcyan")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-12, include = TRUE}
mandalay_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
   caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Mandalay Station*, Mandalay Region, Myanmar")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```



```{r include=FALSE}
mandalay_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 32.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 32.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-85, fig.cap="Observed and Projected Monthly Maximum temperature scenario among different GCMs  at Mandalay station, Mandalay Region, Myanmar (RCP 8.5)"}
mandalay_tmax_future_85 %>%
  group_by(Model, Month ) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey85") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", color = "cyan", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-86, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Maximum temperature among different GCMs  at Mandalay station, Mandalay Region, Myanmar (RCP 8.5)"}
mandalay_tmax_future_85 %>%
  
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey85") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", color = "cyan", size = 7),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Maximum Temperature (1)

```{r Fig1-87, echo=FALSE, fig.cap="Observed and Projected Maximum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar under different GCMs"}
mandalay_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Ob_max = max(Tmax.x),
    Min = min(future),
    Ob_min = min(Tmax.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60", alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "lightskyblue", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "maroon"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "maroon"),
    plot.caption = element_text(angle = 45),
    axis.text = element_text(color = "black")
  )
```

##### Observed and Projected Annual Maximum Temperature by Model (1)

```{r Fig1-88, echo=FALSE, fig.cap="Observed and Projected Maximum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar under different GCMs"}
mandalay_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Ob_max = max(Tmax.x),
    Min = min(future),
    Ob_min = min(Tmax.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60", alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "lightskyblue", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.text = element_text(color = "black")
  )
```

#### Density plots for Maximum Temperature

```{r Fig1-89, fig.width=10, fig.height=8, fig.cap="Density plots fo maximum temperature at Mandalay Station, Mandalay Region, Myanmar"}
####  Density Plot for Mandalay station

### RCP 4.5
p1 <- ggplot(mandalay_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust =5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(mandalay_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift Right from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = mandalay_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(mandalay_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    mandalay_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = mandalay_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(mandalay_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(mandalay_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(mandalay_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(mandalay_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(mandalay_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

#### RCP 4.5

#### Observed Data

```{r}
mandalay_tmin <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)

mandalay_tmin["Date"] <- ymd(mandalay_tmin$Date)
mandalay_tmin$date <- mandalay_tmin$Date
```

```{r Fig1-90, fig.width=5, fig.height=6, fig.cap= "30 years observed minimum temperature at Mandalay station, Mandalay Region, Myanmar"}
p1 <- mandalay_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  #   Month = as.factor(month(Date))
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- mandalay_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimun Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45),
    legend.key.height = unit(2, "mm")
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- mandalay_tmin %>%
  # mutate(
  #   Year = as.factor(year(Date)),
  # ) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimumn Temperature at Mandalay Station, Mandalay Region"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10)
  )
p4 <- mandalay_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(adjust = 3)+
  geom_vline(xintercept = mean(mandalay_tmin$Tmin), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(mandalay_tmin$Tmin), 2),
           y = 0.01, label = paste(round(mean(mandalay_tmin$Tmin), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Mandalay Station"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

##### Observed and Projected Daily Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-91, echo=FALSE, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_9_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_9_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


mandalay_tmin_45_1 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_45_2 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_45_3 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# mandalay_tmin_45_1;mandalay_tmin_45_2;mandalay_tmin_45_3
mandalay_tmin_future <- rbind.data.frame(
  mandalay_tmin_45_1, 
  mandalay_tmin_45_2, 
  mandalay_tmin_45_3)
mandalay_tmin_future <- mandalay_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_tmin_future %>%
  distinct() %>% 
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-92, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_tmin_future %>%
  distinct() %>% 
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmin.x), color = "grey60") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "wheat"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-13, include = TRUE}
mandalay_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
  caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```



```{r include=FALSE}
mandalay_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 20.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 20.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-93, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_tmin_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right")
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-94, fig.width = 7, fig.height = 9, fig.regina=2, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_tmin_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "grey60") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature (1)

```{r Fig1-95, echo=FALSE, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(aes(x = Year, y = Ob_mean), alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right")+
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model

```{r Fig1-96, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(aes(x = Year, y = Ob_mean), alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature (2)

```{r Fig1-97, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), alpha = 0.9) +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right")+
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7 , color = "grey60"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model (2)

```{r Fig1-98, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Min = min(future, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), alpha = 0.9) +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "lightskyblue", colour = "black"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = 'lightcyan'),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

#### RCP 8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig1-99, echo=FALSE, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs (RCP 8.5) at Mandalay Station, Mandalay Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmin_9_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

# mandalay_tmin <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_minTem.csv",
#   delim = " ", col_names = c("Date", "tmin"), na = "-999.0", show_col_types = FALSE
# )
# mandalay_tmin["Date"] <- ymd(mandalay_tmin$Date)
mandalay_tmin_85_1 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_85_2 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
mandalay_tmin_85_3 <- mandalay_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# mandalay_tmin_85_1
# mandalay_tmin_85_2
# mandalay_tmin_85_3
mandalay_tmin_future_85 <- rbind.data.frame(
  mandalay_tmin_85_1, 
  mandalay_tmin_85_2, 
  mandalay_tmin_85_3)
mandalay_tmin_future_85 <- mandalay_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_tmin_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-100, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar"}
mandalay_tmin_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-14, include = TRUE}
mandalay_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
  caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 º C** under RCP 8.5 by 2100 at **Magwe Station**, Magwe Region, Myanmar")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```


```{r include=FALSE}
mandalay_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar"), 
             subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 20.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 20.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-101, fig.cap="Observed and Projected Monthly Minimum temperature among different GCMs (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar"}
mandalay_tmin_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = month.abb) +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-102, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Minimum Temperature among different GCMs (RCP 8.5) at Mandalay station, Mandalay Region, Myanmar"}
mandalay_tmin_future_85 %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature

```{r Fig1-103, echo=FALSE, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar under different GCMs 2011-2100"}
mandalay_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(aes(x = Year, y = Ob_mean)) +
  geom_line(aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    legend.background = element_rect(fill = "lightyellow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Minimum Temperature by Model

```{r Fig1-104, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar under different GCMs"}
mandalay_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(aes(x = Year, y = Ob_mean)) +
  geom_line(aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Mean, Min, Max of Minimum Temperature

```{r Fig1-105, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar under different GCMs 2011-2100"}
mandalay_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean)) +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)), 
            aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  # facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "darkred"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Mean, Min, Max of Annual Minimum Temperature by Model (2)

```{r Fig1-106, fig.width=7, fig.height=9, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Mandalay Station, Mandalay Region under different GCMs 2011-2100"}
mandalay_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmin.x, na.rm = TRUE),
    Ob_max = max(Tmin.x, na.rm = TRUE),
    Ob_min = min(Tmin.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
            aes(x = Year, y = Ob_mean)) +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)),
            aes(x = Year, y = Ob_max), alpha = 0.5) +
  geom_line(data = mandalay_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)), 
            aes(x = Year, y = Ob_min), alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 90) +
  scale_color_viridis_d() +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "brown"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "brown"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.text = element_text(face = "bold", size = 7),
    axis.title = element_text(face = "bold", size = 7)
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-107, fig.width=10, fig.height=8, fig.cap="Density plot for minimum temperature at Mandalay Station, Mandalay Region, Myanmar"}
####  Density Plot for Mandalay station

### RCP 4.5
p1 <- ggplot(mandalay_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(mandalay_tmin$Tmin) -0.2, 2)), 
           y = 0.075, 
           label = paste(round(mean(mandalay_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(mandalay_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(mandalay_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(mandalay_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = mandalay_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(mandalay_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_1$future) -0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(mandalay_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(mandalay_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_2$future) -0.2,  2),
    y = 0.075,
    label = paste(round(mean(mandalay_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(mandalay_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =mandalay_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(mandalay_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein tmin
p2 <-  ggplot(
    mandalay_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(mandalay_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(mandalay_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(mandalay_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Mandalay station, Mandalay Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = mandalay_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5,  
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(mandalay_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(min(mandalay_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = mandalay_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(max(mandalay_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(min(mandalay_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =mandalay_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(mandalay_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.075, 
    label = paste(round(mean(mandalay_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(mandalay_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(mandalay_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(mandalay_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Data

There are 31 missing data points which comprise the continuous missing
point for July, 1985. The missing data can quickly be viewed
with the following script
`mandalay_preci[which(is.na(mandalay_preci$preci)),] %>% view()`. 

```{r}
mandalay_preci <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)

mandalay_preci["Date"] <- ymd(mandalay_preci$Date)
mandalay_preci$preci[1643:1673] <- mandalay_preci$preci[(which(mandalay_preci$Date == "1984-07-01")):(which(mandalay_preci$Date == "1984-07-31"))]
mandalay_preci["date"] <- ymd(mandalay_preci$Date)
```

```{r Fig1-108, fig.width=5, fig.height=6, fig.cap="30 years observed precipation data at Mandalay Station, Mandalay Region, Myanmar"}
p1 <- mandalay_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/30,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month",
    y = "Precipitation in mm",
    title = "Monthly avg. total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
p2 <- mandalay_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
   scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  )
p3 <-  mandalay_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipatation at Mandalay Stataion over 30 years (1981-2010)")+
    theme_minimal() +
  theme(
    legend.position = "none",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  
p4 <-  mandalay_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density(adjust = 3) +
  geom_vline(xintercept = log10(mean(mandalay_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(mandalay_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(mandalay_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipatation at Mandalay Stataion over 30 years (1981-2010)") +
    theme_minimal() +
  theme(
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5 
##### Observed and Projected Daily Precipitation at Mandalay Station

```{r Fig1-109, fig.cap="Observed and Projected Precipitation (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*precip_9_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_9_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


mandalay_preci_45_1 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_45_2 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
mandalay_preci_45_3 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
mandalay_preci_future <- rbind.data.frame(
  mandalay_preci_45_1, 
  mandalay_preci_45_2, 
  mandalay_preci_45_3)
mandalay_preci_future <- mandalay_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-110, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Precipitation (RCP 4.5) at Mandalay Station, Mandalay Region, Myanmar during 2011-2100"}
mandalay_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-15, include = TRUE}
mandalay_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 1, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region, Myanmar")
```


```{r include=FALSE}
mandalay_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Mandalay Station**, Mandalay Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

mandalay_yearly_summary <- mandalay_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(mandalay_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(mandalay_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(mandalay_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Mandalay is ", mean(mandalay_yearly_summary$Total), " mm."))

```



##### Observed and Projected Monthly Precipitation at Mandalay Station

```{r Fig1-111, echo=FALSE, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Precipitation by Model

```{r Fig1-112, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Yearly Precipitation at Mandalay Station

```{r Fig1-113, echo=FALSE, fig.cap="Observed and Projected Yearly Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Yearly Precipitation by Model

```{r Fig1-114, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation

```{r Fig1-115, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = mandalay_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/3), aes(x = Year, y = Ob_total)) +
  geom_smooth(method = "lm", color = "red") +
  #facet_wrap(~Model) + 
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7 , color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation by Model

```{r Fig1-116, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Annual Precipitation under RCP 4.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = mandalay_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/3), aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 4) + 
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### RCP 8.5 

##### Observed and Projected Daily precipitation at Mandalay Station

```{r Fig1-117, fig.cap="Observed and Projected Daily Precipitation (RCP 8.5) at Mandalay Station, Mandalay Region during 2011-2100"}
files <- fs::dir_ls(glob = "*precip_9_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# mandalay_preci <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# mandalay_preci["Date"] <- ymd(mandalay_preci$Date)
mandalay_preci_85_1 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
mandalay_preci_85_2 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
mandalay_preci_85_3 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
# mandalay_preci_85_1
# mandalay_preci_85_2
# mandalay_preci_85_3
mandalay_preci_future_85 <- rbind.data.frame(
  mandalay_preci_85_1, 
  mandalay_preci_85_2, 
  mandalay_preci_85_3)
mandalay_preci_future_85 <- mandalay_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
mandalay_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Observed and Projected Daily Precipitation by Model

```{r Fig1-118, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 8.5) at Mandalay Station, Mandalay Region during 2011-2100"}
mandalay_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "darkolivegreen")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-16, include = TRUE}
mandalay_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 100.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 1, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Mandalay Station**, Mandalay Region")
```


```{r include=FALSE}
mandalay_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Mandalay Station**, Mandalay Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

# mandalay_yearly_summary <- mandalay_preci %>%
#      mutate(
#     Year = year(Date),
#   Month = month(Date)) %>%
#    group_by(Year, Month) %>%
#    summarize(Total = sum(preci),
#                n = n())
# 
# ggplot(mandalay_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
#   geom_col() +
#   geom_hline(yintercept = mean(mandalay_yearly_summary$Total))+
#   annotate("text", x = 2003, y = mean(mandalay_yearly_summary$Total) + 200,
#            label = paste("The average monlty rainfall in Mandalay is ", mean(mandalay_yearly_summary$Total), " mm."))

```



##### Observed and Projected Monthly Precipitation at Mandalay Station

```{r Fig1-119, echo=FALSE, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Precipitation by Model

```{r Fig1-120, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", 
    y = " Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation at Mandalay Station

```{r Fig1-121, echo=FALSE, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation by Model

```{r Fig1-122, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region 2011-2100"}
mandalay_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation by model
```{r Fig1-123, fig.regina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = mandalay_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/3), aes(x = Year, y = Ob_total)) +
  geom_smooth(method = "lm", color = "red") +
  #facet_wrap(~Model) + 
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Yearly Precipitation by Model
```{r Fig1-124, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = mandalay_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x)/3), aes(x = Year, y = Ob_total), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 4) + 
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", 
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```




```{r , echo=FALSE, fig.cap="Observed and Projected Annual Precipitation among different GCMs  at Mandalay station, Mandalay Region, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*precip_9_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# mandalay_preci <- vroom::vroom("data/Area-3/Mandalay/clean_Mandalay_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# mandalay_preci["Date"] <- ymd(mandalay_preci$Date)
mandalay_preci_85_1 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
mandalay_preci_85_2 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
mandalay_preci_85_3 <- mandalay_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
# mandalay_preci_85_1
# mandalay_preci_85_2
# mandalay_preci_85_3
mandalay_preci_future_85 <- rbind.data.frame(
  mandalay_preci_85_1, 
  mandalay_preci_85_2, 
  mandalay_preci_85_3)
mandalay_preci_future_85 <- mandalay_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
mandalay_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line() +
  labs(
    x = "Year",
    y = "Precipitaion in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


```{r include=FALSE, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Mandalay Station, Mandalay Region, Myanmar 2011-2100"}
mandalay_preci_future_85 %>%
  group_by(Model,Year, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_smooth(method = "lm", color = "red")+
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "grey", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

```{r include=FALSE, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Mandalay Station 2011-2100"}
mandalay_preci_future_85 %>%
  group_by(Model,Year, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model)+
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", family = "Pyidaungsu"),
    plot.background = element_rect(fill = "grey", colour = "black"),
    panel.background = element_rect(fill = "white")
  )
```

## Lower Sagaing Region

### Mean Temperature

#### Observed data

```{r}
monywa_tmean <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)

monywa_tmean["Date"] <- ymd(monywa_tmean$Date)
monywa_tmean$date <- monywa_tmean$Date
monywa_tmean <- monywa_tmean %>% 
  select(date, Date, Tmean)

naCount <- function(df) {
  df %>%
    is.na() %>% 
    colSums()
}
monywa_tmean <- monywa_tmean %>% 
  mutate(
    Tmean = Hmisc::impute(Tmean, mean)
  )

```

```{r Fig1-125, fig.width=5, fig.height=6, fig.regina=2, fig.cap="30 years observed mean temperature data at Monywa Station"}

p1 <- monywa_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- monywa_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- monywa_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Mean Temperature at Monywa Station, Monywa Region"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9, color = "deeppink"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )

p4 <- monywa_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(monywa_tmean$Tmean), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(monywa_tmean$Tmean), 2),
           y = 0.01, label = paste(round(mean(monywa_tmean$Tmean), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Monywa"
  ) + theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 9),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Mean Temperature

There are two data point gaps within the Observed and Projected Daily
Mean temperature time series from 1981 to 2010. It is filled using
locf(last observation carry forward) method.

```{r Fig1-126, echo=FALSE, fig.cap="Observed and Projected Mean Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_14_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
tmean_models_combined_45 <- tmean_models_combined_45 %>%
  distinct()
files <- fs::dir_ls(glob = "*tmean_14_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")
tmean_models_combined_85 <- tmean_models_combined_85 %>%
  distinct()

# monywa_tmean <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_meanTem.csv",
#   delim = " ", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
# )
# 
# monywa_tmean["Date"] <- ymd(monywa_tmean$Date)
# monywa_tmean <- monywa_tmean %>%
#   fill()
monywa_tmean_45_1 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_45_2 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_45_3 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# monywa_tmean_45_1
# monywa_tmean_45_2
# monywa_tmean_45_3
monywa_tmean_future <- rbind.data.frame(monywa_tmean_45_1, monywa_tmean_45_2, monywa_tmean_45_3)
monywa_tmean_future <- monywa_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct
monywa_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan")
    
  )
```

##### Observed and Projected Daily Temperature at Monywa station

```{r Fig1-127, fig.width = 7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Mean Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
    
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-17, include = TRUE}
monywa_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
   caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Monywa Station*, Monywa Region, Myanmar")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```



##### Observed and Projected Monthly Mean Temperature

```{r Fig1-128, echo=FALSE, fig.cap="Observed Vs. Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-129, fig.width = 7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Mean Temperature (1)

```{r Fig1-130, echo=FALSE, fig.cap="Observed Vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Mean Temperature by Model (1)

```{r Fig1-131, fig.width = 7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature (2)

```{r Fig1-132, echo=FALSE, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = monywa_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature by Model (2)

```{r Fig1-133, fig.width = 7, fig.height=9,  fig.regina=2, fig.cap="Observed Vs. Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = monywa_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0,5,0,5),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### RCP 8.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-134, fig.cap="Observed and Projected Mean Temperature (RCP 8.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}

monywa_tmean_85_1 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_85_2 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
monywa_tmean_85_3 <- monywa_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# monywa_tmean_85_1
# monywa_tmean_85_2
# monywa_tmean_85_3
monywa_tmean_future_85 <- rbind.data.frame(
  monywa_tmean_85_1, 
  monywa_tmean_85_2, 
  monywa_tmean_85_3)
monywa_tmean_future_85 <- monywa_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()


monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
    
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-135, fig.width = 7, fig.height=9,  fig.regina=2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted", size = 0.5) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "white"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
    
  )
```

##### Summary Table 8.5

Under this scenario RCP 8.5, the analysis shows that
WAS-44i-MPI-ESM-LR-REMO2009, BCC-CSM1-1, GFDL-ESM2G, HADCM3 and
FGOALS-G2 are dominant climate models based upon their maximum values
which range from 7.36 to 8.68 as shown in the table below. Observed
maximum temperature for this station is 37.5 degree centigrade which
will be increase up to 43.46 C under WAS-44i-MPI-ESM-LR-REMO2009 and
BCC-CSM1-1, 43.54 under GFDL-ESM2G, 42.97 under HADCM3, 40.78 under
FGOALS-G2 model respectively. The expected mean temperature in the
future range from 29.67 to 30.52 which means 2 to 3 º will be
expected to increase in this region based upon the data from Monywa
station.

```{r Table1-18, include = TRUE}
monywa_tmean_future_85 %>%
  distinct() %>% 
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    `Observed Max` = max(Tmean.x),
    `Observed Mean` = mean(Tmean.x),
    `Observed Min` = min(Tmean.x),
    `Model Max` = max(Tmean.y),
    `Model Mean` = mean(Tmean.y),
    `Model Min` = min(Tmean.y),
    `Projected Max` = max(future),
    `Projected Mean` = mean(future),
    `Projected Min` = min(future)
  ) %>%
  filter(`Model Max` > 4.0) %>%
  arrange(desc(`Model Max`)) %>%
  head(20) %>% 
  kable("pipe", longtable = T, booktabs = T, digits = 1,
        caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at Monywa Station, Lower Sagaing Region, Myanmar")
  #%>% 
  # kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))

```

##### Observed Vs. Projected Monthly Mean Temperature

```{r Fig1-136, echo=FALSE, fig.cap="Observed Vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}

monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen")+
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(monywa_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Mean Temperature by Model

```{r Fig1-137, fig.width = 7, fig.height=9,  fig.regina=2, fig.cap="Observed Vs. Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}

monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen")+
  scale_x_discrete(limits = abb.month) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(monywa_tmean_future_85$Model)))+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Mean Temperature

```{r Fig1-138, echo=FALSE, fig.cap="Observed Vs. Projected Annual Mean Temperature (RCP 8.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}

monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen")+
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(monywa_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Mean Temperature by Model

```{r Fig1-139, fig.width = 7, fig.height=9,  fig.regina=2, fig.cap="Observed Vs. Projected Annual Mean Temperature (RCP 8.5) among GCM/RCMs at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}

monywa_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen")+
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(monywa_tmean_future_85$Model)))+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "wheat", colour = "white"),
    panel.background = element_rect(fill = "snow"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```


##### Observed Vs. Projected Annual Mean, Min, Max of Mean Temperature at Monywa Station

```{r Fig1-140, echo=FALSE, fig.cap="Observed and Projecte Annual Mean Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
# colorcount = length(unique(sittwe_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
monywa_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = max(Tmean.x, na.rm = TRUE),
    Ob_min = min(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60", lty = 3) +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60", lty = 3) +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60", lty = 3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
  legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "cyan"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed Vs. Projected Annual Mean, Max, Min of Mean Temperature by Model at Monywa Station

```{r Fig1-141, fig.width = 7, fig.height=9,  fig.regina=2, fig.cap="Observed and Projecte Annual Mean Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
# colorcount = length(unique(sittwe_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
monywa_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Ob_max = max(Tmean.x, na.rm = TRUE),
    Ob_min = min(Tmean.x, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60", lty = 3) +
  geom_line(aes(x = Year, y = Ob_max), color = "grey60", alpha = 0.5, lty = 3) +
  geom_line(aes(x = Year, y = Ob_min), color = "grey60", alpha = 0.5, lty = 3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = 'free_y', ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
  legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

#### Density Plot of Mean Temperature at Monywa Station

```{r Fig1-142, fig.width=8, fig.height=6, fig.cap="Density plot for mean temperature of Monywa station, Lower Sagaing Region, Myanmar"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(monywa_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmean$Tmean) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(monywa_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmean$Tmean) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(monywa_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmean$Tmean) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(monywa_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = monywa_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmean_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmean_45_2, 
    aes(x = future, y = ..density..), 
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(monywa_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmean_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmean_45_3, 
    aes(x = future, y = ..density..), 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmean
p2 <-  ggplot(
    monywa_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = monywa_tmean_85_1, 
    aes(x = future, y = ..density..), 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmean_85_2, 
    aes(x = future, y = ..density..), 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmean_85_3, 
    aes(x = future, y = ..density..), 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```

### Maximum Temperature

#### Observed Data

More than 700 data points are missing for 1981 and 1982. These were
filled by using "Next Observation Carried Backward", which is also
called BOCF in short. Thus it has been assumed that information from
year 1983 and 1984 are

```{r}
monywa_tmax <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_maxTem.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)


monywa_tmax$Date <- ymd(monywa_tmax$Date)
monywa_tmax$date <- monywa_tmax$Date
monywa_tmax <- monywa_tmax %>% 
  select(date, Date, Tmax)
monywa_tmax <- monywa_tmax %>% 
  mutate(Tmax = Hmisc::impute(Tmax, mean))
```

```{r Fig1-143, fig.width=5, fig.height=6, fig.regina=2,fig.cap="30 years observed maximum temperature at Monywa station, Lower Sagaing Region, Myanmar"}
p1 <- monywa_tmax %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
                              axis.title = element_text(face = "bold", size = 7),
                              axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- monywa_tmax %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- monywa_tmax %>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  geom_hline(yintercept = mean(monywa_tmax$Tmax)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Monywa Station"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p4 <- monywa_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  geom_histogram(fill = "cornsilk", color = "blue", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(monywa_tmax$Tmax), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(monywa_tmax$Tmax), 2),
           y = 0.01, label = paste(round(mean(monywa_tmax$Tmax), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Monywa"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Maximum Temperature at Monywa Station

```{r}
files <- fs::dir_ls(glob = "*tmax_14_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_18_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

monywa_tmax_45_1 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_45_2 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_45_3 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# monywa_tmax_45_1;monywa_tmax_45_2;monywa_tmax_45_3
monywa_tmax_future <- rbind.data.frame(
  monywa_tmax_45_1, 
  monywa_tmax_45_2, 
  monywa_tmax_45_3)
monywa_tmax_future <- monywa_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-144, fig.cap="Observed and Projected Maximum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```



##### Observed and Projected Daily Maximum Temperature at Monywa by model

```{r Fig1-145, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Maximum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 4.5

It has been found that 27 models projected to increase more than 2
º C in the future. GFDL-ESM2M, BCC-CSM1-1, GFDL-ESM2G, MIROC5 and
WAS-44i-MPI-ESM-LR-RCA4 are top five models with the temperature
increase from 3.23 to 4.67 º under this scenario. Based upon the
observed maximum temperature it has been projected that the observed
maximum temperature 48 to 51 C.

```{r Table1-19, include = TRUE}
monywa_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  # filter(Year %in% c(2050, 2100)) %>% 
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>% 
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
         caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Monywa Station**, Magwe Region, Myanmar")
  # %>%
  # kable_styling("striped", c("Observed" = 3, "Modeled" = 3, "Projected" = 3))
```

##### Observed Vs. Projected Monthly Maximum Temperature

```{r Fig1-146, fig.cap="Observed Vs Projected Maximum  Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature at Monywa by model

```{r Fig1-147, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Maximum Temperature

```{r Fig1-148, fig.cap="Observed Vs Projected Annual Maximum  Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 90) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Annual Maximum Temperature at Monywa by model

```{r Fig1-149, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Maximum Temperature

```{r Fig1-150, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Maximum Temperature by Model

```{r Fig1-151, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Monywa Station, Lower Sagaing Region"}
monywa_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### RCP8.5 
##### Observed and Projected Daily Maximum Temperature at Monywa Station

```{r Fig1-152, echo=FALSE, fig.cap="Observed and Projected Maximum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmax_14_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# monywa_tmax <- vroom::vroom("data/Area-1/monywa/clean_monywa_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
# monywa_tmax["Date"] <- ymd(monywa_tmax$Date)
monywa_tmax_85_1 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_85_2 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
monywa_tmax_85_3 <- monywa_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# monywa_tmax_85_1
# monywa_tmax_85_2
# monywa_tmax_85_3
monywa_tmax_future_85 <- rbind.data.frame(
  monywa_tmax_85_1, 
  monywa_tmax_85_2, 
  monywa_tmax_85_3)
monywa_tmax_future_85 <- monywa_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Maximum Temperature at Monywa Station

```{r Fig1-153, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Maximum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-20, include = TRUE}
monywa_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>% 
  kable(format = "pipe", longtable = T, booktabs = T, digits = 1,
   caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Monywa Station**, Lower Sagaing Region, Myanmar")
  #  kable_styling("striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))


```


##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-154, fig.cap = "Observed and Projected Monthly Maximum temperature among different GCMs at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption =  "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature at Monywa Station

```{r Fig1-155, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Maximum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Maximum Temperature at Monywa Station

```{r Fig1-156, fig.cap="Observed and Projected Annual Maximum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
   legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Maximum Temperature at Monywa Station

```{r Fig1-157, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Maximum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmax.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Maximum Temperature

```{r Fig1-158, echo=FALSE, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region under different GCMs 2011-2100"}
monywa_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Maximum Temperature by Model

```{r Fig1-159, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region under different GCMs 2011-2100"}
monywa_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmax.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

#### Density Plot of Maximum Temperature at Monywa Station

```{r Fig1-160, fig.width=10, fig.height=8, fig.cap= "Density plot of Maximum Temperature at Monywa Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(monywa_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmax$Tmax) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(monywa_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmax$Tmax) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(monywa_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmax$Tmax) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(monywa_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift to Right from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = monywa_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmax_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(monywa_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmax_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmax_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmax
p2 <-  ggplot(
    monywa_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift to Right from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = monywa_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```

### Minimum Temperature

#### Observed Data (to be updated)

Any missing data points were
filled by using "Next Observation Carried Backward", which is also
called BOCF in short. 

```{r}
monywa_tmin <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)


monywa_tmin$Date <- ymd(monywa_tmin$Date)
monywa_tmin$date <- monywa_tmin$Date
monywa_tmin <- monywa_tmin %>% 
  select(date, Date, Tmin)
monywa_tmin <- monywa_tmin %>% 
  mutate(Tmin = Hmisc::impute(Tmin, mean))
```

```{r Fig1-161, fig.width=5, fig.height=6, fig.cap= "30 years observed minimum temperature at Monywa station, Lower Sagaing Region, Myanmar"}
p1 <- monywa_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
                              axis.title = element_text(face = "bold", size = 7),
                              axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- monywa_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- monywa_tmin %>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  geom_hline(yintercept = mean(monywa_tmin$Tmin)) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimum Temperature at Monywa Station"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p4 <- monywa_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  geom_histogram(fill = "cornsilk", color = "blue", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(monywa_tmin$Tmin), lty = "dotted", size = 0.5) +
  annotate("text", 
           x = round(mean(monywa_tmin$Tmin), 2),
           y = 0.01, label = paste(round(mean(monywa_tmin$Tmin), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Density of Observed Data at Monywa"
  ) + theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Annual Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-162, echo=FALSE, fig.cap="Annual Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_14_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_14_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

# monywa_tmin <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_minTem.csv",
#   delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
# )
# 
# monywa_tmin["Date"] <- ymd(monywa_tmin$Date)
monywa_tmin_45_1 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_45_2 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_45_3 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# monywa_tmin_45_1;monywa_tmin_45_2;monywa_tmin_45_3
monywa_tmin_future <- rbind.data.frame(
  monywa_tmin_45_1, 
  monywa_tmin_45_2, 
  monywa_tmin_45_3)
monywa_tmin_future <- monywa_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
monywa_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-163, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region, during 2011-2100"}
monywa_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  geom_smooth(method = "lm", color = "red", size = 0.3)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 4.5

It has been found that 27 models projected to increase more than 2
º C in the future. GFDL-ESM2M, BCC-CSM1-1, GFDL-ESM2G, MIROC5 and
WAS-44i-MPI-ESM-LR-RCA4 are top five models with the temperature
increase from 3.23 to 4.67 º under this scenario. Based upon the
observed maximum temperature it has been projected that the observed
maximum temperature 48 to 51 C.

```{r Table1-21, include = TRUE}
monywa_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  # filter(Year %in% c(2050, 2100)) %>% 
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>% 
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
         caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 º C** under RCP 4.5 by 2100 at **Monywa Station**, Magwe Region, Myanmar")
  # %>%
  # kable_styling("striped", c("Observed" = 3, "Modeled" = 3, "Projected" = 3))
```



##### Observed Vs. Projected Monthly Minimum Temperature at Monywa Station

```{r Fig1-164, fig.cap="Observed Vs. Projected Monthly Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red")+
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Minimum Temperature by Model at Monywa Station

```{r Fig1-165, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Monthly Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Minimum Temperature at Monywa Station

```{r Fig1-166, fig.cap="Observed Vs. Projected Monthly Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Minimum Temperature by Model at Monywa Station

```{r Fig1-167, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Annual Minimum Temperature (RCP 4.5) at Monywa Station, Lower Sagaing Region during 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.5) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  geom_smooth(method = "lm", color = "red")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Minimum Temperature

```{r Fig1-168, echo=FALSE, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Monywa Station 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
      legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Minimum Temperature by Model

```{r Fig1-169, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Monywa Station, Lower Sagaing Region, Myanmar 2011-2100"}
monywa_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
      legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 90)
  )
  
```

#### RCP 8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig1-170, echo=FALSE, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmin_14_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

# monywa_tmin <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_minTem.csv",
#   delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
# )
# monywa_tmin["Date"] <- ymd(monywa_tmin$Date)
# monywa_tmin$date <- monywa_tmin$Date
monywa_tmin_85_1 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_85_2 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
monywa_tmin_85_3 <- monywa_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# monywa_tmin_85_1
# monywa_tmin_85_2
# monywa_tmin_85_3
monywa_tmin_future_85 <- rbind.data.frame(
  monywa_tmin_85_1, 
  monywa_tmin_85_2, 
  monywa_tmin_85_3)
monywa_tmin_future_85 <- monywa_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Minimum Temperature by Model at Monywa Station

```{r Fig1-171, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs  at Monywa station, lower Sagaing Region (RCP 8.5)"}
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Min = min(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Summary Table 8.5

It has been found that 27 models projected to increase more than 2
º C in the future. GFDL-ESM2M, BCC-CSM1-1, GFDL-ESM2G, MIROC5 and
WAS-44i-MPI-ESM-LR-RCA4 are top five models with the temperature
increase from 3.23 to 4.67 º under this scenario. Based upon the
observed maximum temperature it has been projected that the observed
maximum temperature 48 to 51 C.

```{r Table1-22, include = TRUE}
monywa_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  # filter(Year %in% c(2050, 2100)) %>% 
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>% 
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 1,
         caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 4 º C** under RCP 8.5 by 2100 at **Monywa Station**, Magwe Region, Myanmar")
  # %>%
  # kable_styling("striped", c("Observed" = 3, "Modeled" = 3, "Projected" = 3))
```





##### Observed vs. Projected Monthly Minimum Temperature

```{r Fig1-172, fig.cap="Observed and Projected Monthly Minimum temperature among different GCMs  at Monywa station, Lower Sagaing Region (RCP 8.5)"}
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Daily Minimum Temperature by Model at Monywa Station

```{r Fig1-173, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Monthly Minimum temperature among different GCMs  at Monywa station, lower Sagaing Region (RCP 8.5)"}
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Minimum Temperature

```{r Fig1-174, fig.cap="Observed and Projected Annual Minimum temperature among different GCMs  at Monywa station, lower Sagaing Region (RCP 8.5)"}
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed vs. Projected Annual Minimum Temperature by Model at Monywa Station

```{r Fig1-175, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Annual Minimum temperature among different GCMs  at Monywa station, lower Sagaing Region (RCP 8.5)"}
monywa_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Minimum Temperature

```{r Fig1-176, echo=FALSE, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region under different GCMs"}
monywa_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
   geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Min, Max of Minimum Temperature by Model

```{r Fig1-177, fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Monywa Station, Lower Sagaing Region under different GCMs"}
monywa_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
   geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_mean = mean(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_mean), color = "darkolivegreen", alpha = 0.9) +
  geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_max = max(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_max), color = "darkolivegreen", alpha = 0.5) +
  geom_line(data = monywa_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% 
            summarize(Ob_min = min(Tmin.x, na.rm = TRUE)),
            aes(x = Year, y = Ob_min), color = "darkolivegreen", alpha = 0.5) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", angle = 90)
  )
```

#### Density Plot of Minimum Temperature at Monywa Station

```{r Fig1-178, fig.width=10, fig.height=8, fig.cap="Density plot of Minimum Temperature at Monywa Station"}
####  Density Plot for Magwe station

### RCP 4.5
p1 <- ggplot(monywa_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(monywa_tmin$Tmin) -0.2, 2)), 
           y = 0.05, 
           label = paste(round(mean(monywa_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(monywa_tmin$Tmin) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(monywa_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(monywa_tmin$Tmin) -0.2, 2),
    y = 0.04, 
    label = paste(
      round(min(monywa_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = monywa_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.5) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(monywa_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(monywa_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(monywa_tmin_45_1$future)-0.3, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmin_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.5
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(monywa_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_2$future) -0.2,  2),
    y = 0.05,
    label = paste(round(mean(monywa_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(monywa_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(monywa_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =monywa_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(monywa_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 10),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 at Pathein Tmin
p2 <-  ggplot(
    monywa_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(monywa_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(monywa_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(monywa_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Monywa Station, Monywa Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = monywa_tmin_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(monywa_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(monywa_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = monywa_tmin_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(monywa_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(round(min(monywa_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =monywa_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.5, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(monywa_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.05, 
    label = paste(round(mean(monywa_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(monywa_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(monywa_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(monywa_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 10),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

```{r}
#knitr::knit_exit()
```

### Precipitation
#### Observed Data

There are 31 missing data points which comprise the continuous missing
point for July, 1985. The missing data can quickly be viewed
with the following script
`mandalay_preci[which(is.na(mandalay_preci$preci)),] %>% view()`. 

```{r}
monywa_preci <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
monywa_preci["Date"] <- ymd(monywa_preci$Date)

monywa_preci["date"] <- ymd(monywa_preci$Date)
```

```{r Fig1-179, fig.width=5, fig.height=6, fig.cap="30 years observed precipitation data at Monywa Station, Lower Sagaing Region, Myanmar"}
p1 <- monywa_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Month) %>%
  summarize(
    Total = sum(preci)/30,
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total)) +
  geom_line() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Monthly total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(angle = 45)
  )
p2 <- monywa_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
   geom_boxplot() +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Daily Maximum Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
    axis.text.x = element_text(angle = 45),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60")
  )
p3 <-  monywa_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col(alpha = 0.5) +
  scale_color_hue(l = 100) +
  scale_color_viridis_d() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipatation at Monywa Stataion (1981-2010)")+
    theme_minimal() +
  theme(
    legend.position = "none",
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  
p4 <-  monywa_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(monywa_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(monywa_preci$preci) - 0.5), y = 0.9,
           label = paste(round(10 ^ log10(mean(monywa_preci$preci)), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. density ",
      title = "Precipatation at Monywa Stataion (1981-2010)") +
    theme_minimal() +
  theme(
    plot.title =  element_text(hjust = 0.5, face = "bold", size = 10),
     axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7))
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```



#### RCP 4.5 
##### Observed and Projected Daily precipitation at Monywa Station

```{r}
files <- fs::dir_ls(glob = "*precip_14_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_14_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


monywa_preci_45_1 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_45_2 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
monywa_preci_45_3 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y/100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
monywa_preci_future <- rbind.data.frame(
  monywa_preci_45_1, 
  monywa_preci_45_2, 
  monywa_preci_45_3)
monywa_preci_future <- monywa_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-180, fig.cap="Observed and Projected Precipitation (RCP 4.5) at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}
monywa_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "skyblue") +
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Observed and Projected Daily Precipitation by Model at Monywa Station

```{r Fig1-181, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Precipitation (RCP 4.5) at Monywa Station, Lower Sagaing Region, Myanmar during 2011-2100"}
monywa_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  #filter(Year %in% c(2011:2070)) %>% 
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE),
  #           Total = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "skyblue") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "wheat"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )

```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-23, include = TRUE}
monywa_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Monywa Station**, Lower Sagaing Region")
```


```{r include=FALSE}
monywa_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Monywa Station**, Monywa Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

monywa_yearly_summary <- monywa_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(monywa_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(monywa_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(monywa_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Monywa is ", mean(monywa_yearly_summary$Total), " mm."))

```

##### Observed Vs. Projected Monthly Precipitation at Monywa Station

```{r Fig1-182, echo=FALSE, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 4.5 at Monywa Station 2011-2100"}
monywa_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Precipitation by Model at Monywa Station

```{r Fig1-183,  fig.width=7, fig.height=9, fig.regina=2, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 4.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue") +
  scale_x_discrete(limits = abb.month) +
  geom_smooth(method = "lm", color = "red") + 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
  legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

```{r include=FALSE}
monywa_preci %>% 
  mutate(
  Year = as.factor(year(Date)),
  Month = as.factor(month(Date))
  ) %>% 
  group_by(Year,Month) %>% 
    summarize(Total = sum(preci),
      Mean = mean(preci),
      Max = max(preci),
      Min = min(preci)
    ) %>% 
    ggplot(aes(x = Month, y=Total, color=Month)) +
      geom_boxplot() +
    geom_jitter(aes(x=Month, y=Max))+
    geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed total and max precipitation of 1981-2010 data at Monywa Station",
    caption = "Source: DMH, 2019"
  )+ 
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


##### Observed Vs. Projected Annual Precipitation at Monywa Station

```{r Fig1-184, echo=FALSE, fig.cap="Observed Vs. Projected Annual Precipitation under RCP 4.5 at Monywa Station, Lower Sagaing Regin, Myanmar"}
monywa_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkred", size =1, lty = 3) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Annual Precipitation by Model at Monywa Station

```{r Fig1-185, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed Vs. Projected Annual Precipitation under RCP 4.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  geom_smooth(method = "lm", color = "red") + 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
  legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```



##### Observed and Projected Annual Precipitation at Monywa Station

```{r Fig1-186, echo=FALSE, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = monywa_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3), aes(x = Year, y = Ob_total), color = "darkred", size =1, lty = 3) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  #stat_smooth(alpha = 0.1, se = FALSE) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


##### Observed and Projected Annual Precipitation by Model at Monywa Station

```{r Fig1-187, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = monywa_preci_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "darkblue") +
  geom_smooth(method = "lm", color = "red") + 
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
  legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```



#### RCP 8.5 
##### Observed and Projected Daily Precipitation at Monywa Station

```{r echo=FALSE}
files <- fs::dir_ls(glob = "*precip_9_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# monywa_preci <- vroom::vroom("data/Area-3/Monywa/clean_Monywa_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# monywa_preci["Date"] <- ymd(monywa_preci$Date)
monywa_preci_85_1 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
monywa_preci_85_2 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
monywa_preci_85_3 <- monywa_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y/100
  )
# monywa_preci_85_1
# monywa_preci_85_2
# monywa_preci_85_3
monywa_preci_future_85 <- rbind.data.frame(
  monywa_preci_85_1, 
  monywa_preci_85_2, 
  monywa_preci_85_3)
monywa_preci_future_85 <- monywa_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```


```{r Fig1-188, fig.cap=" Observed and Projected Daily Precipitation among different GCMs  at Monywa station, Lower Sagaing Region, Myanmar (RCP 8.5) "}
monywa_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue")+
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

##### Observed and Projected Daily Precipitation by Model at Monywa Station

```{r Fig1-189, fig.width=8, fig.height=10, fig.regina=2, fig.cap=" Observed and Projected Daily Precipitation among different GCMs  at Monywa station, Lower Sagaing Region, Myanmar (RCP 8.5)"}
monywa_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue")+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```



##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-24, include = TRUE}
monywa_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 100.0) %>%
  arrange(desc(Model_Max)) %>%
  head(20) %>%
  knitr::kable("pipe", longtable = T, booktobs = T, digit = 2, caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Monywa Station**, Lower Sagaing Region")
```


```{r include=FALSE}
monywa_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Monywa Station**, Monywa Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 144.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 144.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

monywa_yearly_summary <- monywa_preci %>%
     mutate(
    Year = year(Date),
  Month = month(Date)) %>%
   group_by(Year, Month) %>%
   summarize(Total = sum(preci),
               n = n())

ggplot(monywa_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
  geom_col() +
  geom_hline(yintercept = mean(monywa_yearly_summary$Total))+
  annotate("text", x = 2003, y = mean(monywa_yearly_summary$Total) + 200,
           label = paste("The average monlty rainfall in Monywa is ", mean(monywa_yearly_summary$Total), " mm."))

```



##### Observed Vs. Projected Monthly Precipitation at Monywa Station

```{r Fig1-190, fig.cap="Observed Vs. Projected Monthly Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  geom_smooth(method = "lm", color = "red") +
  scale_x_discrete(limits = month.abb) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


##### Observed Vs. Projected Monthly Precipitation by Model
```{r Fig1-191, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed Vs. Projected Monthly Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model,Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  scale_x_discrete(limits = abb.month) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```

```{r}
#knitr::knit_exit()
```
 
 
##### Observed Vs. Projected Annual Precipitation
```{r Fig1-192, fig.regina=2, fig.cap="Observed Vs. Projected Annual Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  geom_smooth(method = "lm", color = "red") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


##### Observed Vs. Projected Annual Precipitation by Model
```{r Fig1-193, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed Vs. Projected Annual Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```
```{r}
#knitr::knit_exit()
```


##### Observed and Projected Annual Precipitation at Monywa Station
```{r Fig1-194, fig.regina=2, fig.cap="Observed and Projected Annual Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = monywa_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  geom_smooth(method = "lm", color = "red") +
  #facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```


##### Observed and Projected Annual Precipitation by Model
```{r Fig1-195, fig.width=8, fig.height=10, fig.regina=2, fig.cap="Observed and Projected Annual Total Precipitation under RCP 8.5 at Monywa Station, Lower Sagaing Region, Myanmar"}
monywa_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm=TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = monywa_preci_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "darkblue", lty = 2, size = 1) +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  #geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.5) +
  #geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.5) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.margin = margin(0, 0, 5, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(size = 5),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    panel.background = element_rect(fill = "lightcyan"),
    plot.title = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", color = "grey25", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    #axis.text.x = element_blank()
  )
```
```{r}
#knitr::knit_exit()
```
