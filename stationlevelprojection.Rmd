---
title: "Climate Scenario Development for Coastal Regions"
subtitle: "Myanmar Climate Change Scenario Atlas- I"
author:
  - "Kyaw Moe Aung, Environmental Conservation Department - MONREC"
  - "Tin Mar Htay, Department of Meteorology and Hydrology"
  - "Hla Tun, Department of Meteorology and Hydrology"
  - "May Khin Chaw, Department of Meteorology and Hydrology"
  - "Shwe Mar Than, Yezin Agriculture University"
  - "Aung Than Oo, Irrigation and Water Utilization Resource Management"
  - "Kyaw Zeya Htun, Yangon Technology University"
  - "Kyaw San Naing, Environmental Conservation Department"
  - "Thanda Wint Wint Khaing, Environmental Conservation Department"
  - "Thi Thi Soe Min, Environmental Conservation Department"
  - "San Win, Environmental Conservation Department"
  - "Khin Cho Cho Shein, Department of Meteorology and Hydrology"

date: "1/6/2022"
output:
  bookdown::word_document2: 
    toc: true
    toc_depth: 4
    number_sections: true
    fig_caption: true
  pdf_document: default
  html_document:
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

```{=openxml}
<w:p><w:r><w:br w:type="page"/></w:r></w:p>
```
\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE, message = FALSE, error = FALSE,
  fig.width = 6, fig.height = 4, fig.retina = 2
)
library(tidyverse)
library(readr)
library(purrr)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(patchwork)
library(lubridate)
library(vroom)
require(knitr)
require(ggthemes)
require(RColorBrewer)
require(gt)
if (!require(kableExtra)) install.packages("kableExtra")
if (!require(fs)) install.packages("fs")

abb.month <- c("J ", "F", "M", "A", "M ", "J", " J", "A ", "S", "O", "N", "D")
```

# Status of Climate Research in Myanmar

Knowledge spectrum of climate change was shined since late 2010s through
the preparation of Initial National Communication (INC) which was
officially submitted to United Nations Framework Convention on Climate
Change (UNFCCC) in 2012 (MoECAF, 2012). Within the same year, National
Adaptation Programmes of Actions was also prepared and submitted to
UNFCCC. Since then climate related researches were carried out
especially in the academic works supervised by the world class
professors around the world. The most common thematic areas are closely
related to climate scenario, impacts on agriculture and water resource
including forestry and health sector. However, most of the research work
on climate change impacts relied on the expertise of international
resources on future climate change in different climate models.\
\# Single Model overview Climate Scenario Development has begun as early
as in 2009 for the preparation of Initial National Communication using
four climate models such as CISRO-30, GFDLCM20, UKHadCM3 and UKHadGEM1
over mean temperature and precipitation. As the first initiative,
**M**odel for the **A**ssessment of **G**reenhouse Gas **I**nduced
**C**limate **C**hange/**SCEN**ario **GEN**erator (MAGICC/SCENGEN) was
used for two climate variables known as Temperature and Precipitation
taking into account **A1TIMES** and \*WRE450\*\* scenarios. There were 7
observation stations used for the study which comprises of Myitkyina,
Mandalay, Kentung, Sittwe, Mingalagon (Yangon), Pathein and Dawei
station. Thirty years data of 1970-2000 year was used as baseline.

-   For 2001-2020, it was projected that **temperature shows slight
    warming (0.5 C) during June to November in the whole country. In
    other months warming increases to (0.7-1.2 C) in the country except
    the delta and southern parts of the country where the warming is
    (0.6 C)** while **The scenario of precipitation exhibits about *5%
    increase of rain* during March- November through out the country but
    in the remaining months, the deltaic areas and the southern region
    will receive about normal precipitation and it will be deficit up to
    45 % elsewhere**.
-   For 2021-2050, it was also projected that **The temperature will
    increase within a range of (1.2-1.8 C) during June to November in
    the whole country. It remains warm with the same magnitude in other
    months in the lower Myanmar, the deltaic region and the southern
    part of the country. Warming increases by 2.5-3.0 C from December to
    May elsewhere in the whole country** while **the precipitation, most
    part of the country will receive about 10% increase during March to
    November. In the northern, the central and the eastern regions,
    there will be a deficient rain of up to 80% during the cool months
    December to February**.
-   For 2051-2100, it was projected that **The temperature will be
    warmer within a range of (1.25-1.6 C) during June to November in the
    whole country, increases to about (2.25 C) in March to May and
    further increases to (2.7 C) during December to February except in
    the regions of Southern Myanmar & Deltaic areas generally showing of
    warmer cool season in the country** and **the whole country will
    generally receive about 10 % increase of the precipitation during
    March to November and deficient rainfall of up to 80 % is likely
    during the cool months form December to February**.

Subsequently, another scenario was developed in 2016 with the technical
assistance of Regional Integrated Multi-Harzard Early Warning System
(RIME) and Myanmar Climate Change Alliance (MCCA) on the 5 Global
Climate Models (GCMs) over the minimum temperature, maximum temperature
and precipitation with the spatial resolution of \~20 km. Within the
same year, WWF (Worldwide Fund for nature) also carried out climate
scenario for land and sea using 21 GCMs which is also known as NEX-GDDP.
It has been observed that the increase in temperature during last three
decades (1981-2010) is 0.14°C and 0.35°C per decade for coastal and
inland region respectively. It also revealed that annual total
precipitation increase slightly between 1981 and 2010, with increase of
157 mm/decade in coastal areas and 37 mm/decade in inland (WWF, 2016).
The climate change projections for Myanmar revealed an increase of
minimum temperature between 0.8ºC to 2.7ºC degree and maximum
temperature between 0.8ºC to 2.6ºC by end of 2100 under RCP4.5. Under
RCP 8.5, both minimum and maximum temperature will increase between
0.9ºC to 4.6ºC and 0.8ºC to 4.4ºC by end of the century. Increase in
precipitation by end of the century will be 36 percent under RCP 4.5 and
40 percent under RCP 8.5.(MoNREC, MCCA, 2016).

In 2018, Asia Disaster Preparedness Center (ADPC) in collaboration with
DMH has conducted another climate scenario using 21 GCMs which is
available online for interactive analysis and view the result map under
RCP 4.5 and 8.5. However it subjects to purchase from DMH by registering
an account at that website. The spatial resolutions for all the above
mentioned are 20 - 25 km.

Environmental Conservation Department has launched Second National
Communication to UNFCCC project with the technical assistance of UNEP.
The project was funded by Global Environment Facility. The project aimed
to prepare a national communication report to UNFCCC in accordance with
the international treaty. The report comprises of six main chapters. A
chapter on climate change impact and adaptation options assessment will
highlights the most vulnerable region, sector and communities due to
intense rainfall, drought, sea level rise, cyclone which are stimulated
by current changing climate. To do so, the most important and basic step
is to develop climate scenario of the country. According to Consultative
Group of Experts (CGE) training materials, SimCLIM commercial software
is one of the suggested tools to perform climate scenario and sea level
rise.

In 2019, SNC project has invited two international experts together with
SimCLIM software to the SNC project to deliver 64 hours hands-on
training on the analysis of Coupled Model Inter-comparison Project - 5
(CMIP5) data using SimCLIM tool with the special participants from the
Department of Meteorology and Hydrology including Academia. The
available climate variables are precipitation, minimum temperature,
maximum temperature, wind, solar radiation and relative humidity. Due to
difficulties in data availability for verification of the SimCLIM
results, only three variables were extracted in two conditions. The
first one is projection output in ascii format with two RCPs and the
second one is Change From Baseline (CFB) in ascii format with same RCPs.

## Almost 100 thousands climate files are processed

The data preparation includes extracting zonal stats from all raster
taken from SimCLIM Desktop 4.0 using 19 states and regions boundary
layer file for two RCPs: RCP 4.5 and 8.5 for each of the regions and
states. The total number of models covered are 40 Global Circulation
Models and 6 East Asian Regional Circulation Model and 7 West Asian
Regional Models. As the data extraction is aimed for time series from
2005 to 2100, the files are grouped by month by model and by climate
variables. The reason for extraction of raster in 5 years interval is
primarily due to growing files numbers and increases substantially in
size. It can be calculated as 2 RCPs \* 4 climate variables \* 20 years
\* 51 models and is equivalent to `r 2 * 4 * 20 * 51` files which are
being processed for each month. If we extract yearly data on monthly
basis, the number of files will be increased up to
`r 2 * 4* 20 * 51 * 5` files will be generated and the storage will need
`r 2 * 4 * 20 * 51* 5 * 20/1000` Gb for each month. It means that there
will be `r 2 * 4 * 20 * 51 * 5 *12` files with the total storage
requirement of `r 2 * 4 * 20 * 51 * 5 * 20 * 12 /1000` Gb. It would be
much harder to manipulate data and larger space are needed and more
processing time will be required. Even in this 5 years interval, the
analysis for this individual models study involve almost 100,000 files
to cover all monthly data from 2005 to 2100. This is a large amount of
data, can be called **Climate Change Big Data Analysis**. This is the
largest time consuming step.

## Enhancement of Randomly Access Memory (RAM)

To take advantage of larger RAMs functions and capabilities, which will
enhance the processing time for each model for each month of data in
less processing time, the RAM has increased from 8 Gb to 16 Gb with the
speed of 2133 GHz. In each month, there are 51 rscripts created and run
using local job function which allow us around 10 - 15 rscripts can be
processed in parallel for the zonal stats. The processing time varies
depending on the choice of OS platforms such as Linux, Window and Mac.
According to the experience, at least 8 Gb of RAM will be necessary to
properly run the scripts in parallel with a limited range of 2-5 scripts
files. In Ubuntu (Linux) platform with the capacity of 16 Gb RAM, around
10 to 15 minutes takes to complete the process. Other platforms might
run a little bit slower depending the processor.

## File Management and File Structure

The study involves large data files which are well organized firstly by
month. Folders for each model are created as the second level and four
subfolders were further created under each model. All ascii raster
layers are put each folder with their respective climate variables. Thus
there are 51 folders for climate models under each of which there are
four sub-folders. Then

## Naming Convention for output comma separated value (csv) file

As an output of this process, there are 2 comma separate value (csv)
files in long format and additional 2 comma separate value (csv) files
in wide format. The naming convention of csv files are
`model_climatevariable_change_rcp_2100_month.csv` for long format and
`model_climatevariable_change_wide_rcp_2100_month.csv` for wide format.
Long format are more useful for data visualization in R and Python,
while wide format are more useful for excel alike applications. There
are six more graphical presentation in png format to quickly visualize
climate projections (cfb) for 4 variables which are plotted using R
built-in 'base' package for plotting point pattern graph along the time
series on the x-axis for each states and regions. Moreover bar plot for
all states and regions as well as for climate variable changes along the
time series. The following figures depict an example for it. ![Maximum
Temperature Change in each state and region (BNU-ESM model under RCP
8.5)](bnu-esm_tmax_change_85_2100_march.png) ![Maximum Temperature
Change among state and region (BNU-ESM model under RCP
8.5)](bnu-esm_tmax_change_85_2100_march_state.png)

![Maximum Temperature Change among state and region (BNU-ESM model under
RCP 8.5)](bnu-esm_tmax_change_85_2100_march_box.png)

## Time Series Preparation

The calculation requires time series and we have covered 5 years
interval starting from 2005 to 2100. Thus interpolation method is
applied for each month by using `imputeTS` package.

## Joining with observed data

There are further steps to transform from observed data to future
projection data.It requires 3 time slices: 2011-2040, 2041-2070 and
2071-2100 because our observed data is 30 years data of 1981-2100.Then
these three time slices are combined to form a hundred year time series
projection data. It is also done by using R and Rstudio. The main
packages included are `readr`, `purrr`, `vroom`, `lubridate`, `stringr`,
`tidyr`, `dplyr`, etc.

## Summary data and Visualization

There are 9 stations data representing 3 for low land coastal areas such
as Pathein in Ayeyarwaddy, Dawei in Tanintharyi and Sittwe in Rakhine; 3
for dry zone areas such as Magwe in Magwe Region, Mandalay in Mandalay
Region and Monywa in Sagaing Region; 3 for upland areas which comprise
of myitkyina in Chin State, Myitkyina in Kachin State and Taunggyi in
Shan State.

Then, each climate variables are combined together with observed each
station data for each RCPs. The station data are visualized by each
climate variable based on the basic statistics such mean, max and min of
the Tmean, Tmin, Tmax and precipitation data. In this visualization
ggplot2 packages are intensively used. while recent DMH study showed
decrease in annual precipitation with increase in average intensity.

The data preparation include extracting zonal statistics from while
recent DMH study showed decrease in annual precipitation with increase
in average intensity.

\newpage

# Lowland coastal areas

## Ayeyarwaddy Region

### Mean Temperature

Ayeyarwaddy region is situated in the south western part of Myanmar

Under this future climate projection and generation of daily rainfall,
temperature, 30 years of observed data at the Pathein station,
Ayeyarwaddy Region, Myanmar were used. It has been found that this
station was well recorded on mean, max, min temperature and
precipitation. There are three basic analysis such as daily, monthly and
annual for mean, maximum and minimum of temperature and precipitation
for the available models. The number of model in this analysis contains
43 GCM and RCM all together which are viewed under two different climate
scenarios to know what will happen if the GHG emission is controlled to
some extent (RCP 4.5) and without control (RCP 8.5) as climate change is
closely related to temperature increase which occurs as a consequence of
Greenhouse Gas emissions and . Daily and Monthly information are
extremely useful for future climate impact analysis especially in
climate sensitive sectors.

Observed and Projected Daily Mean Temperature changes shows us Regional
Climate Models are dominated to GCMs especially by west asia models.

#### Observed Data

```{r Fig2-1, fig.width=4, fig.height=6, fig.retina=2, fig.align='center', fig.cap= "30 years observed mean temperature at Pathein Station"}
mon <- c(
  "Jan", "Feb", "Mar", "Apr", "May", "Jun",
  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
)
pathein_tmean <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_meanTem.csv",
  delim = " ", col_names = c("Date", "Tmean"),
  na = "-999.0", show_col_types = FALSE
)
pathein_tmean["Date"] <- ymd(pathein_tmean$Date)
pathein_tmean$date <- pathein_tmean$Date

p1 <- pathein_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- pathein_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.key.height = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7, angle =45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- pathein_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Mean Temperature \nat Pathein station, Ayeyarwaddy Region, Myanmar"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- pathein_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(pathein_tmean$Tmean), lty = "dotted") +
  annotate("text", 
           x = round(mean(pathein_tmean$Tmean), 2),
           y = 0.03, label = paste(round(mean(pathein_tmean$Tmean), 2), "C"),
           size = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability Density",
    title = "Probability Distribution of Observed Data at Pathein"
  )+theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))

```

#### RCP 4.5

##### Observed and Projected Daily Mean Temperature

```{r Ayeyarwaddy-Tmean-data, echo=FALSE, warning=FALSE, message=FALSE, include = FALSE}
files <- fs::dir_ls(glob = "*tmean_1_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_1_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x,
    col_select = c("dt.x", "CFB", "Models"),
    show_col_types = FALSE
  )
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")

pathein_tmean_45_1 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_45_2 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_45_3 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_45_1
# pathein_tmean_45_2
# pathein_tmean_45_3
pathein_tmean_future <- rbind.data.frame(
  pathein_tmean_45_1,
  pathein_tmean_45_2,
  pathein_tmean_45_3
)
```

```{r Fig2-2, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future <- pathein_tmean_future %>%
  distinct() %>% 
  mutate(
    Year = as.factor(year(Date)),
    Month = month(Date)
  )
pathein_tmean_future %>%
  # group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmean.x), color = "darkgray") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  ggthemes::theme_excel_new() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(
      family = "sans",
      hjust = 0.5,
      face = "bold",
      size = 10
    ),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(
      family = "sans",
      size = 7
    ),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2,"mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 6),
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig2-3, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future <- pathein_tmean_future %>%
  mutate(
    Year =year(Date),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Year) %>%
  #filter(Year %in% c(2020, 2040, 2060, 2080, 2100)) %>% 
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmean.x), color = "lightyellow") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol=5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "lightblue"),
    plot.title = element_text(
      family = "sans",
      hjust = 0.5,
      face = "bold",
      size = 10
    ),
    legend.text = element_text(
      family = "sans",
      size = rel(0.7)
    ),
    legend.title = element_blank(),
    plot.background = element_rect(fill = "cornsilk"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.background = element_rect(fill = "snow"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = rel(0.7)),
    axis.text = element_text(face = "bold", size = rel(0.7)),
  )
```

##### Summary Table 4.5

Under this climate scenario at Pathein, the following table depicts the
mean temperature variation among the different GCM/RCM models.

```{r Table2-1, include = TRUE}
pathein_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 1, padding = 1,
         caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

```{r include=FALSE}
pathein_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Mean Temperature at Pathein

```{r Fig2-4, fig.cap="Observed Vs. Projected Monthly Mean Temperature among GCM/RCMs at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future %>%
  mutate(Year = year(Date),
    Month = month(Date)) %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(3, "mm"), 
    legend.title = element_blank(),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "skyblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "yellow"),
    ## axis.text.x = element_blank()
  )

```

##### Observed vs. projected Monthly Mean Temperature by Models

```{r Fig2-5, fig.width = 8, fig.height = 10, fig.cap= "Observed vs. projected monthly mean temperature at Pathein Station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future %>%
  mutate(Year = year(Date),
    Month = month(Date)) %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits=abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "cornsilk"),
    plot.title = element_text(family = "sans",hjust = 0.5, face = "bold", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_text(family = "sans", size = 9),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )

```

##### Observed and Projected Annual Mean Temperature

```{r Fig2-6a, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future <- pathein_tmean_future %>%
  distinct() %>% 
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line()+
 geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "skyblue") +
   geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
    aes(x = Year, y = Ob_max), color = "skyblue") +
   geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
    aes(x = Year, y = Ob_min), color = "skyblue") +
  geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  geom_line(aes(x = Year, y = Max, color = Model), lty = "dotted") +
  geom_line(aes(x = Year, y = Min, color = Model), lty = "dotted") +
  # facet_wrap(~Model, scales = "free_y") +
  scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_bw() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(family = "sans",hjust = 0.5,face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```


##### Observed and Projected Annual Mean Temperature

```{r Fig2-6b, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
nb.cols <- 43
mycolors <- colorRampPalette(brewer.pal(12, "Paired"))(nb.cols)
pathein_tmean_future <- pathein_tmean_future %>%
  distinct() %>% 
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line()+
 geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "skyblue") +
  #  geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
  #   aes(x = Year, y = Ob_max), color = "skyblue") +
  #  geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
  #   aes(x = Year, y = Ob_min), color = "skyblue") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  # geom_line(aes(x = Year, y = Max, color = Model), lty = "dotted") +
  # 
  # geom_line(aes(x = Year, y = Min, color = Model), lty = "dotted") +
  # facet_wrap(~Model, scales = "free_y") +
  scale_color_manual(values = mycolors) +
 # scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_excel() +
  theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.title = element_text(family = "sans",hjust = 0.5,face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```


##### Observed and Projected Annual Mean Temperature by Model

```{r Fig2-7, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
nb.cols = 43
mycolors = colorRampPalette(brewer.pal(12, "Paired"))(nb.cols)

pathein_tmean_future <- pathein_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
   geom_line(data = pathein_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "skyblue") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  scale_color_manual(values = mycolors) +
  #scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

#### RCP8.5

##### Observed and Projected Daily Mean Temperature at Pathein Station

```{r, echo=FALSE, warning=FALSE, message=FALSE, include = FALSE}
pathein_tmean_85_1 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_85_2 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
pathein_tmean_85_3 <- pathein_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# pathein_tmean_85_1
# pathein_tmean_85_2
# pathein_tmean_85_3
pathein_tmean_future_85 <- rbind.data.frame(
  pathein_tmean_85_1,
  pathein_tmean_85_2,
  pathein_tmean_85_3
) %>% 
  distinct()
```

```{r Fig2-8, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future_85 <- pathein_tmean_future_85 %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmean.x), color = "black") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = 'Source: ECD-SNC, DMH'
  ) +
 theme(
    legend.position = "bottom",
    panel.background = element_blank(),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.title = element_text(
      family = "sans",
      hjust = 0.5,
      face = "bold",
      size = 10
    ),
    legend.text = element_text(family = "sans", size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
 )
```

##### Observed and Projected Daily Mean Temperature by Models

```{r Fig2-9, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future_85 <- pathein_tmean_future_85 %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = month(Date)
  )
pathein_tmean_future %>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dotted") +
  geom_line(aes(x = date, y = Tmean.x), color = "skyblue") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) + 
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = 'Source: ECD-SNC, DMH'
  ) +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.title = element_text(
      family = "sans",
      hjust = 0.5,
      face = "bold",
      size = 10
    ),
    legend.text = element_text(
      family = "sans",
      size = 7
    ),
    legend.title = element_text(
      family = "sans",
      size = 9
    ),
    legend.key.height = unit(0.4, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-2, include = TRUE}
pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 2,
         caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r include=FALSE}
pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Pathein** station, Ayeyarwaddy Region, Myanmar<br>"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed vs. projected Monthly Mean Temperature

```{r Fig2-10, fig.width=6, fig.height=4, fig.cap="Observed Vs. Projected Monthly Mean Temperature among GCM/RCMs at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
# pathein_tmean_future_85 <- pathein_tmean_future %>%
#   mutate(
#     Year = year(Date),
#     Month = month(Date)
#   )
pathein_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean), color = "skyblue", size = 1) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits=month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC"
  ) +
  theme_excel_new() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
    # # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig2-11, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Monthly Mean Temperature among GCM/RCMs - RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean)) +
  facet_wrap(~Model, scales = "free_y", ncol = 6) +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits=abb.month) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_excel_new() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed vs. Projected Annual Mean Temperature with extremes

```{r Fig2-12a, fig.retina = 3, fig.cap="Observed Vs Projected Annual Mean Temperature under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar"}
colorcount = length(unique(pathein_tmean_future_85$Model))
getpalette = colorRampPalette(brewer.pal(12, "Paired"))
pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model), alpha = 0.5) +
  geom_line() +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "skyblue") +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
            aes(x = Year, y = Ob_max), color = "skyblue") +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
            aes(x = Year, y = Ob_min), color = "skyblue") +
  #geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  scale_color_manual(values = getpalette(colorcount))+
  #scale_color_hue(l = 10) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_economist_white() +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "wheat", colour = "white"),
    plot.title = element_text(family = "sans",size = 10, face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

```
##### Observed Vs. Projected Daily Mean Temperature by Model

```{r Fig2-13, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Mean Temperature under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar"}
colorcount = length(unique(pathein_tmean_future_85$Model))
getpalette = colorRampPalette(brewer.pal(12, "Paired"))
pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "skyblue") +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
            aes(x = Year, y = Ob_max), color = "skyblue") +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
            aes(x = Year, y = Ob_min), color = "skyblue") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, scales = "free_y", ncol = 6) +
  scale_color_manual(values = getpalette(colorcount))+
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal()+
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "lightcyan", colour = "white"),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(family = "sans",size = 12, face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.text = element_text(size = 7, angle = 45),
    axis.title = element_text(size = 7)
  )
```



##### Observed vs. Projected Annual Mean Temperature without extremes

```{r Fig2-12b1, fig.retina = 3, fig.cap="Observed Vs Projected Annual Mean Temperature under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar"}
colorcount <- length(unique(pathein_tmean_future_85$Model))
getpalette <- colorRampPalette(brewer.pal(12, "Paired"))
pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model), alpha = 0.5) +
  geom_line() +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "skyblue") +
 # MetBrewer::scale_colour_met_d("Derain")+
  # geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
  #           aes(x = Year, y = Ob_max), color = "skyblue") +
  # geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
  #           aes(x = Year, y = Ob_min), color = "skyblue") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  #facet_wrap(~Model, scales = "free_y", strip.position = "right") +
  #scale_color_hue(l = 10) +
  scale_color_manual(values = getpalette(colorcount)) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_economist_white() +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "wheat", colour = "white"),
    plot.title = element_text(family = "sans",size = 10, face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

```



##### Observed vs. Projected Annual Mean Temperature without extremes

```{r Fig2-12b2,fig.width=8, fig.height=10, fig.retina = 3, fig.cap="Observed Vs Projected Annual Mean Temperature under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar"}

pathein_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>% 
  ggplot(aes(x = Year, y = Mean, color = Model), alpha = 0.5) +
  geom_line() +
  geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x)),
            aes(x = Year, y = Ob_mean), color = "skyblue") +
 # MetBrewer::scale_colour_met_d("Derain")+
  # geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmean.x)),
  #           aes(x = Year, y = Ob_max), color = "skyblue") +
  # geom_line(data = pathein_tmean_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmean.x)),
  #           aes(x = Year, y = Ob_min), color = "skyblue") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "skyblue") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  facet_wrap(~Model, ncol = 5) +
  #scale_color_hue(l = 10) +
  scale_color_manual(values = getpalette(colorcount)) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_economist_white() +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "wheat", colour = "white"),
    plot.title = element_text(family = "sans",size = 10, face = "bold", hjust = 0.5),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.text = element_text(face = "bold", size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(0.5, "mm"),
    legend.key.size = unit(2, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

```



#### Density Plot of Mean Temperature at Pathein Station

```{r Fig2-14, fig.width=10, fig.height=8, fig.cap="Density plot of Mean Temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(pathein_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(pathein_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Mean Temparature shift to Right from Baseline (1981-2010) \nat Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = pathein_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 3,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(pathein_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    pathein_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 3,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.3) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean$Tmean) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift to Right from Baseline (1981-2010) \nat Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = pathein_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 3,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
#knitr::knit.exit()
```

### Maximum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

#### Observed data

```{r}
pathein_tmax <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_maxTem.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
pathein_tmax["Date"] <- ymd(pathein_tmax$Date)
pathein_tmax$date <- pathein_tmax$Date
```

```{r Fig2-15, fig.width=5, fig.height=6, fig.cap="30 years observed maximum temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}

p1 <- pathein_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- pathein_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- pathein_tmax %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(tmax, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Pathein station, Ayeyarwaddy Region, Myanmar"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- pathein_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(adjust = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Distribution of Maximum Temperature at Pathein"
  ) +
  ggthemes::theme_clean() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )+
  geom_vline(xintercept = mean(pathein_tmax$Tmax), lty = "dotted", size = 0.7) +
  annotate("text", x = mean(pathein_tmax$Tmax)- 0.1, y = 0.01, label = paste(round(mean(pathein_tmax$Tmax), 2), "C"), size = 3)
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig2-16, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_1_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_1_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

pathein_tmax_45_1 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_45_2 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_45_3 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# pathein_tmax_45_1;pathein_tmax_45_2;pathein_tmax_45_3
pathein_tmax_future <- rbind.data.frame(
  pathein_tmax_45_1, 
  pathein_tmax_45_2, 
  pathein_tmax_45_3)
pathein_tmax_future <- pathein_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
pathein_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "black") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig2-17, fig.width = 8, fig.height = 10, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar"}
pathein_tmax_future <- pathein_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
pathein_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue", size = 7),
    strip.text = element_text(face = "bold", size = 7, color = "white")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-3, include = TRUE}
pathein_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 2,
         caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Pathein station, Ayeyarwaddy Region, Myanmar**") 
#%>% 
  # kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

There are 9 individual models which project future maximum temperature
exceeding 2 ºC in the course of 2100 as shown table above. The top 5
models are MIROC4H, GFDL-ESM2M, GFDL-ESM2G, WAS-44i-MIROCS-RCA4 and
CSIRO-MK3-6-0 representing 3.11, 3.05, 2.94, 2.42 and 2.39 ºC
respectively. The projected daily highest maximum temperature may be
reached up to 44.54 ºC which is `r 44.54-41.5` Degree above the observed
maximum temperature.

```{r include=FALSE}
pathein_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Pathein station, Ayeyarwaddy Region, Myanmar**"), 
  subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig2-18, fig.cap="Observed Vs. Projected Monthly Maximum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar"}
pathein_tmax_future %>%
  distinct() %>% 
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted") +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_color_manual(values = getpalette(colorcount)) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face ="bold", size = 7),
    # # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig2-19, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Maximum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar"}
pathein_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.5) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 20) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face ="bold", size = 7),
    axis.text.x = element_text(angle = 0)
  )
```

##### Observed Vs. Projected Annual Maximum Temperature at Pathein Station - with extremes

```{r Fig2-20a, fig.cap="Observed Vs. Projected Annual Maximum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
colorcount = length(unique(pathein_tmax_future$Model))

pathein_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 20) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 12),
    plot.background = element_rect(fill = "tan", colour = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
```

##### Observed Vs. Projected Annual Maximum Temperature by Model - with extremes

```{r Fig2-21a, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
   geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
  # geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 15) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "tan", colour = "white"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
```

##### Observed Vs. Projected Annual Maximum Temperature at Pathein Station - without extremes

```{r Fig2-20b, fig.cap="Observed Vs. Projected Annual Maximum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
colorcount = length(unique(pathein_tmax_future$Model))

pathein_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
  # geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
  # # geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 20) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 12),
    plot.background = element_rect(fill = "tan", colour = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
```

##### Observed Vs. Projected Annual Maximum Temperature by Model - without extremes

```{r Fig2-21b, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Maximum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
   geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
  # geom_line(data = pathein_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
  # # geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 15) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    plot.background = element_rect(fill = "tan", colour = "white"),
    panel.background = element_rect(fill = "white"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey85"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(3, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
```


#### RCP8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig2-22, fig.cap = "Observed and Projected Daily Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmax_1_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# pathein_tmax <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_maxTem.csv",
#   delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
# )
# pathein_tmax["Date"] <- ymd(pathein_tmax$Date)
pathein_tmax_85_1 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_85_2 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
pathein_tmax_85_3 <- pathein_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# pathein_tmax_85_1
# pathein_tmax_85_2
# pathein_tmax_85_3
pathein_tmax_future_85 <- rbind.data.frame(
  pathein_tmax_85_1, 
  pathein_tmax_85_2, 
  pathein_tmax_85_3
  )
pathein_tmax_future_85 <- pathein_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
pathein_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "lavenderblush"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig2-23, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Daily Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    panel.background = element_rect(fill = "lavenderblush"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", size = 12),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold",size = 12),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon"),
    axis.text = element_text(size = 7),
    axis.title = element_text(size = 7)
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-4, include = TRUE}
pathein_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 2,
         caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

As we can see in the above table, All 37 models reported that the future
maximum temperature change will be increased above 4 ºC. 8 models out of
37 are hotter than the rest of the models which ranges from 5.05 to 7.62
ºC. The top five models are MIROC4H, GFDL-ESM2M, GFDL-ESM2G,
WAS-44i-MIROC5-RCA4 and CSIRO-MK3-6-0 (as has been reported in RCP 4.5)
with the respective changes of 7.62, 7.46, 7.20, 5.94 and 5.86 ºC. Due
to these models projection, the expected future maximum temperature will
be range from 43 to 48 ºC which is 2 to 6.5 ºC above observed maximum
temperature (41.5 ºC.). The detailed comparison among model are shown as
follow.

```{r include=FALSE}
pathein_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Pathein** station, Ayeyarwaddy Region, Myanmar*"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed Vs. Projected Monthly Maximum Temperature

```{r Fig2-24, fig.cap="Observed Vs. Projected Monthly Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
colorcount = length(unique(pathein_tmax_future_85$Model))
pathein_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_color_manual(values = getpalette(colorcount)) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    panel.background = element_rect(fill = "lavenderblush"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold",size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold",size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # # axis.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Maximum Temperature by Model

```{r Fig2-25, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
colorcount <- length(unique(pathein_tmax_future_85$Model))
pathein_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 50) +
  scale_color_manual(values = getpalette(colorcount)) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "none",
    panel.background = element_rect(fill = "lavenderblush"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold",size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold",size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 5),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
   # # axis.text.x = element_blank()
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed Vs. Projected Annual Maximum Temperature with Extremes

```{r Fig2-26a, fig.cap="Observed Vs. Projected Annual Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
colorcount <- length(unique(pathein_tmax_future_85$Model))
pathein_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
   geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
   geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
#  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed Vs. Projected Annual Maximum Temperature by Model with Extreme

```{r Fig2-27a, fig.height=9, fig.width=7, fig.cap="Observed Vs. Projected Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
pathein_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
   geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
   geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
#  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 35) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", size = 7),
    axis.text = element_text(colour = "gray60", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```


##### Observed Vs. Projected Annual Maximum Temperature with Extremes

```{r Fig2-26b, fig.cap="Observed Vs. Projected Annual Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
colorcount <- length(unique(pathein_tmax_future_85$Model))
pathein_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
#    geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
#    geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
# #  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
#   geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
#   geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_bw() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed Vs. Projected Annual Maximum Temperature by Model with Extreme

```{r Fig2-27b, fig.height=9, fig.width=7, fig.cap="Observed Vs. Projected Maximum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
pathein_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
#    geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmax.x)), aes(x = Year, y = Ob_max), color = "grey60") +
#    geom_line(data = pathein_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmax.x)), aes(x = Year, y = Ob_min), color = "grey60") +
# #  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
#   geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
#   geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_manual(values = getpalette(colorcount)) +
  #scale_color_hue(l = 35) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
   legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", size = 7),
    axis.text = element_text(colour = "gray60", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```


#### Density plots for Maximum Temperature at Pathein Station with Extremes

```{r Fig2-28, fig.width=10, fig.height=8, fig.cap="Density plot for Maximum Temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(pathein_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmax$Tmax) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(pathein_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = pathein_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3,
      bins = 10) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(pathein_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmax_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3, 
    bins = 10
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    pathein_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = pathein_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(pathein_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(pathein_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

#### Observed data

```{r}
pathein_tmin <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
pathein_tmin["Date"] <- ymd(pathein_tmin$Date)
pathein_tmin$date <- pathein_tmin$Date
```

```{r Fig2-29, fig.width=5, fig.heigh=6, fig.cap="30 years observed minimum temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}

p1 <- pathein_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- pathein_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
     axis.text = element_text(size = 7),
    legend.key.height = unit(0.4, "mm"),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- pathein_tmin %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(tmin, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Minimum Temperature at Pathein station, Ayeyarwaddy Region, Myanmar"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
     axis.text = element_text(size = 7)
  )

p4 <- pathein_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(adjust = 3) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Density",
    title = "Probability Distribution of Minimum Temperature at Pathein"
  ) +
  geom_vline(xintercept = mean(pathein_tmin$Tmin), lty = "dotted", size = 0.7) +
  annotate("text", x = mean(pathein_tmin$Tmin), y = 0.01, label = paste(round(mean(pathein_tmin$Tmin), 2), "C"), size = 3)+
  ggthemes::theme_economist_white()+
  theme(
    plot.title = element_text(size = 10, hjust = 0.5),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig2-30, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_1_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# Tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_1_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


pathein_tmin_45_1 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_45_2 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_45_3 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_future <- rbind.data.frame(pathein_tmin_45_1, pathein_tmin_45_2, pathein_tmin_45_3)
pathein_tmin_future <- pathein_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
pathein_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig2-32, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x)) +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = 'grey60'),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-5, include = TRUE}
pathein_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 2,
         caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

According to the above mentioned table, 14 models are reported as models
which exceed 2 ºC under RCP 4.5. The top five models comprise
WAS-44i-MIROC5-RCA4, INMCM4, WAS-44i-EC-EARTH-RCA4,
WAS-44i-IPSL-CM5A-MR-RCA4 and WAS-44i-MPIESM-LR-RCA4 echoing regional
CORDEX models domination over GCMs. The highest expected minimum
temperature would be 31.38 ºC which is 2 ºC well above the long-term
observed minimum temperature (29 ºC).

```{r include=FALSE}
pathein_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Pathein** station, Ayeyarwaddy Region, Myanmar*"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature

```{r Fig2-33, fig.cap="Observed versus Projected Monthly Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmin_future %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
      legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    # # axis.text.x = element_blank(),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig2-34, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.7) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, ncol = 5)+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_clean() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "darkred")
  )
```

##### Observed vs. Projected Annual Minimum Temperature with Extreme

```{r Fig2-35, echo=FALSE, fig.cap="Observed vs. projected annual minimum temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}
colorcount <- length(unique(pathein_tmin_future$Model))
pathein_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  # geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)), aes(x = Year, y = Ob_max), color = "grey60") +
  # geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)), aes(x = Year, y = Ob_min), color = "grey60") +
  geom_line(aes(x = Year, y = Ob_mean), color = "grey60") +
  # geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  # geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_manual(values = getpalette(colorcount)) +
  # scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
      legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed vs. Projected Daily Mean Temperature by Model

```{r Fig2-36, fig.width=8, fig.height=10, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line() +
  geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)), aes(x = Year, y = ))
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "deeppink", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Annual Minimum Temperature (Time series)

```{r Fig2-37, echo=FALSE, fig.cap="Observed vs. projected annual minimum temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}
pathein_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size =0.2) +
  geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
   geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "darkolivegreen") +
   geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
      legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = 'grey60'),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed vs. Projected Daily Mean Temperature by Model (Time series)

```{r Fig2-38, fig.width=8, fig.height=10, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.5) +
  geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "darkolivegreen") +
  geom_line(data = pathein_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.5) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.5) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "darkolivegreen", size = 10),
   plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "deeppink", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig2-39, echo=FALSE, fig.cap = "Observed and Projected Daily Mininum temperature scenario with different GCMs/RCMs at Pathein station, Ayeyarwaddy Region, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmin_1_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

# pathein_tmin <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_minTem.csv",
#   delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
# )
# pathein_tmin["Date"] <- ymd(pathein_tmin$Date)
pathein_tmin_85_1 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_85_2 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
pathein_tmin_85_3 <- pathein_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# pathein_tmin_85_1
# pathein_tmin_85_2
# pathein_tmin_85_3
pathein_tmin_future_85 <- rbind.data.frame(
  pathein_tmin_85_1, 
  pathein_tmin_85_2, 
  pathein_tmin_85_3)
pathein_tmin_future_85 <- pathein_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
pathein_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 50)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
    
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig2-40, fig.width=10, fig.height=8, fig.cap="Observed and Projected Daily Mininum temperature  by GCMs (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar"}
pathein_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    capton = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-6, include = TRUE}
pathein_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 2,
         caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*") %>% 
  kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

Topmost GCM/RCMs for Minimum Temperature exceeding 4 ºC under RCP 8.5 by
2100 at Pathein station, Ayeyarwaddy Region, Myanmar

| Model                        | OMax | OMean | OMin | MMax | MMean | MMin | PMax  | PMean | PMin  |
|------------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| WAS-44i-MIROC5-RCA4          | 29   | 22.51 | 10   | 7.60 | 3.13  | 0.43 | 34.27 | 25.64 | 11.39 |
| INMCM4                       | 29   | 22.51 | 10   | 7.05 | 2.06  | 0.21 | 33.97 | 24.57 | 10.76 |
| WAS-44i-EC-EARTH-RCA4        | 29   | 22.51 | 10   | 6.74 | 2.44  | 0.34 | 32.37 | 24.95 | 11.23 |
| WAS-44i-IPSL-CM5A-MR-RCA4    | 29   | 22.51 | 10   | 6.37 | 2.44  | 0.30 | 32.78 | 24.95 | 10.72 |
| WAS-44i-MPI-ESM-LR-RCA4      | 29   | 22.51 | 10   | 6.35 | 2.50  | 0.36 | 33.38 | 25.01 | 10.86 |
| CSIRO-MK3-6-0                | 29   | 22.51 | 10   | 6.23 | 2.42  | 0.29 | 33.15 | 24.94 | 11.14 |
| MIROC4H                      | 29   | 22.51 | 10   | 6.01 | 2.33  | 0.29 | 32.79 | 24.85 | 10.89 |
| GISS-E2-R-CC                 | 29   | 22.51 | 10   | 5.46 | 2.14  | 0.30 | 32.17 | 24.66 | 10.92 |
| HADGEM2-ES                   | 29   | 22.52 | 10   | 5.37 | 1.92  | 0.23 | 31.98 | 24.44 | 10.90 |
| GFDL-ESM2G                   | 29   | 22.51 | 10   | 5.34 | 2.00  | 0.20 | 33.22 | 24.51 | 10.53 |
| EAS-HADGEM2-AO-RegCM_v4      | 29   | 22.51 | 10   | 5.32 | 1.99  | 0.25 | 32.16 | 24.51 | 10.74 |
| EAS-HADGEM2-AO-HADGEM3-RA_v1 | 29   | 22.51 | 10   | 5.17 | 2.00  | 0.28 | 31.96 | 24.51 | 10.84 |
| GFDL-ESM2M                   | 29   | 22.51 | 10   | 4.98 | 1.85  | 0.11 | 32.92 | 24.36 | 10.74 |
| MIROC5                       | 29   | 22.51 | 10   | 4.91 | 1.96  | 0.28 | 31.54 | 24.47 | 10.81 |
| GISS-E2-R                    | 29   | 22.51 | 10   | 4.80 | 2.01  | 0.29 | 32.02 | 24.52 | 10.83 |
| HADGEM2-CC                   | 29   | 22.51 | 10   | 4.74 | 1.73  | 0.22 | 31.26 | 24.25 | 10.87 |
| EAS-EC-EARTH-HIRHAM5_v1      | 29   | 22.51 | 10   | 4.72 | 1.59  | 0.13 | 31.78 | 24.10 | 10.28 |
| MPI-ESM-MR                   | 29   | 22.51 | 10   | 4.65 | 1.85  | 0.24 | 32.64 | 24.36 | 10.75 |
| IPSL-CM5A-LR                 | 29   | 22.51 | 10   | 4.56 | 1.77  | 0.20 | 31.99 | 24.28 | 10.43 |
| GISS-E2-H                    | 29   | 22.51 | 10   | 4.52 | 1.77  | 0.26 | 31.54 | 24.28 | 10.55 |

```{r include=FALSE}
pathein_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Pathein** station, Ayeyarwaddy Region, Myanmar"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig2-41, fig.cap="Observed vs. Projected Monthly Minimum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_jitter(lty  = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig2-42, fig.width=10, fig.height=8, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 8.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_tmin_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_jitter(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean)) +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_economist_white() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed vs. Projected Annual Minimum Temperature

```{r Fig2-43, echo=FALSE, fig.cap="Future Minimum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
pathein_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x =Year, y = Ob_mean)) +
  geom_line(aes(x = Year, y = Max, color = Model), lty = "dashed", alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), lty = "dashed", alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
  legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed vs. Projected Annual Minimum Temperature by Model

```{r Fig2-44, fig.width=7, fig.height=9, fig.cap="Observed and Projected Minimum Temperature under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar under different GCMs 2011-2100"}
pathein_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean)) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
     legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.caption = element_text(face  = "bold", size = 7, color = "grey60"),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

#### Density plots for Minimum Temperature

```{r Fig2-45, fig.width=10, fig.height=8, fig.cap= "Density plots for Minimum Temperature at Pathein station, Ayeyarwaddy Region, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(pathein_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(pathein_tmin$Tmin) -0.2, 2)), 
           y = 0.10, 
           label = paste(round(mean(pathein_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(pathein_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(pathein_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(pathein_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(pathein_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = pathein_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(pathein_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(pathein_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(pathein_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(pathein_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmin_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(pathein_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(pathein_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(pathein_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(pathein_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(pathein_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =pathein_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(pathein_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmin
p2 <-  ggplot(
    pathein_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(pathein_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(pathein_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(pathein_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Pathein station, Ayeyarwaddy Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = pathein_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(pathein_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(pathein_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = pathein_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(pathein_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(pathein_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =pathein_tmin_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(pathein_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(pathein_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(pathein_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(pathein_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(pathein_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Data

```{r}
pathein_preci <- vroom::vroom("data/Area-1/Pathein/clean_Pathein_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
pathein_preci["Date"] <- ymd(pathein_preci$Date)
# checking NA values
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))]),]
## One day before to NA value
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))] -1),]
## One day after to NA value
#pathein_preci[pathein_preci$Date %in% (pathein_preci$Date[(which(is.na(pathein_preci$preci)))] +1),]
pathein_preci <- pathein_preci %>% mutate(
  preci = Hmisc::impute(preci, "random")
)
pathein_preci$date <- pathein_preci$Date

# pathein_preci %>% 
#   mutate(Year = year(Date),
#          Month = month(Date)) %>%
#   filter(Year %in% c(1984, 1988, 2003, 2005) & Month %in% c(2, 5) & preci > 0) %>%
#   group_by(Year, Month, preci) %>%
#   summarize(
#     n = sum(n())
#   )
```

```{r Fig2-46, fig.width=6, fig.height=8, fig.retina=2, fig.cap="30 years observed precipitation at Pathein Station, Ayeyarwaddy Region, Myanmar"}
p1 <- pathein_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Observed maximum precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  )
p2 <- pathein_preci %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = as.factor(Month))) +
   geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", 
    y = "Precipitation in mm",
    title = "Observed Monthly Total Precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7),
    axis.text.x = element_text(angle = 45)
  )
p3 <-  pathein_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Annual Precipitation at Pathein Stataion over 30 years (1981-2010)",
      caption = "Source: DMH, 2019") + 
ggthemes::theme_tufte() +
   theme( legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
    axis.text = element_text(size = 7)
  )
  
p4 <-  pathein_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2) +
    # scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept =log10(mean(pathein_preci$preci)), lty = "dotted", size = 0.5) +
  annotate(
    "text",
    x = log10(mean(pathein_preci$preci)),
    y = 0.15,
    label = paste(round(10 ^ log10(mean(pathein_preci$preci)),2), "mm"),
    size = 3
  )+
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Density",
      title = "Precipitation at Pathein Stataion over 30 years (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(legend.position = "none", 
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(size = 7),
    axis.text = element_text(size =7))
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily precipitation at Pathein Station

```{r}
files <- fs::dir_ls(glob = "*precip_1_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_1_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

pathein_preci_45_1 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_45_2 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
pathein_preci_45_3 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# pathein_tmin_45_1;pathein_tmin_45_2;pathein_tmin_45_3
pathein_preci_future <- rbind.data.frame(
  pathein_preci_45_1, 
  pathein_preci_45_2, 
  pathein_preci_45_3)
pathein_preci_future <- pathein_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()

```

```{r Fig2-47, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_preci_future %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed") +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 5),
    plot.background = element_rect(fill = "cornsilk", colour = "white"),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    axis.title = element_text(colour = "black", face = "bold", size = 7),
    axis.text = element_text(colour = "darkred", face = "bold", size = 7),
    panel.background = element_rect(fill = "white"),
    plot.title = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    plot.subtitle = element_text(hjust = 0.5, family = "sans", face = "bold", color = "blue", size = 10),
    strip.background = element_rect(fill = "lightsteelblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "maroon")
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig2-48, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Pathein station, Ayeyarwaddy Region, Myanmar during 2011-2100"}
pathein_preci_future %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue")+
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.text = element_text(family = "sans", size = 6),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 9),
    axis.text = element_text(size =9),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 8, color = "white smoke")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-7, include = TRUE}
pathein_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Pathein Station**, Ayeyarwaddy Region, Myanmar <br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
  
```

```{r include=FALSE}
pathein_preci_future %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 50.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Pathein Station**, Ayeyarwaddy Region"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 50
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 178.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 178.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Max, Observed_Mean, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Daily Max (mm)**"),
    Observed_Mean = md("**Observed Monthly Mean (mm)**"),
    Observed_Total = md("**Observed Annual Total (mm)**"), 
    Model_Max = md("**Model Max % change**"),
    Model_Mean = md("**Model Mean % change**"),
    Model_Min = md("**Model Min % change**"),
    Projected_Max = md("**Projected Daily Max (mm)**"),
    Projected_Mean = md("**Projected Monthly Mean (mm)**"),
    Projected_Total = md("**Projected Annual Total (mm)**")
  )

# pathein_yearly_summary <- pathein_preci %>%
#      mutate(
#     Year = year(Date),
#   Month = month(Date)) %>%
#    group_by(Year, Month) %>%
#    summarize(Total = sum(preci),
#                n = n())
# 
# ggplot(pathein_yearly_summary, aes(x = Year, y = Total, fill = as.factor(n)))+
#   geom_col() +
#   geom_hline(yintercept = mean(pathein_yearly_summary$Total))+
#   annotate("text", x = 2003, y = mean(pathein_yearly_summary$Total) + 200,
#            label = paste("The average monlty rainfall in Pathein is ", mean(pathein_yearly_summary$Total), " mm."))

```

##### Observed and Projected Monthly Precipitation

```{r Fig2-49, echo=FALSE, fig.width = 6, fig.height = 4, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.3) +
  geom_line(aes(x = Month, y = Ob_total), color = "deeppink") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.margin = margin(0, 35, 0, 0, "pt"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.caption = element_text(face = "bold", size = 7, color = "grey60"),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60")
  )
```

##### Observed Vs. Projected Monthly Precipitation by Model

```{r Fig2-50, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 4.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.3) +
  geom_line(aes(x = Month, y = Ob_total)) +
  scale_color_hue(l = 50) +
  scale_x_discrete(abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation

```{r Fig2-51, fig.cap="Observed vs. Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation by Model (1)

```{r Fig2-52, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed vs. Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig2-53, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = pathein_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation by Model (Time Series)

```{r Fig2-54, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),

    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = pathein_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_1_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")


pathein_preci_85_1 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
pathein_preci_85_2 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
pathein_preci_85_3 <- pathein_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# pathein_preci_85_1
# pathein_preci_85_2
# pathein_preci_85_3
pathein_preci_future_85 <- rbind.data.frame(
  pathein_preci_85_1, 
  pathein_preci_85_2, 
  pathein_preci_85_3)
pathein_preci_future_85 <- pathein_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()

```

```{r Fig2-55, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Pathein station, Ayeyarwaddy Region, Myanmar (RCP 8.5)"}
pathein_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deeppink") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
   theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Precipitation by Model

```{r Fig2-56, fig.width=7, fig.height=9, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Pathein station, Ayeyarwaddy Region, Myanmar (RCP 8.5)"}
pathein_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total = sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deeppink") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y")+
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the precipitation
variation among the different GCM/RCM models.

```{r Table2-8, include = TRUE}
pathein_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
   OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 100.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Pathein station**, Ayeyarwaddy Region, Myanmar")
```

```{r include=FALSE}
pathein_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(preci.x, na.rm = TRUE),
    Observed_Mean = sum(preci.x, na.rm = TRUE)/90/12,
    Observed_Total = sum(preci.x, na.rm = TRUE)/90,
    Model_Max = max(preci.y, na.rm = TRUE),
    Model_Mean = mean(preci.y, na.rm = TRUE),
    Model_Min = min(preci.y, na.rm = TRUE),
    Projected_Max = max(future, na.rm = TRUE),
    Projected_Mean = sum(future, na.rm = TRUE)/90/12,
    Projected_Total = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(Model_Max > 100.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*"), subtitle = md("Arranged by descending order of Max of Precipitation")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 100
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Total),
      rows = Projected_Max > 240.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Total),
      rows = Observed_Max >= 240.0)
    ) %>% 
  fmt_number(
    columns = c(Observed_Mean, Observed_Max, Observed_Total, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Total), 
    decimals = 2
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Total = md("**Observed Total**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Total = md("**Projected Total**")
  )
```

##### Observed and Projected Monthly Precipitation

```{r Fig2-57, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100 by Models"}
pathein_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.3) +
  geom_line(aes(x = Month, y = Ob_total), color = "deeppink") +
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Monthly Precipitation by models

```{r Fig2-58, fig.width=7, fig.height=9, fig.retina=2, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100 by Models"}
pathein_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.9) +
  
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  geom_line(aes(x = Month, y = Ob_total), color = "deeppink") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation

```{r Fig2-59, fig.cap="Observed Vs. Projected Precipitation under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100 by Models"}
pathein_preci_future_85 %>%
  distinct() %>% 
  #filter(Model %in% c("ACCESS1-3", "BNU-ESM")) %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue") +
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  scale_color_hue(l = 50) +
  #facet_wrap(~Model, scales = "free_y") +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation by models

```{r Fig2-60, fig.width=7, fig.height=9, fig.cap="Observed Vs. Projected Precipitation under RCP 8.5 at Pathein station, Ayeyarwaddy Region, Myanmar 2011-2100 by Models"}
pathein_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_total), color = "darkblue", alpha = 0.9) +
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

```{r}
#knitr::knit_exit(append, fully = TRUE)
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig2-61, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100"}
pathein_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = pathein_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# knitr::knit_exit()
```

##### Observed and Projected Annual Precipitation by Model (Time Series)

```{r Fig2-62, fig.width=8, fig.height=10, fig.retina=2, fig.cap = "Observed and Projected Annual Precipitation under RCP 8.5 at Pathein Station, Ayeyarwaddy Region, Myanmar 2011-2100" }
pathein_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),

    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = pathein_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

## Tanintharyi Region

### Mean Temperature

#### Observed Data

```{r Fig2-63, echo=FALSE, fig.height=4, fig.width=5, fig.cap="30 years observed mean temperature at Dawei station, Tanintharyi Region, Myanmar"}
mon <- c(
  "Jan", "Feb", "Mar", "Apr", "May", "Jun",
  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
)
dawei_tmean <- vroom::vroom("data/Area-1/Dawei/clean_dawei_meanTem_edited.csv",
  delim = ",", col_names = c("Date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
dawei_tmean["Date"] <- ymd(dawei_tmean$Date)
dawei_tmean$date <- dawei_tmean$Date

p1 <- dawei_tmean %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- dawei_tmean %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- dawei_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Mean Temperature at Dawei Station"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- dawei_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  geom_vline(xintercept = mean(dawei_tmean$Tmean), lty = "dotted", size = 1) +
  annotate("text", 
           x = round(mean(dawei_tmean$Tmean), 2),
           y = 0.03, label = paste(round(mean(dawei_tmean$Tmean), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability Density",
    title = "Probability Distribution of Observed Data at Dawei"
  )+theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  
  
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))

```

#### RCP4.5

##### Observed and Projected Daily Mean Temperature

```{r Fig2-64, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Dawei Station during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_18_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
#tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_18_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")


# dawei_tmean <- dawei_tmean[,-6:-3]
dawei_tmean_45_1 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_45_2 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_45_3 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# dawei_tmean_45_1
# dawei_tmean_45_2
# dawei_tmean_45_3
dawei_tmean_future <- rbind.data.frame(
  dawei_tmean_45_1, 
  dawei_tmean_45_2, 
  dawei_tmean_45_3)
dawei_tmean_future <- dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
dawei_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
  )

```

##### Observed versus Projected Daily Mean Temperture by Model

```{r Fig2-65, fig.width=7, fig.height=9, fig.cap="Observed Versus Projected Daily Mean Temperature (RCP 4.5) at Dawei Station during 2011-2100"}
dawei_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkolivegreen")+
  scale_color_hue(l = 25)+
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_text(family = "sans", size = 9),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkblue"),
    strip.text = element_text(face = "bold", size = 7, color = "whitesmoke")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-9, include = TRUE}
dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(10) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*") 
#%>% 
  #kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r include=FALSE}
dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Pathein station, Ayeyarwaddy Region, Myanmar*"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig2-70, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
    ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    ## axis.text.x = element_blank()
    )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig2-71, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y") +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig2-72, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
    ## axis.text.x = element_blank()
    )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig2-73, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature (Time Series)

```{r Fig2-74, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm = TRUE)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen")+
  scale_color_hue(l = 45) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
    ## axis.text.x = element_blank()
    )
```

##### Observed and Projected Annual Mean Temperature by Model (Time Series)

```{r Fig2-75, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future)
            ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(
    data = dawei_tmean_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmean.x, na.rm = TRUE)), aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
    ## axis.text.x = element_blank()
  )
```

#### RCP8.5

##### Observed and Projected Daily Mean Temperature

```{r}
dawei_tmean_85_1 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_85_2 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
dawei_tmean_85_3 <- dawei_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# dawei_tmean_85_1
# dawei_tmean_85_2
# dawei_tmean_85_3
dawei_tmean_future_85 <- rbind.data.frame(
  dawei_tmean_85_1, 
  dawei_tmean_85_2, 
  dawei_tmean_85_3
  )
```

```{r Fig2-76, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future_85 <- dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
dawei_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  scale_color_hue(l = 50) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(dawei_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig2-77, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future_85 <- dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%  distinct()
dawei_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = date, y = future, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "maroon") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales="free_y", ncol = 5) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(dawei_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
  legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_text(family = "sans", size = 9),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-10, include = TRUE}
dawei_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(10) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r include=FALSE}
dawei_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei Station*"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig2-78, fig.cap="Observed and projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}

dawei_tmean_future_85 <- dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
dawei_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(dawei_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(family = "sans", hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(family = "sans", size = 7),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig2-79, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmean_future_85 <- dawei_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
dawei_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y") +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(dawei_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow"),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean, Max, Min of Mean Temperature

```{r Fig2-80, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Daily Mean Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar"}
# colorcount = length(unique(dawei_tmean_future_85$Model))
# colorPalette = colorRampPalette(RColorBrewer::brewer.pal(43, "Set1"))
dawei_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Mean Temperature by model

```{r Fig2-81, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Mean Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x, na.rm = TRUE),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", strip.position = "right", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
    legend.text = element_text(family = "sans", size = 6),
    legend.key.height = unit(0.4, "mm"),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size =  7),
    strip.background = element_rect(fill = "darkblue", color = "darkgreen"),
    strip.text = element_text(face = "bold", size = 8, color = "snow")
   # # axis.text.x = element_blank()
  )
```

#### Density Plot of Mean Temperature - Dawei Station

```{r Fig2-82, fig.width=10, fig.height=8, fig.cap="Mean temperature shift to right from baseline (1981-2010) under RCP 4.5 and 8.5 at Dawei station, Tanintharyi Region, Myanmar"}
####  Density Plot for Dawei station, Tanintharyi Region, Myanmar

### RCP 4.5
p1 <- ggplot(dawei_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(dawei_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift from Baseline (1981-2010) at **Dawei** station, Tanintharyi Region, Myanmar \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = dawei_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmean_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(dawei_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =dawei_tmean_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    dawei_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean$Tmean) - 0.2, 2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Temparature shift from Baseline (1981-2010) at **Dawei** station, Tanintharyi Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = dawei_tmean_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(min(dawei_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmean_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5, 
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(dawei_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =dawei_tmean_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

#### Observed data

```{r}
dawei_tmax <- vroom::vroom("data/Area-1/Dawei/clean_dawei_maxTem_edited.csv",
  delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
dawei_tmax["Date"] <- ymd(dawei_tmax$Date)
dawei_tmax$date <- dawei_tmax$Date
```

```{r Fig2-83, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="30 years observed maximum temperature at Dawei station, Tanintharyi Region, Myanmar"}

p1 <- dawei_tmax %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- dawei_tmax %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- dawei_tmax %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmax, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Dawei Station"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- dawei_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Density",
    title = "Probability Distribution of Maximum Temperature at Dawei"
  ) +
  geom_vline(xintercept = mean(dawei_tmax$Tmax), lty = "dotted", size = 0.7)+
  annotate("text", x = mean(dawei_tmax$Tmax), y = 0.2, label = paste(round(mean(dawei_tmax$Tmax), 2), "C"), size = 3, angle = 90) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig2-84, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_18_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_18_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

dawei_tmax_45_1 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_45_2 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_45_3 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# dawei_tmax_45_1;dawei_tmax_45_2;dawei_tmax_45_3
dawei_tmax_future <- rbind.data.frame(
  dawei_tmax_45_1, 
  dawei_tmax_45_2, 
  dawei_tmax_45_3
  )
dawei_tmax_future <- dawei_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
dawei_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dotted", size = 0.3) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig2-85, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-11, include = TRUE}
dawei_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r include=FALSE}
dawei_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei Station*"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature

```{r Fig2-86, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region"}
dawei_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
)
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig2-87, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean),color = "darkolivegreen") +
  scale_color_hue(l = 50) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

##### Observed vs. Projected Annual Maximum Temperature

```{r Fig2-88, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed vs. Projected Maximum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

##### Observed vs. Projected Annual Maximum Temperature by Model

```{r Fig2-89, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Maximum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

##### Observed vs. Projected Annual Maximum Temperature (Time Series)

```{r Fig2-90, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed vs. Projected Maximum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

##### Observed vs. Projected Annual Maximum Temperature by Model (Time Series)

```{r Fig2-91, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Maximum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar"}
dawei_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmax_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

#### RCP8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig2-92, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Daily Maximum temperature mong different GCMs  at Dawei station, Tanintharyi  Region, Myanmar (RCP 8.5) "}
files <- fs::dir_ls(glob = "*tmax_18_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# dawei_tmax <- vroom::vroom("data/Area-1/Dawei/clean_dawei_maxTem_edited.csv",
#   delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE
# )
# dawei_tmax["Date"] <- ymd(dawei_tmax$Date)
dawei_tmax_85_1 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_85_2 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
dawei_tmax_85_3 <- dawei_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# dawei_tmax_85_1
# dawei_tmax_85_2
# dawei_tmax_85_3
dawei_tmax_future_85 <- rbind.data.frame(
  dawei_tmax_85_1, 
  dawei_tmax_85_2, 
  dawei_tmax_85_3
  )
dawei_tmax_future_85 <- dawei_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
dawei_tmax_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig2-93, fig.width=10, fig.height=8, fig.cap="Observed and Projected Daily Maximum  temperature among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_tmax_future_85 %>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table2-12, include = TRUE}
dawei_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r, include=FALSE}
dawei_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Dawei Station*"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature

```{r Fig2-94, fig.cap="Observed vs. projected monthly Maximum  temperature scenario variation among different GCMs at Pathein station, Ayeyarwaddy Region, Myanmar (RCP 8.5)"}
dawei_tmax_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Monthly Maximum Temperature by Model

```{r Fig2-95, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Monthly Maximum Temperature among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_tmax_future_85 %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
    )
```

##### Observed vs Projected Annual Maximum Temperature

```{r Fig2-96, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed Vs. Projected Maximum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region under different GCMs 2011-2100"}
dawei_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs Projected Annual Maximum Temperature by Model

```{r Fig2-97, fig.width=7, fig.height=9, fig.cap="Observed Vs. Projected Maximum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region under different GCMs 2011-2100"}
dawei_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Maximum Temperature (Time Series)

```{r Fig2-98, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Maximum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region under different GCMs 2011-2100"}
dawei_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Maximum Temperature by Model (Time Series)

```{r Fig2-99, fig.width=7, fig.height=9, fig.cap="Observed Vs. Projected Maximum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region under different GCMs 2011-2100"}
dawei_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmax_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### Density plots for Maximum Temperature

```{r Fig2-100, fig.width=10, fig.height=8, fig.cap="Maximum temperature Mean shift to right from the baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar"}
####  Density Plot for Dawei station, Tanintharyi Region, Myanmar

### RCP 4.5
p1 <- ggplot(dawei_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmax$Tmax) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(dawei_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = dawei_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmax_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(dawei_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =dawei_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    dawei_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = dawei_tmax_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(dawei_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmax_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(dawei_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =dawei_tmax_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(dawei_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

#### Observed data

```{r}
dawei_tmin <- vroom::vroom("data/Area-1/Dawei/clean_dawei_minTem.csv",
  delim = " ", col_names = c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
dawei_tmin["Date"] <- ymd(dawei_tmin$Date)
dawei_tmin$date <- dawei_tmin$Date
# Here one month is missing, thus the same month from the previous year is copied
# missing_date <- seq(as.Date("1988-09-01"), as.Date("1988-09-30"), by ="days")
# Tmin <- dawei_tmin$tmin[2435:2464]
# missing <- cbind.data.frame(missing_date, Tmin)
# names(missing) <-c("Date", "Tmin")
# dawei_tmin <- union(dawei_tmin, missing)
```

```{r Fig2-101, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="30 years observed minimum temperature at Dawei station, Tanintharyi Region, Myanmar"}
p1 <- dawei_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Observed and Projected Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
   axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- dawei_tmin %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Observed and Projected Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- dawei_tmin %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(tmin, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimum Temperature at Dawei Station"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- dawei_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "density",
    title = "Probability Distribution of Minimum Temperature at Dawei"
  ) +
  geom_vline(xintercept = mean(dawei_tmin$Tmin), lty = "dotted", size = 0.7) +
  annotate("text", x = mean(dawei_tmin$Tmin) - 0.2, y = 0.1, label = paste(round(mean(dawei_tmin$Tmin), 2), "C"),
           size = 3, angle = 90) +
  ggthemes::theme_economist_white()+
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig2-102, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_18_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# Tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_18_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")


dawei_tmin_45_1 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_45_2 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_45_3 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# dawei_tmin_45_1;dawei_tmin_45_2;dawei_tmin_45_3
dawei_tmin_future <- rbind.data.frame(
  dawei_tmin_45_1, 
  dawei_tmin_45_2, 
  dawei_tmin_45_3)
dawei_tmin_future <- dawei_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
dawei_tmin_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(0.4, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 6),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig2-103, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmin_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

```{r Table2-13, include = TRUE}
dawei_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(10) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))

```

```{r, include=FALSE}
dawei_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Dawei Station*"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature

```{r Fig2-104, fig.cap="Observed Vs. Projected Monthly Minimum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmin_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig2-105, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Minimum Temperature (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_tmin_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig2-106, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# Biofuel Potential in Southeastern Asia
```

##### Observed vs. Projected Annual Mean, Max, Min of Minimum Temperature by Model

```{r Fig2-107, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# Biofuel Potential in Southeastern Asia
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature (Time Series)

```{r Fig2-108, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# Biofuel Potential in Southeastern Asia
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature by Model (Time Series)

```{r Fig2-109, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 4.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmin_future %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# Biofuel Potential in Southeastern Asia
```

#### RCP8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig2-110, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmin_18_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <-c("Date", "Tmin", "Model")

# dawei_tmin <- vroom::vroom("data/Area-1/Dawei/clean_dawei_minTem.csv",
#   delim = " ", col_names =c("Date", "Tmin"), na = "-999.0", show_col_types = FALSE
# )
# dawei_tmin["Date"] <- ymd(dawei_tmin$Date)
# Here one month is missing, thus the same month from the previous year is copied
# missing_date <- seq(as.Date("1988-09-01"), as.Date("1988-09-30"), by ="days")
# Tmin <- dawei_tmin$tmin[2435:2464]
# missing <- cbind.data.frame(missing_date, Tmin)
# names(missing) <-c("Date", "Tmin")
# dawei_tmin <- union(dawei_tmin, missing)
dawei_tmin_85_1 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_85_2 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
dawei_tmin_85_3 <- dawei_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# dawei_tmin_85_1
# dawei_tmin_85_2
# dawei_tmin_85_3
dawei_tmin_future_85 <- rbind.data.frame(
  dawei_tmin_85_1, 
  dawei_tmin_85_2, 
  dawei_tmin_85_3)
dawei_tmin_future_85 <- dawei_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
dawei_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig2-111, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum temperature among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

```{r Table1-14, include = TRUE}
dawei_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Dawei station, Tanintharyi Region, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r include=FALSE}
dawei_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Dawei Station*"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature at Dawei Station

```{r Fig1-112, fig.cap="Observed vs. Projected Monthly Minimum temperature among different GCMs at Dawei station, Tanintharyi Region (RCP 8.5)"}
dawei_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkolivegreen") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
  legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
   # # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. Projected Monthly Minimum Temperature by Model

```{r Fig1-113, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Minimum temperature among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-114, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar under different GCMs"}
dawei_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
    geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    subtitle = "2011-2100",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature

```{r Fig1-115, fig.width=7, fig.height=9, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar under different GCMs"}
dawei_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmin.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
    geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    subtitle = "2011-2100",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature (Time Series)

```{r Fig1-116, fig.cap="Observed vs. Projected Annual Minimum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar under different GCMs 2011-2100"}
dawei_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
    geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature (Time Series)

```{r Fig1-117, fig.width=7, fig.height=9, fig.cap="Observed and Projected Annual Minimum Temperature under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar under different GCMs"}
dawei_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(data = dawei_tmin_future_85 %>% mutate(Year = year(date)) %>% group_by(Model, Year) %>% summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "darkolivegreen") +
    geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.9) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    subtitle = "2011-2100",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme(
    legend.position = "top",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkolivegreen", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-118, fig.width=10, fig.height=8, fig.cap="Mean shift to right from baseline (1981-2010) of minimum temperature at Dawei station, Tanintharyi Region, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(dawei_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.5) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(dawei_tmin$Tmin) -0.2, 2)), 
           y = 0.10, 
           label = paste(round(mean(dawei_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(dawei_tmin$Tmin) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(dawei_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(dawei_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(dawei_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = "Future Minimum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 4.5"
  ) +
  
  geom_density(
    data = dawei_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(dawei_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(dawei_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(dawei_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(dawei_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(dawei_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(dawei_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(dawei_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(dawei_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(dawei_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmin_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(dawei_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(dawei_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Dawei Tmin
p2 <-  ggplot(
    dawei_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(dawei_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(dawei_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Dawei station, Tanintharyi Region, Myanmar, \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = dawei_tmin_85_1, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(dawei_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = dawei_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(dawei_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(dawei_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data = dawei_tmin_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(dawei_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(dawei_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(dawei_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(dawei_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(dawei_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Data

```{r}
dawei_preci <- vroom::vroom("data/Area-1/Dawei/clean_dawei_rainfall.csv",
  delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
)
dawei_preci["Date"] <- ymd(dawei_preci$Date)
dawei_preci$date <- dawei_preci$Date
```

```{r Fig1-119, fig.width=6, fig.height=8, fig.retina=2, fig.cap= "30 years observed precipitation data at Dawei station, Tanintharyi Region, Myanmar"}
p1 <- dawei_preci %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = Month)) +
  geom_jitter() +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed Maximum precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p2 <- dawei_preci %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Month)) +
   geom_boxplot() +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed Total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p3 <-  dawei_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Monthly Precipatation at Dawei Stataion over last 30 years (1981-2010)",
      caption = "Source: DMH, 2019") + 
ggthemes::theme_tufte() +
   theme( legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
    )
  
p4 <-  dawei_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
  ggplot(aes(x= log10(preci), y = ..density..)) +
  geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2, bins = 50) +
    # scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(dawei_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(dawei_preci$preci) - 1), y = 0.3, label = paste(round(mean(dawei_preci$preci), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Prob. Density",
      title = "Probability Distribution of Precipatation at Dawei Stataion (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily precipitation

```{r}
files <- fs::dir_ls(glob = "*precip_18_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_18_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

dawei_preci_45_1 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_45_2 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
dawei_preci_45_3 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# dawei_tmin_45_1;dawei_tmin_45_2;dawei_tmin_45_3
dawei_preci_future <- rbind.data.frame(
  dawei_preci_45_1, 
  dawei_preci_45_2, 
  dawei_preci_45_3)
dawei_preci_future <- dawei_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-120, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Dawei Station, Tanintharyi Region during 2011-2100"}
dawei_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x),color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    # axis.text.x = element_blank(),
    strip.background = element_rect(fill = "deepskyblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and projected Daily Precipitation by Model

```{r Fig1-121, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
  theme(
      legend.position = "none",
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.title = element_blank(),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    ## axis.text.x = element_blank(),
    strip.background = element_rect(fill = "darkblue", color = "white"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-15, include = TRUE}
dawei_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Dawei Station**, Tanintharyi Region, Myanmar") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
  
```

```{r include=FALSE}
dawei_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Max = max(preci.y),
    Mean = mean(preci.y),
    Min = min(preci.y)
  ) %>%
  filter(Max > 50) %>%
  arrange(desc(Max)) %>%
  # head(10) %>%
  gt::gt() %>%
  gt::tab_header(title = "Topmost GCM/RCM for Max, Mean and Min of Precipitation Change in %  under RCP 4.5 by 2100 at Dawei Station",
                 subtitle = "Arranged by descending order of Max of Precipitation Change in %")
```

##### Observed Vs. Projected Monthly Precipitation at Dawei Station

```{r Fig1-122, fig.cap="Observed vs. Projected Monthly Precipitation (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Month) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(lty = 'dashed') +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = "Precipitation in mm"
  ) +
theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    #strip.text.x = element_blank()
  )
```

##### Observed Vs. Projected Monthly Precipitation by Model

```{r Fig1-123, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Precipitation (RCP 4.5) at Dawei Station, Tanintharyi Region, Myanmar during 2011-2100"}
dawei_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  group_by(Model, Month) %>%
  summarize(
    Max = max(future, na.rm = TRUE),
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter() +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = "Precipitation in mm"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation (1)

```{r Fig1-124, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed vs. Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation by Model (1)

```{r Fig1-125, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig1-126, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = dawei_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation by Model (Time Series)

```{r Fig1-127, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 \nat Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),

    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = dawei_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation

```{r, echo=FALSE, message=FALSE, warning=FALSE}
files <- fs::dir_ls(glob = "*precip_1_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")
# 
# dawei_preci <- vroom::vroom("data/Area-1/Dawei/clean_dawei_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# dawei_preci["Date"] <- ymd(dawei_preci$Date)
dawei_preci_85_1 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
dawei_preci_85_2 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
dawei_preci_85_3 <- dawei_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# dawei_preci_85_1
# dawei_preci_85_2
# dawei_preci_85_3
dawei_preci_future_85 <- rbind.data.frame(
  dawei_preci_85_1, 
  dawei_preci_85_2, 
  dawei_preci_85_3)
dawei_preci_future_85 <- dawei_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-128, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Nd Projected Daily Precipitation by Model at Dawei Station

```{r Fig1-129, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Dawei station, Tanintharyi Region, Myanmar (RCP 8.5)"}
dawei_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Mean = mean(sum(future, na.rm = TRUE))) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line() +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario, the following table depicts the temperature
variation among the different GCM/RCM models.

```{r Table1-16, include = TRUE}
dawei_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Dawei Station**, Tanintharyi Region") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
  
```

```{r include=FALSE}
dawei_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Max = max(preci.y),
    Mean = mean(preci.y),
    Min = min(preci.y)
  ) %>%
  filter(Max > 50) %>%
  arrange(desc(Max)) %>%
  # head(10) %>%
  gt::gt() %>%
  gt::tab_header(title = "Topmost GCM/RCM for Max, Mean and Min of Precipitation Change in %  under RCP 8.5 by 2100 at Dawei Station",
                 subtitle = "Arranged by descending order of Max of Precipitation Change in %")
```

##### Observed Vs. Projected Monthly Precipitation

```{r Fig1-130, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  #facet_wrap(~Model, scales = "free_y") +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
   theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  
  )
```

##### Observed Vs. Projected Monthly Precipitation by Model

```{r Fig1-131, fig.width=8, fig.height=10, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", se = TRUE, color = "white") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits=abb.month) +
  facet_wrap(~Model) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
  
```

##### Observed Vs. Projected Annual Precipitation (1)

```{r Fig1-132, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  distinct() %>% 
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation by Model (1)

```{r Fig1-133, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig1-134, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = dawei_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation by Model (2)

```{r Fig1-135, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Dawei Station, Tanintharyi Region, Myanmar 2011-2100"}
dawei_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),

    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = dawei_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

## Rakhine State

### Mean Temperature

#### Observed Data

```{r}
sittwe_tmean <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_meanTem.csv",
  delim = " ", col_names = c("date", "Tmean"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmean$date <- as.character(sittwe_tmean$date) ## set charactor for further analysis
sittwe_tmean["year"] <- str_sub(sittwe_tmean$date, 1, 4)
sittwe_tmean["month"] <- str_sub(sittwe_tmean$date, 5, 6)
sittwe_tmean["day"] <- str_sub(sittwe_tmean$date, 7, 8)
sittwe_tmean["Date"] <- make_date(sittwe_tmean$year, sittwe_tmean$month, sittwe_tmean$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19810101"):(which(sittwe_tmean$date == "19810101") + 58)]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmean)
names(miss_jf_1982) <- c("Date", "Tmean")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19850101"):(which(sittwe_tmean$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmean)
names(miss_whole_1986) <- c("Date", "Tmean")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19871201"):(which(sittwe_tmean$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmean)
names(miss_dec_1988) <- c("Date", "Tmean")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "19900201"):(which(sittwe_tmean$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmean)
names(miss_feb_1991) <- c("Date", "Tmean")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmean <- sittwe_tmean$Tmean[which(sittwe_tmean$date == "20040301"):which(sittwe_tmean$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmean)
names(miss_mar_2005) <- c("Date", "Tmean")

sittwe_tmean <- sittwe_tmean[, c(6, 2)]
sittwe_tmean <- rbind.data.frame(sittwe_tmean, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_tmean["date"] <- ymd(sittwe_tmean$Date)
```

```{r Fig1-136, fig.width= 8, fig.height=6, fig.cap="30 years observed mean temperature at Sittwe station, Rakhine State, Myanmar"}
mon <- c(
  "Jan", "Feb", "Mar", "Apr", "May", "Jun",
  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
)
p1 <- sittwe_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- sittwe_tmean %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmean, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Mean Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- sittwe_tmean %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(Tmean, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmean)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Daily Mean Temperature at Sittwe Station"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- sittwe_tmean %>%
  ggplot(aes(x = Tmean, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability Density",
    title = "Probability Distribution of Observed Data at Sittwe"
  )+
  geom_vline(xintercept = mean(sittwe_tmean$Tmean), lty = "dotted", size = 1) +
  annotate("text", 
           x = round(mean(sittwe_tmean$Tmean), 2),
           y = 0.03, label = paste(round(mean(sittwe_tmean$Tmean), 2), "C")) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability Density",
    title = "Probability Distribution of Observed Data at Sittwe"
  )+theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))

```

The data has a series of data gap as it reported a total of 10443 out of
10957. 59 days which is the first two months in 1982, 1986 the whole
year; the whole month, December in 1988; the whole month, February in
1991; the whole month, March in 2005; are missing.

| Year  | missing months |             number of days |
|-------|:--------------:|---------------------------:|
| 1982  |  Jan and Feb   |                    59 days |
| 1986  |   Jan to Dec   |                   365 days |
| 1988  |    December    |                    31 days |
| 1991  |    February    |                    28 days |
| 2005  |     March      |                    31 days |
| Total |                | `r 59 + 365 + 31 + 28 +31` |

#### RCP4.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-137, fig.cap="Observed and projected Daily Mean Temperature (RCP 4.5) at Sittwe Station, Rakhine State during 2011-2100"}
files <- fs::dir_ls(glob = "*tmean_12_45*csv")
tmean_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_45) <- c("Date", "Tmean", "Model")
tmean_models_combined_45$Date <- as.Date(tmean_models_combined_45$Date)
#tmean_models_combined_45
files <- fs::dir_ls(glob = "*tmean_12_85*csv")
tmean_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmean_models_combined_85) <- c("Date", "Tmean", "Model")

sittwe_tmean_45_1 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_45_2 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_45_3 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# sittwe_tmean_45_1
# sittwe_tmean_45_2
# sittwe_tmean_45_3
sittwe_tmean_future <- rbind.data.frame(
  sittwe_tmean_45_1, 
  sittwe_tmean_45_2, 
  sittwe_tmean_45_3)
sittwe_tmean_future <- sittwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
sittwe_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size= 0.2) +
  geom_line(aes(x = date, y = Tmean.x), color = "yellow") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )

```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-138, fig.width=10, fig.height=8, fig.cap="Observed and Projected Daily Mean Temperature (RCP 4.5) at Sittwe Station during 2011-2100"}
sittwe_tmean_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Year) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmean.x ), color = "lightcyan") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 12),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 12),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 9),
    axis.text = element_text(size = 9),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 9, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario at Sittwe, the following table depicts the
mean temperature variation among the different GCM/RCM models.

```{r Table1-17, include = TRUE}
sittwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 1, padding = 1,
         caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Sittwe station, Rakhine State, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

```{r include=FALSE}
sittwe_tmean_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Sittwe Station*"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig1-139, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkred") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  annotate("text", x =2, y = 29, label = "GCMs/RCMs \nModels \nProjected", color = "deeppink", size = 3)+
  annotate("text", x =6, y = 26, label = "Historical \nObservation", color = "darkred", size = 3) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-140, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
  geom_line(aes(x = Month, y = Ob_mean), color = "darkred") +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
   annotate("text", x =7.5, y = 29, label = "GCMs/RCMs \nProjected", color = "deeppink", size = 2)+
  annotate("text", x =7.5, y = 26, label = "Historical \nObservation", color = "darkred", size = 2) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-141, fig.width=6, fig.height=4, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = abb.month) +
  # facet_wrap(~Model, scales = "free_y")+
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
   annotate("text", x =2030, y = 28, label = "GCMs/RCMs Projected", color = "deeppink", size = 4)+
  annotate("text", x =2050, y = 26, label = "Historical Observation", color = "darkred", size = 4) +
  theme_classic( ) +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature by Model

```{r Fig1-142, fig.width=10, fig.height=8, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
  geom_line(aes(x = Year, y = Ob_mean), color = "darkred") +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y")+
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
   annotate("text", x =2090, y = 28, label = "GCMs/RCMs Projected", color = "deeppink", size = 1.5)+
  annotate("text", x =2050, y = 26, label = "Historical Observation", color = "darkred", size = 1.5) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-143, fig.width=8, fig.height=6, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Max = max(future),
            Min = min(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
 
  geom_line(aes(x = Year, y = Max, color = Model)) +
  geom_line(aes(x = Year, y = Min, color = Model)) +
  geom_line(data = sittwe_tmean_future %>%
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_mean = mean(Tmean.x)),
              aes(x = Year, y = Ob_mean), color = "maroon")+
   geom_line(data = sittwe_tmean_future %>%
               mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_max = max(Tmean.x)),
              aes(x = Year, y = Ob_max), color = "maroon")+
   geom_line(data = sittwe_tmean_future %>%
               mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_min = min(Tmean.x)),
              aes(x = Year, y = Ob_min), color = "maroon")+
  scale_color_hue(l = 10) +
  #facet_wrap(~Model, scales = "free_y")+
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
   annotate("text", x =2090, y = 29, label = "GCMs/RCMs Projected", color = "deeppink", size = 3)+
  annotate("text", x =2000, y = 24, label = "Historical Observation", color = "darkred", size = 3) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature

```{r Fig1-144, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Mean Temperature (RCP 4.5) among GCM/RCMs at Sittwe Station, Rakhine State during 2011-2100"}
sittwe_tmean_future %>%
  group_by(Model, Year) %>%
  summarize(Mean = mean(future),
            Max = max(future),
            Min = min(future)) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.3) +
 
  geom_line(aes(x = Year, y = Max, color = Model)) +
  geom_line(aes(x = Year, y = Min, color = Model)) +
  geom_line(data = sittwe_tmean_future %>%
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_mean = mean(Tmean.x)),
              aes(x = Year, y = Ob_mean), color = "maroon")+
   geom_line(data = sittwe_tmean_future %>%
               mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_max = max(Tmean.x)),
              aes(x = Year, y = Ob_max), color = "maroon")+
   geom_line(data = sittwe_tmean_future %>%
               mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>%
              summarize(Ob_min = min(Tmean.x)),
              aes(x = Year, y = Ob_min), color = "maroon")+
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y")+
  # scale_color_brewer(type = "seq", palette = "Spectral")+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
   annotate("text", x =2090, y = 29, label = "GCMs/RCMs Projected", color = "deeppink", size = 2)+
  annotate("text", x =2000, y = 24, label = "Historical Observation", color = "darkred", size = 2) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP 8.5

##### Observed and Projected Daily Mean Temperature

```{r Fig1-145, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmean_85_1 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_85_2 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
sittwe_tmean_85_3 <- sittwe_tmean %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmean_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmean.x + Tmean.y
  )
# sittwe_tmean_85_1
# sittwe_tmean_85_2
# sittwe_tmean_85_3
sittwe_tmean_future_85 <- rbind.data.frame(
  sittwe_tmean_85_1, 
  sittwe_tmean_85_2, 
  sittwe_tmean_85_3)
sittwe_tmean_future_85 <- sittwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  )
sittwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkred") +
  scale_color_hue(l = 45) +
 
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(sittwe_tmean_future_85$Model)))+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_classic() +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Mean Temperature by Model

```{r Fig1-146, fig.width=8, fig.height=6, fig.cap="Observed and Projected Daily Mean Temperature (RCP 8.5) among GCM/RCMs at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Month) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = date, y = Tmean.x), color = "darkred") +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y") +
  # scale_color_brewer(type = "div", palette = colorRampPalette(length(sittwe_tmean_future_85$Model)))+
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +

theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario at Sittwe, the following table depicts the
mean temperature variation among the different GCM/RCM models.

```{r Table1-18, include = TRUE}
sittwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmean.x),
    OMean = mean(Tmean.x),
    OMin = min(Tmean.x),
    MMax = max(Tmean.y),
    MMean = mean(Tmean.y),
    MMin = min(Tmean.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 1, padding = 1,
         caption = "Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Sittwe station, Rakhine Region, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

```{r include=FALSE}
sittwe_tmean_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmean.x),
    Observed_Mean = mean(Tmean.x),
    Observed_Min = min(Tmean.x),
    Model_Max = max(Tmean.y),
    Model_Mean = mean(Tmean.y),
    Model_Min = min(Tmean.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Sittwe Station**"), subtitle = md("Arranged by descending order of Max of Mean Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 34.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 34.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, 
                 Observed_Max, 
                 Observed_Min, 
                 Model_Max, 
                 Model_Mean, 
                 Model_Min, 
                 Projected_Max, 
                 Projected_Mean, 
                 Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  ) 
```

##### Observed and Projected Monthly Mean Temperature

```{r Fig1-147, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Mean Temperature by Model

```{r Fig1-148, fig.width=10, fig.height=8, fig.cap="Observed and Projected Monthly Mean Temperature (RCP 8.5) among GCM/RCMs at Sittwe Station during 2011-2100"}
sittwe_tmean_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmean.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature (1)

```{r Fig1-149, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar"}

sittwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  annotate("text", x = 2025, y = 25, label = "Historical Observation", color = "maroon", size = 3)+
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature by Model(1)

```{r Fig1-150, fig.width=7, fig.height=9, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 \nat Sittwe Station, Rakhine State, Myanmar"}

sittwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  annotate("text", x = 2025, y = 25, label = "Historical Observation", color = "maroon", size = 3)+
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature Temperature (Time Series)

```{r Fig1-151, fig.width=10, fig.height=8, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar"}

sittwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmean.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
   geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmean.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  #facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  annotate("text", x = 2025, y = 25, label = "Historical Observation", color = "maroon", size = 1.2)+
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean Temperature Temperature by Model (2)

```{r Fig1-152, fig.width=10, fig.height=8, fig.cap="Observed and Projected Mean Temperature under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar"}

sittwe_tmean_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmean.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmean.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmean.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
   geom_line(data = sittwe_tmean_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmean.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  # scale_color_brewer(palette = colorPalette(43))+
  annotate("text", x = 2025, y = 25, label = "Historical Observation", color = "maroon", size = 1.2)+
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### Density Plot of mean Temperature at Sittwe station, Rakhine State, Myanmar

```{r Fig1-153, fig.width=10, fig.height=8, fig.cap="Density plot of mean temperature at Sittwe station, Rakhine State, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(sittwe_tmean, aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmean$Tmean) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(sittwe_tmean$Tmean), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmean$Tmean) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(sittwe_tmean$Tmean), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmean$Tmean) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmean$Tmean), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Mean Temparature shift Right from Baseline (1981-2010) \nat Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = sittwe_tmean_45_1, 
    aes(
      x = future, 
      y = ..density..
    ),
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmean_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmean_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmean_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmean_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmean_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmean_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(sittwe_tmean_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmean_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmean_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmean_45_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmean_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmean_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmean_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmean
p2 <-  ggplot(
    sittwe_tmean,
    aes(x = Tmean, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmean$Tmean), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean$Tmean), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean$Tmean) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmean$Tmean), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Temparature shift Right from Baseline (1981-2010) \nat Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = sittwe_tmean_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(sittwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmean_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmean_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmean_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(
                  round(max(sittwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmean_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmean_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmean_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmean_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmean_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmean_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Maximum Temperature

#### Observed data

```{r}
sittwe_tmax <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_maxTem.csv",
  delim = " ", col_names = c("date", "Tmax"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmax["date"] <- as.character(sittwe_tmax$date)
sittwe_tmax["year"] <- str_sub(sittwe_tmax$date, 1, 4)
sittwe_tmax["month"] <- str_sub(sittwe_tmax$date, 5, 6)
sittwe_tmax["day"] <- str_sub(sittwe_tmax$date, 7, 8)
sittwe_tmax["Date"] <- make_date(sittwe_tmax$year, sittwe_tmax$month, sittwe_tmax$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19810101"):(which(sittwe_tmax$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmax)
names(miss_jf_1982) <- c("Date", "Tmax")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19850101"):(which(sittwe_tmax$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmax)
names(miss_whole_1986) <- c("Date", "Tmax")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19871201"):(which(sittwe_tmax$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmax)
names(miss_dec_1988) <- c("Date", "Tmax")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "19900201"):(which(sittwe_tmax$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmax)
names(miss_feb_1991) <- c("Date", "Tmax")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmax <- sittwe_tmax$Tmax[which(sittwe_tmax$date == "20040301"):which(sittwe_tmax$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmax)
names(miss_mar_2005) <- c("Date", "Tmax")

sittwe_tmax <- sittwe_tmax[, c(6, 2)]
sittwe_tmax <- rbind.data.frame(sittwe_tmax, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)

sittwe_tmax["date"] <- ymd(sittwe_tmax$Date)
```

```{r Fig1-154, fig.width=8, fig.height=6, fig.cap="30 years observed maximum temperature at Sittwe station, Rakhine State"}

p1 <- sittwe_tmax %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- sittwe_tmax %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmax, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Maximum Temperature"
  ) +
  theme_minimal() +
  theme(
   legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7),
    axis.text.x = element_text(angle = 45)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- sittwe_tmax %>%
  
  ggplot(aes(x = Date, y = Tmax)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Maximum Temperature at Sittwe Station"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- sittwe_tmax %>%
  ggplot(aes(x = Tmax, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density(bins = 100)  +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "density",
    title = "Probability Distribution of Maximum Temperature at Sittwe"
  ) +
  ggthemes::theme_clean() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )+
  geom_vline(xintercept = mean(sittwe_tmax$Tmax), lty = "dotted", size = 0.7) +
  annotate("text", x = mean(sittwe_tmax$Tmax)- 0.1, y = 0.01, label = paste(round(mean(sittwe_tmax$Tmax), 2), "C"), size = 3)
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and Projected Daily Maximum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-155, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar"}
files <- fs::dir_ls(glob = "*tmax_12_45*csv")
tmax_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_45) <- c("Date", "Tmax", "Model")
tmax_models_combined_45$Date <- as.Date(tmax_models_combined_45$Date)
# tmax_models_combined_45
files <- fs::dir_ls(glob = "*tmax_12_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

sittwe_tmax_45_1 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_45_2 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_45_3 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# sittwe_tmax_45_1;sittwe_tmax_45_2;sittwe_tmax_45_3
sittwe_tmax_future <- rbind.data.frame(
  sittwe_tmax_45_1, 
  sittwe_tmax_45_2, 
  sittwe_tmax_45_3)
sittwe_tmax_future <- sittwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
sittwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7, lty = "dashed") +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.key.height = unit(0.4, "mm"),
    legend.title = element_text(family = "sans", size = 9),
    legend.text = element_text(family = "sans", size = 7),
    plot.title = element_text(family = "sans", face = "bold", hjust = 0.5,size = 12)
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-156, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Maximum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

Under this climate scenario at Sittwe, the following table depicts the
mean temperature variation among the different GCM/RCM models.

```{r Table1-19, include = TRUE}
sittwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 1, padding = 1,
         caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Sittwe station, Rakhine State, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

```{r include=FALSE}
sittwe_tmax_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Sittwe Station*"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-157, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-158, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Maximum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.7, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Maximum Temperature

```{r Fig1-159, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Maximum Temperature

```{r Fig1-160, fig.cap="Observed and Projected Maximum Temperature under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
   
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmax.x)),
    aes(x = Year, y = Ob_max), color = "maroon")+
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmax.x)),
    aes(x = Year, y = Ob_min), color = "maroon")+
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Maximum Temperature by Model (Time Series)

```{r Fig1-161, fig.width = 7, fig.height=9, fig.cap = "Observed and Projected Maximum Temperature under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar"}
sittwe_tmax_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
   
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmax.x)),
    aes(x = Year, y = Ob_max), color = "maroon")+
  geom_line(data = sittwe_tmax_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmax.x)),
    aes(x = Year, y = Ob_min), color = "maroon")+
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP8.5

##### Observed and Projected Daily Maximum Temperature

```{r Fig1-162, fig.cap="Observed and Projected Daily Maximum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmax_12_85*csv")
tmax_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmax_models_combined_85) <- c("Date", "Tmax", "Model")

# sittwe_tmax <- vroom::vroom("data/Area-1/sittwe/clean_sittwe_maxTem_edited.csv",
#                               delim = " ", col_names = c("Date", "Tmax"), na = "-999.0", show_col_types = FALSE)
sittwe_tmax["Date"] <- ymd(sittwe_tmax$Date)
sittwe_tmax_85_1 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_85_2 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
sittwe_tmax_85_3 <- sittwe_tmax %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmax_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmax.x + Tmax.y
  )
# sittwe_tmax_85_1
# sittwe_tmax_85_2
# sittwe_tmax_85_3
sittwe_tmax_future_85 <- rbind.data.frame(
  sittwe_tmax_85_1, 
  sittwe_tmax_85_2, 
  sittwe_tmax_85_3)
sittwe_tmax_future_85 <- sittwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
sittwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "grey60") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Maximum Temperature by Model

```{r Fig1-163, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Maximum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmax.x), color = "maroon") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

Under this climate scenario at Sittwe Station, the following table
depicts the mean temperature variation among the different GCM/RCM
models.

```{r Table1-20, include = TRUE}
sittwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmax.x),
    OMean = mean(Tmax.x),
    OMin = min(Tmax.x),
    MMax = max(Tmax.y),
    MMean = mean(Tmax.y),
    MMin = min(Tmax.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 4.0) %>%
  arrange(desc(MMax)) %>%
   head(20) %>%
   kable("pipe", longtable = T, booktabs = T, digits = 1, padding = 1,
         caption = "Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Sittwe station, Rakhine State, Myanmar*") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
 
```

```{r include=FALSE}
sittwe_tmax_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmax.x),
    Observed_Mean = mean(Tmax.x),
    Observed_Min = min(Tmax.x),
    Model_Max = max(Tmax.y),
    Model_Mean = mean(Tmax.y),
    Model_Min = min(Tmax.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Maximum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Sittwe Station*, Rakhine State, Myanmar"), subtitle = md("Arranged by descending order of Max of Maximum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 41.5
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 41.5)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Maximum Temperature

```{r Fig1-164, fig.cap="Observed and Projected Monthly Maximum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits=month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(2.5, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Maximum Temperature by Model

```{r Fig1-165, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Maximum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmax_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmax.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature (1)

```{r Fig1-166, fig.cap="Maximum Temperature under RCP 8.5 at Sittwe Station under different GCMs 2011-2100"}
sittwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature by Model (1)

```{r Fig1-167, fig.width=8, fig.height=10, fig.cap="Observed vs Projected Maximum Temperature under RCP 8.5 at Sittwe Station under different GCMs 2011-2100"}
sittwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y") +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature (Time Series)

```{r Fig1-168, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Maximum Temperature under different GCM - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmax.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
   geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmax.x)),
             aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Maximum Temperature by Model(Time Series)

```{r Fig1-169, fig.width=7, fig.height=9, fig.cap="Observed and Projected Maximum Temperature under different GCM - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmax_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Ob_mean = mean(Tmax.x),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmax.x)),
    aes(x = Year, y = Ob_mean), color = "maroon") +
   geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmax.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
   geom_line(data = sittwe_tmax_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmax.x)),
             aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### Density plots for Maximum Temperature

```{r Fig1-170, fig.width=10, fig.height=8, fig.cap= "Mean shift to right from baseline (1981-2010) of maximum temperature at Sittwe station, Rakhine Region, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(sittwe_tmax, aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmax$Tmax) -0.2, 2)), 
           y = 0.1, 
           label = paste(round(mean(sittwe_tmax$Tmax), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmax$Tmax) -0.2, 2), 
           y = 0.01,
           label = paste(
             round(max(sittwe_tmax$Tmax), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmax$Tmax) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmax$Tmax), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Maximum Temparature shift from Baseline (1981-2010) at **Sittwe** station, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = sittwe_tmax_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmax_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmax_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmax_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmax_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmax_45_2, 
    aes(x = future, y = ..density..),
    adjust = 5, 
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmax_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(sittwe_tmax_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmax_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmax_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmax_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmax_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmax_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmax_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmax
p2 <-  ggplot(
    sittwe_tmax,
    aes(x = Tmax, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmax$Tmax), 
    color = "darkblue", 
    lty = "dashed", 
    size = 1) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax$Tmax), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax$Tmax) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmax$Tmax), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = "Future Maximum Temparature shift from Baseline (1981-2010) at Sittwe station, \nComparisons of 30 years cycles under RCP 8.5"
  ) +
  
  geom_density(
    data = sittwe_tmax_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(sittwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmax_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmax_85_2, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmax_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(sittwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmax_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmax_85_3, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmax_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.1, 
    label = paste(round(mean(sittwe_tmax_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmax_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmax_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Minimum Temperature

#### Observed data

```{r}
sittwe_tmin <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_minTem.csv",
  delim = " ", col_names = c("date", "Tmin"), na = "-999.0", show_col_types = FALSE
)
sittwe_tmin["date"] <- as.character(sittwe_tmin$date)
sittwe_tmin["year"] <- str_sub(sittwe_tmin$date, 1, 4)
sittwe_tmin["month"] <- str_sub(sittwe_tmin$date, 5, 6)
sittwe_tmin["day"] <- str_sub(sittwe_tmin$date, 7, 8)
sittwe_tmin["Date"] <- make_date(sittwe_tmin$year, sittwe_tmin$month, sittwe_tmin$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19810101"):(which(sittwe_tmin$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_tmin)
names(miss_jf_1982) <- c("Date", "Tmin")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19850101"):(which(sittwe_tmin$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_tmin)
names(miss_whole_1986) <- c("Date", "Tmin")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19871201"):(which(sittwe_tmin$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_tmin)
names(miss_dec_1988) <- c("Date", "Tmin")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "19900201"):(which(sittwe_tmin$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_tmin)
names(miss_feb_1991) <- c("Date", "Tmin")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_tmin <- sittwe_tmin$Tmin[which(sittwe_tmin$date == "20040301"):which(sittwe_tmin$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_tmin)
names(miss_mar_2005) <- c("Date", "Tmin")

sittwe_tmin <- sittwe_tmin[, c(6, 2)]
sittwe_tmin <- rbind.data.frame(sittwe_tmin, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_tmin["date"] <- ymd(sittwe_tmin$Date)
```

```{r Fig1-171, fig.width=8, fig.height=6, fig.cap= "30 years observed minimum temperature at Sittwe station, Rakhine State, Myanmar"}

p1 <- sittwe_tmin %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_jitter() +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p2 <- sittwe_tmin %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(Mean = mean(Tmin, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = as.factor(Month))) +
  geom_boxplot() +
  labs(
    x = "Month",
    y = expression(paste("Temperature ", degree, "C")),
    title = "Monthly Minimum Temperature"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  ) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

p3 <- sittwe_tmin %>%
  #  mutate(
  # Year = year(Date),
  # Month = month(Date)
  # ) %>%
  # filter(Year == 2010) %>%
  # group_by(Year, Month) %>%
  # summarize(Mean = mean(tmin, na.rm = TRUE))%>%
  ggplot(aes(x = Date, y = Tmin)) +
  geom_line(color = "maroon") +
  # facet_wrap(~Year) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    title = "Annual Minimum Temperature at Sittwe Station"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )

p4 <- sittwe_tmin %>%
  ggplot(aes(x = Tmin, y = ..density..)) +
  #       mutate(
  # Year = as.factor(year(Date)),
  #   Month = as.factor(month(Date))
  # ) %>%
  # group_by(Year) %>%
  geom_histogram(fill = "cornsilk", color = "grey60", size = 0.2) +
  geom_density() +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Prob. Density",
    title = "Probability Distribution of Minimum Temperature at Sittwe"
  ) +
  geom_vline(xintercept = mean(sittwe_tmin$Tmin), lty = "dotted", size = 0.7) +
  annotate("text", x = mean(sittwe_tmin$Tmin) - 0.2, y = 0.1, label = paste(round(mean(sittwe_tmin$Tmin), 2), "C"), angle = 90) +
  ggthemes::theme_economist_white()+
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP4.5

##### Observed and Projected Daily Minimum Temperature

Similarly, the same number of models, years of ascii raster data are
used as an input for the regional and state level

```{r Fig1-172, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*tmin_12_45*csv")
tmin_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_45) <- c("Date", "Tmin", "Model")
tmin_models_combined_45$Date <- as.Date(tmin_models_combined_45$Date)
# Tmin_models_combined_45
files <- fs::dir_ls(glob = "*tmin_12_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <- c("Date", "Tmin", "Model")

sittwe_tmin_45_1 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_45_2 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_45_3 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_45, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_tmin_future <- rbind.data.frame(
  sittwe_tmin_45_1,
  sittwe_tmin_45_2,
  sittwe_tmin_45_3
)

sittwe_tmin_future <- sittwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
sittwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
# annotate("text", x= 2020, y  = 31, "Maximum of minimum")
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-173, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum Temperature (RCP 4.5) at Sittwe Station during 2011-2100"}
sittwe_tmin_future %>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(alpha = 0.3, lty = "dashed", size = 0.2 ) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

```{r Table1-21, include = TRUE}
sittwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at **Sittwe station, Rakhine State**, *Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))

```

```{r include=FALSE}
sittwe_tmin_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 2.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Mean Temperature **exceeding 2 ºC** under RCP 4.5 by 2100 at *Sittwe Station*"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 2.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-174, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 10) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
 theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-175, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Minimum Temperature (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 15) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature (1)

```{r Fig1-176, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 among different GCMs/RCMs at Sittwe Station, Rakhine State 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_max), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature by Model (1)

```{r Fig1-177, fig.width=8, fig.height=10, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 among different GCMs/RCMs at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.2) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_max), color = "maroon") +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon") +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature (Time Series)

```{r Fig1-178, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 among different GCMs/RCMs at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.2) +
  geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3 ) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Mean, Max, Min of Minimum Temperature by Model (Time Series)

```{r Fig1-179, fig.width=8, fig.height=10, fig.cap="Observed and Projected Minimum Temperature under RCP 4.5 among different GCMs/RCMs at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.2) +
   geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)),
    aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(data = sittwe_tmin_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3 ) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 10) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### RCP8.5

##### Observed and Projected Daily Minimum Temperature

```{r Fig1-180, fig.cap="Observed and Projected Daily Minimum Temperature among different GCMs/RCMs \nat Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
files <- fs::dir_ls(glob = "*tmin_12_85*csv")
tmin_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(tmin_models_combined_85) <-c("Date", "Tmin", "Model")


sittwe_tmin_85_1 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_85_2 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
sittwe_tmin_85_3 <- sittwe_tmin %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(tmin_models_combined_85, by = "Date") %>%
  mutate(
    future = Tmin.x + Tmin.y
  )
# sittwe_tmin_85_1
# sittwe_tmin_85_2
# sittwe_tmin_85_3
sittwe_tmin_future_85 <- rbind.data.frame(
  sittwe_tmin_85_1, 
  sittwe_tmin_85_2, 
  sittwe_tmin_85_3)
sittwe_tmin_future_85 <- sittwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
sittwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 10) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH" 
  ) +
  theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Minimum Temperature by Model

```{r Fig1-181, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Minimum Temperature scenario variation among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Max = max(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = Tmin.x), color = "maroon") +
  scale_color_hue(l = 15) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

```{r Table1-22, include = TRUE}
sittwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    OMax = max(Tmin.x),
    OMean = mean(Tmin.x),
    OMin = min(Tmin.x),
    MMax = max(Tmin.y),
    MMean = mean(Tmin.y),
    MMin = min(Tmin.y),
    PMax = max(future),
    PMean = mean(future),
    PMin = min(future)
  ) %>%
  filter(MMax > 2.0) %>%
  arrange(desc(MMax)) %>%
  head(10) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Minimum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at **Sittwe station**, *Rakhine State, Myanmar*<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
```

```{r, include=FALSE}
sittwe_tmin_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Observed_Max = max(Tmin.x),
    Observed_Mean = mean(Tmin.x),
    Observed_Min = min(Tmin.x),
    Model_Max = max(Tmin.y),
    Model_Mean = mean(Tmin.y),
    Model_Min = min(Tmin.y),
    Projected_Max = max(future),
    Projected_Mean = mean(future),
    Projected_Min = min(future)
  ) %>%
  filter(Model_Max > 4.0) %>%
  arrange(desc(Model_Max)) %>%
  # head(10) %>%
  # knitr::kable()
  gt() %>% 
  tab_header(title = md("Topmost GCM/RCMs for Minimum Temperature **exceeding 4 ºC** under RCP 8.5 by 2100 at *Sittwe* Station*"), subtitle = md("Arranged by descending order of Max of Minimum Temperature")) %>% 
  tab_style(
    style = list(
      cell_fill(color = "wheat"),
      cell_text(weight = "bold")
      ),
    locations = cells_body(
      columns = c(Model_Max, Model_Mean, Model_Min),
      rows = Model_Max >= 4.0
    )
    
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#F9E3D6"),
      cell_text(style = "italic")
      ),
    locations = cells_body(
      columns = c(Projected_Max, Projected_Mean, Projected_Min),
      rows = Projected_Max > 29.0
    )
  ) %>%
 tab_style(
    style = list(
      cell_fill(color = "cornsilk"),
      cell_text(weight = "normal")
      ),
    locations = cells_body(
      columns = c(Observed_Max, Observed_Mean, Observed_Min),
      rows = Observed_Max >= 29.0)
    ) %>% 
  fmt_number(
    columns = c( Observed_Mean, Observed_Max, Observed_Min, Model_Max, Model_Mean, Model_Min, Projected_Max, Projected_Mean, Projected_Min), 
    decimals = 1
  ) %>% 
  cols_label(
    Observed_Max = md("**Observed Max**"),
    Observed_Mean = md("**Observed Mean**"),
    Observed_Min = md("**Observed Min**"), 
    Model_Max = md("**Model Max**"),
    Model_Mean = md("**Model Mean**"),
    Model_Min = md("**Model Min**"),
    Projected_Max = md("**Projected Max**"),
    Projected_Mean = md("**Projected Mean**"),
    Projected_Min = md("**Projected Min**")
  )
```

##### Observed and Projected Monthly Minimum Temperature

```{r Fig1-182, fig.cap="Observed and Projected Monthly Minimum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size=0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 15) +
  scale_x_discrete(limits = month.abb) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Minimum Temperature by Model

```{r Fig1-183, fig.width=8, fig.height=10, fig.cap="Observed and Projected Monthly Minimum Temperature among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_tmin_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  group_by(Model, Month) %>%
  summarize(Mean = mean(future, na.rm = TRUE),
            Ob_mean = mean(Tmin.x, na.rm = TRUE)) %>%
  ggplot(aes(x = Month, y = Mean, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = Month, y = Ob_mean), color = "maroon") +
  scale_color_hue(l = 15) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Month",
    y = expression(paste("Temperature", degree, "C"))
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Mean Max, Min of Annual Minimum Temperature (1)

```{r Fig1-184, fig.cap="Observed and Projected Annual Minimum Temperature under different GCMs - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.3) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Mean Max, Min of Annual Minimum Temperature by Model (1)

```{r Fig1-185, fig.width = 8, fig.height=10, fig.cap = "Observed and Projected Annual Minimum Temperature under different GCMs - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future),
    Ob_mean = mean(Tmin.x),
    Ob_max = max(Tmin.x),
    Ob_min = min(Tmin.x)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.3) +
  geom_line(aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Mean Max, Min of Annual Minimum Temperature (Time Series)

```{r Fig1-186, fig.cap="Observed and Projected Annual Minimum Temperature under different GCMs - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.3) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), 
    aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  labs(
    x = "Year", y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Mean Max, Min of Annual Minimum Temperature by model (Time Series)

```{r Fig1-187, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Minimum Temperature under different GCMs - RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_tmin_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Mean = mean(future),
    Max = max(future),
    Min = min(future)
  ) %>%
  ggplot(aes(x = Year, y = Mean, color = Model)) +
  geom_line(alpha = 0.9, lty = "dotted", size = 0.3) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_mean = mean(Tmin.x)), 
    aes(x = Year, y = Ob_mean), color = "maroon", alpha = 0.9) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_max = max(Tmin.x)),
    aes(x = Year, y = Ob_max), color = "maroon", alpha = 0.3) +
  geom_line(data = sittwe_tmin_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_min = min(Tmin.x)),
    aes(x = Year, y = Ob_min), color = "maroon", alpha = 0.3) +
  geom_line(aes(x = Year, y = Max, color = Model), alpha = 0.3) +
  geom_line(aes(x = Year, y = Min, color = Model), alpha = 0.3) +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year", 
    y = expression(paste("Temperature", degree, "C")),
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

#### Density plots for Minimum Temperature

```{r Fig1-188, fig.width=10, fig.height=8, fig.cap="Mean shift to right from baseline (1981-2010) of Minimum Temperature at Sittwe station, Rakhine State, Myanmar"}
####  Density Plot for Pathein station, Ayeyarwaddy Region, Myanmar

### RCP 4.5
p1 <- ggplot(sittwe_tmin, aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  #geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate("text", 
           x = as.numeric(
             round(mean(sittwe_tmin$Tmin) -0.2, 2)), 
           y = 0.10, 
           label = paste(round(mean(sittwe_tmin$Tmin), 2), "C"), 
           angle = 90,
           size = 3) +
  annotate("text",
           x = round(max(sittwe_tmin$Tmin) -0.2, 2), 
           y = 0.04,
           label = paste(
             round(max(sittwe_tmin$Tmin), 2), "C"
           ),
           size = 3) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmin$Tmin) -0.2, 2),
    y = 0.01, 
    label = paste(
      round(min(sittwe_tmin$Tmin), 2), "C"
    ),
    size = 3) +
  labs(
    x = expression(
      paste("Temperature",degree,"C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar, \nComparisons of 30 years cycles under RCP 4.5")
  ) +
  
  geom_density(
    data = sittwe_tmin_45_1, 
    aes(
      x = future, 
      y = ..density..
    ), 
    adjust = 5,
    fill = "grey50", 
    color = "darkgreen", 
    alpha = 0.3) + 
  #geom_density(color = "darkgreen") +
  
  geom_vline(
    xintercept = mean(sittwe_tmin_45_1$future), 
    color = "blue", 
    lty = "dashed", 
    size = 0.5
  ) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin_45_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(round(max(sittwe_tmin_45_1$future), 2), "C"), 
    size = 3
  ) +
  
  annotate(
    "text",
    x = round(min(sittwe_tmin_45_1$future)-0.3, 2), 
    y = 0.02, 
    label = paste(round(min(sittwe_tmin_45_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmin_45_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "wheat", 
    color = "red", 
    alpha = 0.3
  )+ 
  # geom_density(col = "red") +
  geom_vline(
    xintercept = mean(sittwe_tmin_45_2$future), 
    color = "maroon", lty = "dashed", size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_2$future) -0.2,  2),
    y = 0.10,
    label = paste(round(mean(sittwe_tmin_45_2$future),2), "C"),
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_2$future) -0.2,  2), 
    y = 0.02, 
    label = paste(round(max(sittwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  annotate(
    "text",
    x = round(min(sittwe_tmin_45_2$future) -0.2,  2), 
    y = 0.03, 
    label = paste(round(min(sittwe_tmin_45_2$future),2), "C"), 
    size = 3
  ) +
  
  geom_density(
    data =sittwe_tmin_45_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "tomato1", 
    color = "black", 
    alpha = 0.3
  ) + 
  # geom_density(col = "black") +
  geom_vline(
    xintercept = mean(sittwe_tmin_45_3$future), 
    color = "black", 
    lty = "dashed", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin_45_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmin_45_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_45_3$future) -0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmin_45_3$future), 2),"C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist_white() +
  theme(
    plot.title = element_text(size = 12),
    axis.text.x.top  = element_text(size = 7))
  
  ### RCP 8.5 \nat Pathein Tmin
p2 <-  ggplot(
    sittwe_tmin,
    aes(x = Tmin, y = ..density..))+ 
  geom_density(
    adjust = 5,
    fill = "cornsilk",
    col = "darkblue", 
    alpha = 0.9) + 
  # geom_density(col = "darkblue") +
  geom_vline(
    xintercept = mean(sittwe_tmin$Tmin), 
    color = "darkblue", 
    lty = "dashed", 
    size = 0.5) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin$Tmin), 2), "C"), 
    angle = 90,
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(max(sittwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin$Tmin) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(min(sittwe_tmin$Tmin), 2), "C"), 
    size = 3
  ) +
  #annotate("arrow", x = 24, y =0.5) +
  labs(
    x = expression(paste("Temperature", degree, "C")),
    y = "Probability density",
    title = md("Future Minimum Temparature shift from Baseline (1981-2010) at Sittwe station, Rakhine State, Myanmar \nComparisons of 30 years cycles under RCP 8.5")
  ) +
  
  geom_density(
    data = sittwe_tmin_85_1, 
    aes(x = future, y = ..density..),
    adjust = 5,
    fill = "yellowgreen", 
    color = "purple", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
 #  geom_density(col = "purple") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_1$future), 
    color = "blue", 
    lty = "dotted", 
    size = 0.3
  ) +
  scale_color_hue(l = 45) +
  
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin_85_1$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(max(sittwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_1$future) -0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(min(sittwe_tmin_85_1$future), 2), "C"),
    size = 3
  ) +
  
  geom_density(
    data = sittwe_tmin_85_2, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "yellow3", 
    color = "maroon", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  #geom_density(color = "maroon") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_2$future), 
    color = "maroon", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin_85_2$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.02, 
    label = paste(
                  round(max(sittwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_2$future) - 0.2, 2), 
    y = 0.03, 
    label = paste(
                  round(min(sittwe_tmin_85_2$future), 2), "C"), 
    size = 3
  ) +
  geom_density(
    data =sittwe_tmin_85_3, 
    aes(x = future, y = ..density..), 
    adjust = 5,
    fill = "cyan", 
    color = "black", 
    alpha = 0.3, 
    lty = "solid"
  ) + 
  # geom_density(col = "brown") +
  geom_vline(
    xintercept = mean(sittwe_tmin_85_3$future), 
    color = "violet", 
    lty = "dotted", 
    size = 0.5
  ) +
  annotate(
    "text", 
    x = round(mean(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.10, 
    label = paste(round(mean(sittwe_tmin_85_3$future), 2), "C"), 
    angle = 90, 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(max(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.01, 
    label = paste(round(max(sittwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  annotate(
    "text", 
    x = round(min(sittwe_tmin_85_3$future) - 0.2, 2), 
    y = 0.04, 
    label = paste(round(min(sittwe_tmin_85_3$future), 2), "C"), 
    size = 3
  ) +
  
  ggthemes::theme_economist() +
  theme(plot.title = element_text(size = 12),
        axis.text.x.top  = element_text(size = 7))

p1 + p2 + plot_layout(ncol = 1)
```

### Precipitation

#### Observed Data

```{r}
sittwe_preci <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_rainfall.csv",
  delim = " ", col_names = c("date", "preci"), na = "-999.0", show_col_types = FALSE
)
sittwe_preci["date"] <- as.character(sittwe_preci$date)
sittwe_preci["year"] <- str_sub(sittwe_preci$date, 1, 4)
sittwe_preci["month"] <- str_sub(sittwe_preci$date, 5, 6)
sittwe_preci["day"] <- str_sub(sittwe_preci$date, 7, 8)
sittwe_preci["Date"] <- make_date(sittwe_preci$year, sittwe_preci$month, sittwe_preci$day)

## Jan Feb 1982 missing
miss_jf_date <- seq.Date(as.Date("1982-01-01"), as.Date("1982-02-28"), "days")
miss_jf_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19810101"):(which(sittwe_preci$date == "19810228"))]
miss_jf_1982 <- cbind.data.frame(miss_jf_date, miss_jf_preci)
names(miss_jf_1982) <- c("Date", "preci")

## whole year missing data in 1986
miss_whole_date <- seq.Date(as.Date("1986-01-01"), as.Date("1986-12-31"), "days")
miss_whole_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19850101"):(which(sittwe_preci$date == "19851231"))]
miss_whole_1986 <- cbind.data.frame(miss_whole_date, miss_whole_preci)
names(miss_whole_1986) <- c("Date", "preci")

## 1998 December
miss_dec_date <- seq.Date(as.Date("1988-12-01"), as.Date("1988-12-31"), "days")
miss_dec_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19871201"):(which(sittwe_preci$date == "19871231"))]
miss_dec_1988 <- cbind.data.frame(miss_dec_date, miss_dec_preci)
names(miss_dec_1988) <- c("Date", "preci")

## 1991 Feb
miss_feb_date <- seq.Date(as.Date("1991-02-01"), as.Date("1991-02-28"), "days")
miss_feb_preci <- sittwe_preci$preci[which(sittwe_preci$date == "19900201"):(which(sittwe_preci$date == "19900228"))]
miss_feb_1991 <- cbind.data.frame(miss_feb_date, miss_feb_preci)
names(miss_feb_1991) <- c("Date", "preci")

## 2005 March

miss_mar_date <- seq.Date(as.Date("2005-03-01"), as.Date("2005-03-31"), "days")
miss_mar_preci <- sittwe_preci$preci[which(sittwe_preci$date == "20040301"):which(sittwe_preci$date == "20040331")]
miss_mar_2005 <- cbind.data.frame(miss_mar_date, miss_mar_preci)
names(miss_mar_2005) <- c("Date", "preci")

sittwe_preci <- sittwe_preci[, c(6, 2)]
sittwe_preci <- rbind.data.frame(sittwe_preci, miss_jf_1982, miss_whole_1986, miss_dec_1988, miss_feb_1991, miss_mar_2005)
sittwe_preci["date"] <- ymd(sittwe_preci$Date)
```

```{r Fig1-189, fig.width=6, fig.height=8, fig.retina=2, fig.cap="30 years observed precipitation data at Sittwe station, Rakhine State, Myanmar"}
p1 <- sittwe_preci %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Max, color = Month)) +
  geom_jitter() +
  # geom_jitter(aes(x = Month, y = Max, color = Month)) +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed maximum precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p2 <- sittwe_preci %>%
  mutate(
    Year = as.factor(year(Date)),
    Month = as.factor(month(Date))
  ) %>%
  group_by(Year, Month) %>%
  summarize(
    Total = sum(preci),
    Mean = mean(preci),
    Max = max(preci),
    Min = min(preci)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Month)) +
   geom_boxplot() +
  # geom_smooth(method='lm', se=TRUE)+
  # coord_flip()
  labs(
    x = "Month", y = "Precipitation in mm",
    title = "Observed total precipitation",
    caption = "Source: DMH, 2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
p3 <-  sittwe_preci %>% 
    mutate(
      Year = factor(year(Date)),
      Month = factor(month(Date)) ) %>% 
  ggplot(aes(x = Date, y = preci, color = Month)) +
    geom_col() +
    # geom_density() +
    # #facet_wrap(~Model)+
    labs(
      x = "Year",
      y = "Precipitation in mm",
      title = "Daily Precipatation at Sittwe Stataion over last 30 years (1981-2010)",
      caption = "Source: DMH, 2019") + 
ggthemes::theme_tufte() +
   theme(legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  
p4 <-  sittwe_preci %>% 
    mutate(
      Year = year(Date),
      Month = month(Date)
    ) %>% 
   # filter(Year == 2010) %>% 
    #group_by(Model, Year, Month) %>% 
    ggplot(aes(x= log10(preci), y = ..density..)) +
   geom_histogram(fill = "cornsilk", color = "grey60", size =  0.2, bins = 50) +
    #scale_x_log10() +
    #scale_y_log10() +
    geom_density() +
  geom_vline(xintercept = log10(mean(sittwe_preci$preci)), lty = "dashed", size = 0.5) +
  annotate("text", x = log10(mean(sittwe_preci$preci) - 1), y = 0.3, label = paste(round(mean(sittwe_preci$preci), 2), "mm"), angle = 90, size = 3) +
    #facet_wrap(~Model)+
    labs(
      x = "Precipitation in mm",
      y = "Density",
      title = "Precipatation at Sittwe Stataion over last 30 years (1981-2010)",
      caption = "Source: DMH, 2019") +
    ggthemes::theme_tufte() +
  theme(legend.position = "none", legend.direction = "horizontal",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(face = "bold", size = 7)
  )
  p1 + p2 - p3 + p4 + (plot_layout(ncol = 1))
```

#### RCP 4.5

##### Observed and projected Daily precipitation at Sittwe station

```{r Fig1-190, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
files <- fs::dir_ls(glob = "*precip_12_45*csv")
preci_models_combined_45 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_45) <- c("Date", "preci", "Model")
preci_models_combined_45$Date <- as.Date(preci_models_combined_45$Date)
# preci_models_combined_45
files <- fs::dir_ls(glob = "*precip_12_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# sittwe_preci <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# sittwe_preci["Date"] <- ymd(sittwe_preci$Date)
sittwe_preci_45_1 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_45_2 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
sittwe_preci_45_3 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_45, by = "Date") %>%
  mutate(
    future = preci.x + (preci.x * preci.y / 100)
  )
# sittwe_tmin_45_1;sittwe_tmin_45_2;sittwe_tmin_45_3
sittwe_preci_future <- rbind.data.frame(
  sittwe_preci_45_1, 
  sittwe_preci_45_2, 
  sittwe_preci_45_3
  ) 
sittwe_preci_future <- sittwe_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% distinct()
sittwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deeppink") +
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1.5, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Precipitation by Model at Sittwe station

```{r Fig1-191, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Precipitation (RCP 4.5) at Sittwe Station, Rakhine State, Myanmar during 2011-2100"}
sittwe_preci_future %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # filter(Year %in% c(2011:2070)) %>%
  # group_by(Model, Year) %>%
  # summarize(
  #   Max = max(future, na.rm = TRUE),
  #   Total = sum(future, na.rm = TRUE)
  # ) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "lightskyblue") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5)+
  labs(
    x = "Year",
    y = "Precipitation in mm"
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(2, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 4.5

```{r Table1-23, include = TRUE}
sittwe_preci_future %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 50 %** under RCP 4.5 by 2100 at **Sittwe Station**, Rakhine State, Myanmar<br><br>") 
# %>% 
#   kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
  
```

```{r include=FALSE}
sittwe_preci_future %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Max = max(preci.y),
    Mean = mean(preci.y),
    Min = min(preci.y)
  ) %>%
  filter(Max > 50) %>%
  arrange(desc(Max)) %>%
  # head(10) %>%
  gt::gt() %>%
  gt::tab_header(title = "Topmost GCM/RCM for Max, Mean and Min of Precipitation Change in %  under RCP 4.5 by 2100 at Sittwe Station",
                 subtitle = "Arranged by descending order of Max of Precipitation Change in %")
```

##### Observed and Projected Monthly Precipitation

```{r Fig1-192, fig.cap="Observed Vs. Projected Monthly Precipitation under RCP 4.5 at Sittwe Station, Rakhine State 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.3) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  scale_x_discrete(limits = month.abb) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 35, 0, 0, "pt"),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed and Projected Monthly Precipitation by Model

```{r Fig1-193, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Monthly Precipitation under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7, pch = 18, size = 1) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue", size =0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    ## axis.text.x = element_blank()
  )
```

##### Observed vs. projected Annual Precipitation (1)

```{r Fig1-194, fig.width=6, fig.height=4, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7, pch = 18, size = 1) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue", size =0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_color_hue(l = 25) +
 # facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
  )
```

##### Observed Vs. Projected Annual Precipitation by Model (1)

```{r Fig1-195, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed Vs. Projected Annual Precipitation under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7, pch = 18, size = 1) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue", size =0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig1-196, fig.width=6, fig.height=4, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = sittwe_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue", size =0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_color_hue(l = 70) +
 # facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.margin = margin(0, 30, 0, 0, "pt"),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
  )
```

##### Observed and Projected Annual Precipitation by Model (Timeseries)

```{r Fig1-197, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 4.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = sittwe_preci_future %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue", size =0.5) +
  geom_smooth(method = "lm", se = TRUE, color = "red", size =0.3) +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_col(aes(x = Month, y = Mean, color = Model))+
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow"),
    # axis.text.x = element_blank()
  )
```

#### RCP 8.5

##### Observed and Projected Daily Precipitation at Sittwe Station

```{r, echo=FALSE, message=FALSE, warning=FALSE}
files <- fs::dir_ls(glob = "*precip_1_85*csv")
preci_models_combined_85 <- map_df(
  files,
  ~ read_csv(.x, col_select = c("dt.x", "CFB", "Models"), show_col_types = FALSE)
)
names(preci_models_combined_85) <- c("Date", "preci", "Model")

# sittwe_preci <- vroom::vroom("data/Area-1/Sittwe/clean_Sittwe_rainfall.csv",
#   delim = " ", col_names = c("Date", "preci"), na = "-999.0", show_col_types = FALSE
# )
# sittwe_preci["Date"] <- ymd(sittwe_preci$Date)
sittwe_preci_85_1 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 1 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
sittwe_preci_85_2 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 2 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
sittwe_preci_85_3 <- sittwe_preci %>%
  mutate(
    Date = Date + 10957 * 3 + 1
  ) %>%
  left_join(preci_models_combined_85, by = "Date") %>%
  mutate(
    future = preci.x + preci.x * preci.y / 100
  )
# sittwe_preci_85_1
# sittwe_preci_85_2
# sittwe_preci_85_3
sittwe_preci_future_85 <- rbind.data.frame(
  sittwe_preci_85_1, 
  sittwe_preci_85_2, 
  sittwe_preci_85_3
  )
sittwe_preci_future_85 <- sittwe_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>% 
  distinct()
```

```{r Fig1-198, fig.cap="Observed and Projected Daily Precipitation scenario among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5)"}
sittwe_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total =sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(lty = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
    theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(2, "mm"),
    legend.key.size = unit(3, "mm"),
    legend.text = element_text(face = "bold", size = 5),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Daily Precipitation by Model at Sittwe Station

```{r Fig1-199, fig.width=8, fig.height=10, fig.cap="Observed and Projected Daily Precipitation among different GCMs at Sittwe station, Rakhine State, Myanmar (RCP 8.5) "}
sittwe_preci_future_85 %>%
  # filter(Model %in% c("ACCESS1-3", "CCSM4", "BNU-ESM"))%>%
  # group_by(Model, Year) %>%
  # summarize(Total =sum(future, na.rm = TRUE)) %>%
  ggplot(aes(x = Date, y = future, color = Model)) +
  geom_line(ltt = "dashed", size = 0.2) +
  geom_line(aes(x = date, y = preci.x), color = "deepskyblue") +
  scale_color_hue(l = 45) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  labs(
    x = "Year",
    y = "Precipitaion in mm"
  ) +
  theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Summary Table 8.5

```{r Table1-24, include = TRUE}
sittwe_preci_future_85 %>%
  group_by(Model) %>%
  summarize(
    OMax = max(preci.x, na.rm = TRUE),
    OMean = sum(preci.x, na.rm = TRUE)/90/12,
    OTotal = sum(preci.x, na.rm = TRUE)/90,
    MMax = max(preci.y, na.rm = TRUE),
    MMean = mean(preci.y, na.rm = TRUE),
    MMin = min(preci.y, na.rm = TRUE),
    PMax = max(future, na.rm = TRUE),
    PMean = sum(future, na.rm = TRUE)/90/12,
    PTotal = sum(future, na.rm = TRUE)/90
  ) %>%
  filter(MMax > 50.0) %>%
  arrange(desc(MMax)) %>%
  head(20) %>%
  kable("pipe", longtable = T, booktabs = T, digits = 2,
        caption = "Topmost GCM/RCMs for Precipitation Change **exceeding 100 %** under RCP 8.5 by 2100 at **Sittwe Station**, Rakhine State, Myanmar") 
# %>% 
  # kable_styling(latex_options = "striped", add_header_above(c("Observed" = 3, "Modeled" = 3, "Projected" = 3)))
  
```

```{r include=FALSE}
sittwe_preci_future_85 %>%
  mutate(
    Year = year(Date),
    Month = month(Date)
  ) %>%
  group_by(Model) %>%
  summarize(
    Max = max(preci.y),
    Mean = mean(preci.y),
    Min = min(preci.y)
  ) %>%
  filter(Max > 50) %>%
  arrange(desc(Max)) %>%
  # head(10) %>%
  gt::gt() %>%
  gt::tab_header(title = "Topmost GCM/RCM for Max, Mean and Min of Precipitation Change in %  under RCP 8.5 by 2100 at Sittwe Station",
                 subtitle = "Arranged by descending order of Max of Precipitation Change in %")
```

##### Observed vs. Projected Monthly Precipitation at Sittwe station

```{r Fig1-200, fig.cap="Observed and Projected Monthly Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 45) +
  scale_x_discrete(limits = month.abb) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed vs. projected Monthly Precipitation by Model

```{r Fig1-201, fig.width=8, fig.height=10, fig.cap="Observed vs. Projected Monthly Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Month) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Month, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Month, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 15) +
  scale_x_discrete(limits = abb.month) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Month", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation

```{r Fig1-202, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation by Model

```{r Fig1-203, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Ob_total = sum(preci.x, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation (Time Series)

```{r Fig1-204, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(data = sittwe_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed and Projected Annual Precipitation by Model (Time Series)

```{r Fig1-205, fig.width=8, fig.height=10, fig.retina=2, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE),

    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_line(alpha = 0.7) +
  geom_line(data = sittwe_preci_future_85 %>% 
              mutate(Year = year(date)) %>% 
              group_by(Model, Year) %>% 
              summarize(Ob_total = sum(preci.x, na.rm = TRUE)/3),
    aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 25) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
  theme_minimal() +
theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation at Sittwe Station

```{r Fig1-206, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 15) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```

##### Observed Vs. Projected Annual Precipitation at Sittwe Station by Model

```{r Fig1-207, fig.width=8, fig.height=10, fig.cap="Observed and Projected Annual Precipitation under RCP 8.5 at Sittwe Station, Rakhine State, Myanmar 2011-2100"}
sittwe_preci_future_85 %>%
  group_by(Model, Year) %>%
  summarize(
    Total = sum(future, na.rm = TRUE)/90,
    Ob_total = sum(preci.x, na.rm = TRUE)/90,
    Mean = mean(future, na.rm = TRUE),
    Max = max(future, na.rm = TRUE),
    Min = min(future, na.rm = TRUE)
  ) %>%
  ggplot(aes(x = Year, y = Total, color = Model)) +
  geom_jitter(alpha = 0.7) +
  geom_line(aes(x = Year, y = Ob_total), color = "deepskyblue") +
  geom_smooth(method = "lm", color = "red") +
  scale_color_hue(l = 15) +
  facet_wrap(~Model, scales = "free_y", ncol = 5) +
  # geom_jitter(aes(x = Month, y = Max, color = Model), alpha = 0.3) +
  # geom_jitter(aes(x = Month, y = Min, color = Model), alpha = 0.3) +
  labs(
    x = "Year", y = "Precipitation in mm",
    caption = "Source: ECD-SNC, DMH"
  ) +
 theme_minimal() +
    theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 10),
    plot.subtitle = element_text(hjust = 0.5, face = "bold", size = 10),
    legend.title = element_blank(),
    legend.key.height = unit(1, "mm"),
    legend.key.size = unit(1, "mm"),
    legend.text = element_text(face = "bold", size = 6),
    axis.title = element_text(face = "bold", size = 7),
    axis.text = element_text(size = 7),
    strip.background = element_rect(fill ="darkblue", color = "grey60"),
    strip.text = element_text(face = "bold", size = 7, color = "snow")
  )
```
